/*! ORBIS.Core - v9.2.30 - 20220817 - https://www.orbis.de/de/microsoft-by-orbis.html */
!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=function(e){return e&&e.Math==Math&&e},r=t("object"==typeof globalThis&&globalThis)||t("object"==typeof window&&window)||t("object"==typeof self&&self)||t("object"==typeof e&&e)||function(){return this}()||Function("return this")(),n={},i=function(e){try{return!!e()}catch(e){return!0}},a=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),o=!i((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})),s=o,u=Function.prototype.call,l=s?u.bind(u):function(){return u.apply(u,arguments)},c={},d={}.propertyIsEnumerable,f=Object.getOwnPropertyDescriptor,p=f&&!d.call({1:2},1);c.f=p?function(e){var t=f(this,e);return!!t&&t.enumerable}:d;var m,h,g=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},y=o,b=Function.prototype,v=b.bind,w=b.call,O=y&&v.bind(w,w),S=y?function(e){return e&&O(e)}:function(e){return e&&function(){return w.apply(e,arguments)}},C=S,E=C({}.toString),A=C("".slice),R=function(e){return A(E(e),8,-1)},P=i,I=R,N=Object,T=S("".split),x=P((function(){return!N("z").propertyIsEnumerable(0)}))?function(e){return"String"==I(e)?T(e,""):N(e)}:N,k=TypeError,M=function(e){if(null==e)throw k("Can't call method on "+e);return e},$=x,D=M,L=function(e){return $(D(e))},j=function(e){return"function"==typeof e},_=j,q=function(e){return"object"==typeof e?null!==e:_(e)},V=r,U=j,F=function(e){return U(e)?e:void 0},B=function(e,t){return arguments.length<2?F(V[e]):V[e]&&V[e][t]},z=S({}.isPrototypeOf),K=B("navigator","userAgent")||"",W=r,X=K,Z=W.process,G=W.Deno,H=Z&&Z.versions||G&&G.version,J=H&&H.v8;J&&(h=(m=J.split("."))[0]>0&&m[0]<4?1:+(m[0]+m[1])),!h&&X&&(!(m=X.match(/Edge\/(\d+)/))||m[1]>=74)&&(m=X.match(/Chrome\/(\d+)/))&&(h=+m[1]);var Y=h,Q=Y,ee=i,te=!!Object.getOwnPropertySymbols&&!ee((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Q&&Q<41})),re=te&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ne=B,ie=j,ae=z,oe=Object,se=re?function(e){return"symbol"==typeof e}:function(e){var t=ne("Symbol");return ie(t)&&ae(t.prototype,oe(e))},ue=String,le=function(e){try{return ue(e)}catch(e){return"Object"}},ce=j,de=le,fe=TypeError,pe=function(e){if(ce(e))return e;throw fe(de(e)+" is not a function")},me=pe,he=function(e,t){var r=e[t];return null==r?void 0:me(r)},ge=l,ye=j,be=q,ve=TypeError,we={exports:{}},Oe=r,Se=Object.defineProperty,Ce=function(e,t){try{Se(Oe,e,{value:t,configurable:!0,writable:!0})}catch(r){Oe[e]=t}return t},Ee=Ce,Ae="__core-js_shared__",Re=r[Ae]||Ee(Ae,{}),Pe=Re;(we.exports=function(e,t){return Pe[e]||(Pe[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.23.3",mode:"global",copyright:"© 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.23.3/LICENSE",source:"https://github.com/zloirock/core-js"});var Ie=M,Ne=Object,Te=function(e){return Ne(Ie(e))},xe=Te,ke=S({}.hasOwnProperty),Me=Object.hasOwn||function(e,t){return ke(xe(e),t)},$e=S,De=0,Le=Math.random(),je=$e(1..toString),_e=function(e){return"Symbol("+(void 0===e?"":e)+")_"+je(++De+Le,36)},qe=r,Ve=we.exports,Ue=Me,Fe=_e,Be=te,ze=re,Ke=Ve("wks"),We=qe.Symbol,Xe=We&&We.for,Ze=ze?We:We&&We.withoutSetter||Fe,Ge=function(e){if(!Ue(Ke,e)||!Be&&"string"!=typeof Ke[e]){var t="Symbol."+e;Be&&Ue(We,e)?Ke[e]=We[e]:Ke[e]=ze&&Xe?Xe(t):Ze(t)}return Ke[e]},He=l,Je=q,Ye=se,Qe=he,et=function(e,t){var r,n;if("string"===t&&ye(r=e.toString)&&!be(n=ge(r,e)))return n;if(ye(r=e.valueOf)&&!be(n=ge(r,e)))return n;if("string"!==t&&ye(r=e.toString)&&!be(n=ge(r,e)))return n;throw ve("Can't convert object to primitive value")},tt=TypeError,rt=Ge("toPrimitive"),nt=function(e,t){if(!Je(e)||Ye(e))return e;var r,n=Qe(e,rt);if(n){if(void 0===t&&(t="default"),r=He(n,e,t),!Je(r)||Ye(r))return r;throw tt("Can't convert object to primitive value")}return void 0===t&&(t="number"),et(e,t)},it=nt,at=se,ot=function(e){var t=it(e,"string");return at(t)?t:t+""},st=q,ut=r.document,lt=st(ut)&&st(ut.createElement),ct=function(e){return lt?ut.createElement(e):{}},dt=ct,ft=!a&&!i((function(){return 7!=Object.defineProperty(dt("div"),"a",{get:function(){return 7}}).a})),pt=a,mt=l,ht=c,gt=g,yt=L,bt=ot,vt=Me,wt=ft,Ot=Object.getOwnPropertyDescriptor;n.f=pt?Ot:function(e,t){if(e=yt(e),t=bt(t),wt)try{return Ot(e,t)}catch(e){}if(vt(e,t))return gt(!mt(ht.f,e,t),e[t])};var St={},Ct=a&&i((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Et=q,At=String,Rt=TypeError,Pt=function(e){if(Et(e))return e;throw Rt(At(e)+" is not an object")},It=a,Nt=ft,Tt=Ct,xt=Pt,kt=ot,Mt=TypeError,$t=Object.defineProperty,Dt=Object.getOwnPropertyDescriptor,Lt="enumerable",jt="configurable",_t="writable";St.f=It?Tt?function(e,t,r){if(xt(e),t=kt(t),xt(r),"function"==typeof e&&"prototype"===t&&"value"in r&&_t in r&&!r.writable){var n=Dt(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:jt in r?r.configurable:n.configurable,enumerable:Lt in r?r.enumerable:n.enumerable,writable:!1})}return $t(e,t,r)}:$t:function(e,t,r){if(xt(e),t=kt(t),xt(r),Nt)try{return $t(e,t,r)}catch(e){}if("get"in r||"set"in r)throw Mt("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var qt=St,Vt=g,Ut=a?function(e,t,r){return qt.f(e,t,Vt(1,r))}:function(e,t,r){return e[t]=r,e},Ft={exports:{}},Bt=a,zt=Me,Kt=Function.prototype,Wt=Bt&&Object.getOwnPropertyDescriptor,Xt=zt(Kt,"name"),Zt={EXISTS:Xt,PROPER:Xt&&"something"===function(){}.name,CONFIGURABLE:Xt&&(!Bt||Bt&&Wt(Kt,"name").configurable)},Gt=j,Ht=Re,Jt=S(Function.toString);Gt(Ht.inspectSource)||(Ht.inspectSource=function(e){return Jt(e)});var Yt,Qt,er,tr=Ht.inspectSource,rr=j,nr=tr,ir=r.WeakMap,ar=rr(ir)&&/native code/.test(nr(ir)),or=we.exports,sr=_e,ur=or("keys"),lr=function(e){return ur[e]||(ur[e]=sr(e))},cr={},dr=ar,fr=r,pr=S,mr=q,hr=Ut,gr=Me,yr=Re,br=lr,vr=cr,wr="Object already initialized",Or=fr.TypeError,Sr=fr.WeakMap;if(dr||yr.state){var Cr=yr.state||(yr.state=new Sr),Er=pr(Cr.get),Ar=pr(Cr.has),Rr=pr(Cr.set);Yt=function(e,t){if(Ar(Cr,e))throw new Or(wr);return t.facade=e,Rr(Cr,e,t),t},Qt=function(e){return Er(Cr,e)||{}},er=function(e){return Ar(Cr,e)}}else{var Pr=br("state");vr[Pr]=!0,Yt=function(e,t){if(gr(e,Pr))throw new Or(wr);return t.facade=e,hr(e,Pr,t),t},Qt=function(e){return gr(e,Pr)?e[Pr]:{}},er=function(e){return gr(e,Pr)}}var Ir={set:Yt,get:Qt,has:er,enforce:function(e){return er(e)?Qt(e):Yt(e,{})},getterFor:function(e){return function(t){var r;if(!mr(t)||(r=Qt(t)).type!==e)throw Or("Incompatible receiver, "+e+" required");return r}}},Nr=i,Tr=j,xr=Me,kr=a,Mr=Zt.CONFIGURABLE,$r=tr,Dr=Ir.enforce,Lr=Ir.get,jr=Object.defineProperty,_r=kr&&!Nr((function(){return 8!==jr((function(){}),"length",{value:8}).length})),qr=String(String).split("String"),Vr=Ft.exports=function(e,t,r){"Symbol("===String(t).slice(0,7)&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!xr(e,"name")||Mr&&e.name!==t)&&(kr?jr(e,"name",{value:t,configurable:!0}):e.name=t),_r&&r&&xr(r,"arity")&&e.length!==r.arity&&jr(e,"length",{value:r.arity});try{r&&xr(r,"constructor")&&r.constructor?kr&&jr(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=Dr(e);return xr(n,"source")||(n.source=qr.join("string"==typeof t?t:"")),e};Function.prototype.toString=Vr((function(){return Tr(this)&&Lr(this).source||$r(this)}),"toString");var Ur=j,Fr=St,Br=Ft.exports,zr=Ce,Kr=function(e,t,r,n){n||(n={});var i=n.enumerable,a=void 0!==n.name?n.name:t;if(Ur(r)&&Br(r,a,n),n.global)i?e[t]=r:zr(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch(e){}i?e[t]=r:Fr.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},Wr={},Xr=Math.ceil,Zr=Math.floor,Gr=Math.trunc||function(e){var t=+e;return(t>0?Zr:Xr)(t)},Hr=function(e){var t=+e;return t!=t||0===t?0:Gr(t)},Jr=Hr,Yr=Math.max,Qr=Math.min,en=function(e,t){var r=Jr(e);return r<0?Yr(r+t,0):Qr(r,t)},tn=Hr,rn=Math.min,nn=function(e){return e>0?rn(tn(e),9007199254740991):0},an=nn,on=function(e){return an(e.length)},sn=L,un=en,ln=on,cn=function(e){return function(t,r,n){var i,a=sn(t),o=ln(a),s=un(n,o);if(e&&r!=r){for(;o>s;)if((i=a[s++])!=i)return!0}else for(;o>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},dn={includes:cn(!0),indexOf:cn(!1)},fn=Me,pn=L,mn=dn.indexOf,hn=cr,gn=S([].push),yn=function(e,t){var r,n=pn(e),i=0,a=[];for(r in n)!fn(hn,r)&&fn(n,r)&&gn(a,r);for(;t.length>i;)fn(n,r=t[i++])&&(~mn(a,r)||gn(a,r));return a},bn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],vn=yn,wn=bn.concat("length","prototype");Wr.f=Object.getOwnPropertyNames||function(e){return vn(e,wn)};var On={};On.f=Object.getOwnPropertySymbols;var Sn=B,Cn=Wr,En=On,An=Pt,Rn=S([].concat),Pn=Sn("Reflect","ownKeys")||function(e){var t=Cn.f(An(e)),r=En.f;return r?Rn(t,r(e)):t},In=Me,Nn=Pn,Tn=n,xn=St,kn=function(e,t,r){for(var n=Nn(t),i=xn.f,a=Tn.f,o=0;o<n.length;o++){var s=n[o];In(e,s)||r&&In(r,s)||i(e,s,a(t,s))}},Mn=i,$n=j,Dn=/#|\.prototype\./,Ln=function(e,t){var r=_n[jn(e)];return r==Vn||r!=qn&&($n(t)?Mn(t):!!t)},jn=Ln.normalize=function(e){return String(e).replace(Dn,".").toLowerCase()},_n=Ln.data={},qn=Ln.NATIVE="N",Vn=Ln.POLYFILL="P",Un=Ln,Fn=r,Bn=n.f,zn=Ut,Kn=Kr,Wn=Ce,Xn=kn,Zn=Un,Gn=function(e,t){var r,n,i,a,o,s=e.target,u=e.global,l=e.stat;if(r=u?Fn:l?Fn[s]||Wn(s,{}):(Fn[s]||{}).prototype)for(n in t){if(a=t[n],i=e.dontCallGetSet?(o=Bn(r,n))&&o.value:r[n],!Zn(u?n:s+(l?".":"#")+n,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;Xn(a,i)}(e.sham||i&&i.sham)&&zn(a,"sham",!0),Kn(r,n,a,e)}},Hn=o,Jn=Function.prototype,Yn=Jn.apply,Qn=Jn.call,ei="object"==typeof Reflect&&Reflect.apply||(Hn?Qn.bind(Yn):function(){return Qn.apply(Yn,arguments)}),ti=j,ri=String,ni=TypeError,ii=S,ai=Pt,oi=function(e){if("object"==typeof e||ti(e))return e;throw ni("Can't set "+ri(e)+" as a prototype")},si=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=ii(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(e){}return function(r,n){return ai(r),oi(n),t?e(r,n):r.__proto__=n,r}}():void 0),ui=St.f,li=j,ci=q,di=si,fi=function(e,t,r){var n,i;return di&&li(n=t.constructor)&&n!==r&&ci(i=n.prototype)&&i!==r.prototype&&di(e,i),e},pi={};pi[Ge("toStringTag")]="z";var mi="[object z]"===String(pi),hi=j,gi=R,yi=Ge("toStringTag"),bi=Object,vi="Arguments"==gi(function(){return arguments}()),wi=mi?gi:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=bi(e),yi))?r:vi?gi(t):"Object"==(n=gi(t))&&hi(t.callee)?"Arguments":n},Oi=wi,Si=String,Ci=function(e){if("Symbol"===Oi(e))throw TypeError("Cannot convert a Symbol value to a string");return Si(e)},Ei=Ci,Ai=function(e,t){return void 0===e?arguments.length<2?"":t:Ei(e)},Ri=q,Pi=Ut,Ii=function(e,t){Ri(t)&&"cause"in t&&Pi(e,"cause",t.cause)},Ni=Error,Ti=S("".replace),xi=String(Ni("zxcasd").stack),ki=/\n\s*at [^:]*:[^\n]*/,Mi=ki.test(xi),$i=function(e,t){if(Mi&&"string"==typeof e&&!Ni.prepareStackTrace)for(;t--;)e=Ti(e,ki,"");return e},Di=g,Li=!i((function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",Di(1,7)),7!==e.stack)})),ji=B,_i=Me,qi=Ut,Vi=z,Ui=si,Fi=kn,Bi=function(e,t,r){r in e||ui(e,r,{configurable:!0,get:function(){return t[r]},set:function(e){t[r]=e}})},zi=fi,Ki=Ai,Wi=Ii,Xi=$i,Zi=Li,Gi=a,Hi=function(e,t,r,n){var i="stackTraceLimit",a=n?2:1,o=e.split("."),s=o[o.length-1],u=ji.apply(null,o);if(u){var l=u.prototype;if(_i(l,"cause")&&delete l.cause,!r)return u;var c=ji("Error"),d=t((function(e,t){var r=Ki(n?t:e,void 0),i=n?new u(e):new u;return void 0!==r&&qi(i,"message",r),Zi&&qi(i,"stack",Xi(i.stack,2)),this&&Vi(l,this)&&zi(i,this,d),arguments.length>a&&Wi(i,arguments[a]),i}));d.prototype=l,"Error"!==s?Ui?Ui(d,c):Fi(d,c,{name:!0}):Gi&&i in u&&(Bi(d,u,i),Bi(d,u,"prepareStackTrace")),Fi(d,u);try{l.name!==s&&qi(l,"name",s),l.constructor=d}catch(e){}return d}},Ji=Gn,Yi=ei,Qi=Hi,ea="WebAssembly",ta=r.WebAssembly,ra=7!==Error("e",{cause:7}).cause,na=function(e,t){var r={};r[e]=Qi(e,t,ra),Ji({global:!0,constructor:!0,arity:1,forced:ra},r)},ia=function(e,t){if(ta&&ta[e]){var r={};r[e]=Qi("WebAssembly."+e,t,ra),Ji({target:ea,stat:!0,constructor:!0,arity:1,forced:ra},r)}};na("Error",(function(e){return function(t){return Yi(e,this,arguments)}})),na("EvalError",(function(e){return function(t){return Yi(e,this,arguments)}})),na("RangeError",(function(e){return function(t){return Yi(e,this,arguments)}})),na("ReferenceError",(function(e){return function(t){return Yi(e,this,arguments)}})),na("SyntaxError",(function(e){return function(t){return Yi(e,this,arguments)}})),na("TypeError",(function(e){return function(t){return Yi(e,this,arguments)}})),na("URIError",(function(e){return function(t){return Yi(e,this,arguments)}})),ia("CompileError",(function(e){return function(t){return Yi(e,this,arguments)}})),ia("LinkError",(function(e){return function(t){return Yi(e,this,arguments)}})),ia("RuntimeError",(function(e){return function(t){return Yi(e,this,arguments)}}));var aa=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),oa=Me,sa=j,ua=Te,la=aa,ca=lr("IE_PROTO"),da=Object,fa=da.prototype,pa=la?da.getPrototypeOf:function(e){var t=ua(e);if(oa(t,ca))return t[ca];var r=t.constructor;return sa(r)&&t instanceof r?r.prototype:t instanceof da?fa:null},ma={},ha=yn,ga=bn,ya=Object.keys||function(e){return ha(e,ga)},ba=a,va=Ct,wa=St,Oa=Pt,Sa=L,Ca=ya;ma.f=ba&&!va?Object.defineProperties:function(e,t){Oa(e);for(var r,n=Sa(t),i=Ca(t),a=i.length,o=0;a>o;)wa.f(e,r=i[o++],n[r]);return e};var Ea,Aa=B("document","documentElement"),Ra=Pt,Pa=ma,Ia=bn,Na=cr,Ta=Aa,xa=ct,ka=lr("IE_PROTO"),Ma=function(){},$a=function(e){return"<script>"+e+"</"+"script>"},Da=function(e){e.write($a("")),e.close();var t=e.parentWindow.Object;return e=null,t},La=function(){try{Ea=new ActiveXObject("htmlfile")}catch(e){}var e,t;La="undefined"!=typeof document?document.domain&&Ea?Da(Ea):((t=xa("iframe")).style.display="none",Ta.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write($a("document.F=Object")),e.close(),e.F):Da(Ea);for(var r=Ia.length;r--;)delete La.prototype[Ia[r]];return La()};Na[ka]=!0;var ja=Object.create||function(e,t){var r;return null!==e?(Ma.prototype=Ra(e),r=new Ma,Ma.prototype=null,r[ka]=e):r=La(),void 0===t?r:Pa.f(r,t)},_a=pe,qa=o,Va=S(S.bind),Ua=function(e,t){return _a(e),void 0===t?e:qa?Va(e,t):function(){return e.apply(t,arguments)}},Fa={},Ba=Fa,za=Ge("iterator"),Ka=Array.prototype,Wa=function(e){return void 0!==e&&(Ba.Array===e||Ka[za]===e)},Xa=wi,Za=he,Ga=Fa,Ha=Ge("iterator"),Ja=function(e){if(null!=e)return Za(e,Ha)||Za(e,"@@iterator")||Ga[Xa(e)]},Ya=l,Qa=pe,eo=Pt,to=le,ro=Ja,no=TypeError,io=function(e,t){var r=arguments.length<2?ro(e):t;if(Qa(r))return eo(Ya(r,e));throw no(to(e)+" is not iterable")},ao=l,oo=Pt,so=he,uo=function(e,t,r){var n,i;oo(e);try{if(!(n=so(e,"return"))){if("throw"===t)throw r;return r}n=ao(n,e)}catch(e){i=!0,n=e}if("throw"===t)throw r;if(i)throw n;return oo(n),r},lo=Ua,co=l,fo=Pt,po=le,mo=Wa,ho=on,go=z,yo=io,bo=Ja,vo=uo,wo=TypeError,Oo=function(e,t){this.stopped=e,this.result=t},So=Oo.prototype,Co=function(e,t,r){var n,i,a,o,s,u,l,c=r&&r.that,d=!(!r||!r.AS_ENTRIES),f=!(!r||!r.IS_ITERATOR),p=!(!r||!r.INTERRUPTED),m=lo(t,c),h=function(e){return n&&vo(n,"normal",e),new Oo(!0,e)},g=function(e){return d?(fo(e),p?m(e[0],e[1],h):m(e[0],e[1])):p?m(e,h):m(e)};if(f)n=e;else{if(!(i=bo(e)))throw wo(po(e)+" is not iterable");if(mo(i)){for(a=0,o=ho(e);o>a;a++)if((s=g(e[a]))&&go(So,s))return s;return new Oo(!1)}n=yo(e,i)}for(u=n.next;!(l=co(u,n)).done;){try{s=g(l.value)}catch(e){vo(n,"throw",e)}if("object"==typeof s&&s&&go(So,s))return s}return new Oo(!1)},Eo=Gn,Ao=z,Ro=pa,Po=si,Io=kn,No=ja,To=Ut,xo=g,ko=$i,Mo=Ii,$o=Co,Do=Ai,Lo=Li,jo=Ge("toStringTag"),_o=Error,qo=[].push,Vo=function(e,t){var r,n=arguments.length>2?arguments[2]:void 0,i=Ao(Uo,this);Po?r=Po(new _o,i?Ro(this):Uo):(r=i?this:No(Uo),To(r,jo,"Error")),void 0!==t&&To(r,"message",Do(t)),Lo&&To(r,"stack",ko(r.stack,1)),Mo(r,n);var a=[];return $o(e,qo,{that:a}),To(r,"errors",a),r};Po?Po(Vo,_o):Io(Vo,_o,{name:!0});var Uo=Vo.prototype=No(_o.prototype,{constructor:xo(1,Vo),message:xo(1,""),name:xo(1,"AggregateError")});Eo({global:!0,constructor:!0,arity:2},{AggregateError:Vo});var Fo=Gn,Bo=ei,zo=i,Ko=Hi,Wo="AggregateError",Xo=B(Wo),Zo=!zo((function(){return 1!==Xo([1]).errors[0]}))&&zo((function(){return 7!==Xo([1],Wo,{cause:7}).cause}));Fo({global:!0,constructor:!0,arity:2,forced:Zo},{AggregateError:Ko(Wo,(function(e){return function(t,r){return Bo(e,this,arguments)}}),Zo,!0)});var Go=Ge,Ho=ja,Jo=St.f,Yo=Go("unscopables"),Qo=Array.prototype;null==Qo[Yo]&&Jo(Qo,Yo,{configurable:!0,value:Ho(null)});var es=function(e){Qo[Yo][e]=!0},ts=Te,rs=on,ns=Hr,is=es;Gn({target:"Array",proto:!0},{at:function(e){var t=ts(this),r=rs(t),n=ns(e),i=n>=0?n:r+n;return i<0||i>=r?void 0:t[i]}}),is("at");var as=Ua,os=x,ss=Te,us=on,ls=function(e){var t=1==e;return function(r,n,i){for(var a,o=ss(r),s=os(o),u=as(n,i),l=us(s);l-- >0;)if(u(a=s[l],l,o))switch(e){case 0:return a;case 1:return l}return t?-1:void 0}},cs={findLast:ls(0),findLastIndex:ls(1)},ds=cs.findLast,fs=es;Gn({target:"Array",proto:!0},{findLast:function(e){return ds(this,e,arguments.length>1?arguments[1]:void 0)}}),fs("findLast");var ps=cs.findLastIndex,ms=es;Gn({target:"Array",proto:!0},{findLastIndex:function(e){return ps(this,e,arguments.length>1?arguments[1]:void 0)}}),ms("findLastIndex");var hs=dn.includes,gs=es;Gn({target:"Array",proto:!0,forced:i((function(){return!Array(1).includes()}))},{includes:function(e){return hs(this,e,arguments.length>1?arguments[1]:void 0)}}),gs("includes");var ys=TypeError,bs=function(e){if(e>9007199254740991)throw ys("Maximum allowed index exceeded");return e},vs=Gn,ws=Te,Os=on,Ss=bs,Cs=i((function(){return 4294967297!==[].push.call({length:4294967296},1)})),Es=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}();vs({target:"Array",proto:!0,arity:1,forced:Cs||Es},{push:function(e){var t=ws(this),r=Os(t),n=arguments.length;Ss(r+n);for(var i=0;i<n;i++)t[r]=arguments[i],r++;return t.length=r,r}});var As=le,Rs=TypeError,Ps=Gn,Is=Te,Ns=on,Ts=function(e,t){if(!delete e[t])throw Rs("Cannot delete property "+As(t)+" of "+As(e))},xs=bs,ks=1!==[].unshift(0),Ms=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}();Ps({target:"Array",proto:!0,arity:1,forced:ks||Ms},{unshift:function(e){var t=Is(this),r=Ns(t),n=arguments.length;if(n){xs(r+n);for(var i=r;i--;){var a=i+n;i in t?t[a]=t[i]:Ts(t,a)}for(var o=0;o<n;o++)t[o]=arguments[o]}return t.length=r+n}}),Gn({target:"Object",stat:!0},{hasOwn:Me});var $s={},Ds=pe,Ls=function(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=Ds(t),this.reject=Ds(r)};$s.f=function(e){return new Ls(e)};var js=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},_s=l,qs=pe,Vs=B,Us=$s,Fs=js,Bs=Co,zs="No one promise resolved";Gn({target:"Promise",stat:!0},{any:function(e){var t=this,r=Vs("AggregateError"),n=Us.f(t),i=n.resolve,a=n.reject,o=Fs((function(){var n=qs(t.resolve),o=[],s=0,u=1,l=!1;Bs(e,(function(e){var c=s++,d=!1;u++,_s(n,t,e).then((function(e){d||l||(l=!0,i(e))}),(function(e){d||l||(d=!0,o[c]=e,--u||a(new r(o,zs)))}))})),--u||a(new r(o,zs))}));return o.error&&a(o.value),n.promise}});var Ks=St.f,Ws=Me,Xs=Ge("toStringTag"),Zs=function(e,t,r){e&&!r&&(e=e.prototype),e&&!Ws(e,Xs)&&Ks(e,Xs,{configurable:!0,value:t})},Gs=r,Hs=Zs;Gn({global:!0},{Reflect:{}}),Hs(Gs.Reflect,"Reflect",!0);var Js=Ft.exports,Ys=St,Qs=function(e,t,r){return r.get&&Js(r.get,t,{getter:!0}),r.set&&Js(r.set,t,{setter:!0}),Ys.f(e,t,r)},eu=Pt,tu=function(){var e=eu(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ru=a,nu=Qs,iu=tu,au=i,ou=r.RegExp,su=ou.prototype,uu=ru&&au((function(){var e=!0;try{ou(".","d")}catch(t){e=!1}var t={},r="",n=e?"dgimsy":"gimsy",i=function(e,n){Object.defineProperty(t,e,{get:function(){return r+=n,!0}})},a={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var o in e&&(a.hasIndices="d"),a)i(o,a[o]);return Object.getOwnPropertyDescriptor(su,"flags").get.call(t)!==n||r!==n}));uu&&nu(su,"flags",{configurable:!0,get:iu});var lu=Gn,cu=M,du=Hr,fu=Ci,pu=i,mu=S("".charAt);lu({target:"String",proto:!0,forced:pu((function(){return"\ud842"!=="𠮷".at(-2)}))},{at:function(e){var t=fu(cu(this)),r=t.length,n=du(e),i=n>=0?n:r+n;return i<0||i>=r?void 0:mu(t,i)}});var hu,gu,yu=i,bu=r.RegExp,vu=yu((function(){var e=bu("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),wu=vu||yu((function(){return!bu("a","y").sticky})),Ou={BROKEN_CARET:vu||yu((function(){var e=bu("^r","gy");return e.lastIndex=2,null!=e.exec("str")})),MISSED_STICKY:wu,UNSUPPORTED_Y:vu},Su=i,Cu=r.RegExp,Eu=Su((function(){var e=Cu(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)})),Au=i,Ru=r.RegExp,Pu=Au((function(){var e=Ru("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")})),Iu=l,Nu=S,Tu=Ci,xu=tu,ku=Ou,Mu=we.exports,$u=ja,Du=Ir.get,Lu=Eu,ju=Pu,_u=Mu("native-string-replace",String.prototype.replace),qu=RegExp.prototype.exec,Vu=qu,Uu=Nu("".charAt),Fu=Nu("".indexOf),Bu=Nu("".replace),zu=Nu("".slice),Ku=(gu=/b*/g,Iu(qu,hu=/a/,"a"),Iu(qu,gu,"a"),0!==hu.lastIndex||0!==gu.lastIndex),Wu=ku.BROKEN_CARET,Xu=void 0!==/()??/.exec("")[1];(Ku||Xu||Wu||Lu||ju)&&(Vu=function(e){var t,r,n,i,a,o,s,u=this,l=Du(u),c=Tu(e),d=l.raw;if(d)return d.lastIndex=u.lastIndex,t=Iu(Vu,d,c),u.lastIndex=d.lastIndex,t;var f=l.groups,p=Wu&&u.sticky,m=Iu(xu,u),h=u.source,g=0,y=c;if(p&&(m=Bu(m,"y",""),-1===Fu(m,"g")&&(m+="g"),y=zu(c,u.lastIndex),u.lastIndex>0&&(!u.multiline||u.multiline&&"\n"!==Uu(c,u.lastIndex-1))&&(h="(?: "+h+")",y=" "+y,g++),r=new RegExp("^(?:"+h+")",m)),Xu&&(r=new RegExp("^"+h+"$(?!\\s)",m)),Ku&&(n=u.lastIndex),i=Iu(qu,p?r:u,y),p?i?(i.input=zu(i.input,g),i[0]=zu(i[0],g),i.index=u.lastIndex,u.lastIndex+=i[0].length):u.lastIndex=0:Ku&&i&&(u.lastIndex=u.global?i.index+i[0].length:n),Xu&&i&&i.length>1&&Iu(_u,i[0],r,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(i[a]=void 0)})),i&&f)for(i.groups=o=$u(null),a=0;a<f.length;a++)o[(s=f[a])[0]]=i[s[1]];return i});var Zu=Vu;Gn({target:"RegExp",proto:!0,forced:/./.exec!==Zu},{exec:Zu});var Gu=S,Hu=Kr,Ju=Zu,Yu=i,Qu=Ge,el=Ut,tl=Qu("species"),rl=RegExp.prototype,nl=S,il=Hr,al=Ci,ol=M,sl=nl("".charAt),ul=nl("".charCodeAt),ll=nl("".slice),cl=function(e){return function(t,r){var n,i,a=al(ol(t)),o=il(r),s=a.length;return o<0||o>=s?e?"":void 0:(n=ul(a,o))<55296||n>56319||o+1===s||(i=ul(a,o+1))<56320||i>57343?e?sl(a,o):n:e?ll(a,o,o+2):i-56320+(n-55296<<10)+65536}},dl={codeAt:cl(!1),charAt:cl(!0)},fl=dl.charAt,pl=S,ml=Te,hl=Math.floor,gl=pl("".charAt),yl=pl("".replace),bl=pl("".slice),vl=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,wl=/\$([$&'`]|\d{1,2})/g,Ol=l,Sl=Pt,Cl=j,El=R,Al=Zu,Rl=TypeError,Pl=ei,Il=l,Nl=S,Tl=function(e,t,r,n){var i=Qu(e),a=!Yu((function(){var t={};return t[i]=function(){return 7},7!=""[e](t)})),o=a&&!Yu((function(){var t=!1,r=/a/;return"split"===e&&((r={}).constructor={},r.constructor[tl]=function(){return r},r.flags="",r[i]=/./[i]),r.exec=function(){return t=!0,null},r[i](""),!t}));if(!a||!o||r){var s=Gu(/./[i]),u=t(i,""[e],(function(e,t,r,n,i){var o=Gu(e),u=t.exec;return u===Ju||u===rl.exec?a&&!i?{done:!0,value:s(t,r,n)}:{done:!0,value:o(r,t,n)}:{done:!1}}));Hu(String.prototype,e,u[0]),Hu(rl,i,u[1])}n&&el(rl[i],"sham",!0)},xl=i,kl=Pt,Ml=j,$l=Hr,Dl=nn,Ll=Ci,jl=M,_l=function(e,t,r){return t+(r?fl(e,t).length:1)},ql=he,Vl=function(e,t,r,n,i,a){var o=r+e.length,s=n.length,u=wl;return void 0!==i&&(i=ml(i),u=vl),yl(a,u,(function(a,u){var l;switch(gl(u,0)){case"$":return"$";case"&":return e;case"`":return bl(t,0,r);case"'":return bl(t,o);case"<":l=i[bl(u,1,-1)];break;default:var c=+u;if(0===c)return a;if(c>s){var d=hl(c/10);return 0===d?a:d<=s?void 0===n[d-1]?gl(u,1):n[d-1]+gl(u,1):a}l=n[c-1]}return void 0===l?"":l}))},Ul=function(e,t){var r=e.exec;if(Cl(r)){var n=Ol(r,e,t);return null!==n&&Sl(n),n}if("RegExp"===El(e))return Ol(Al,e,t);throw Rl("RegExp#exec called on incompatible receiver")},Fl=Ge("replace"),Bl=Math.max,zl=Math.min,Kl=Nl([].concat),Wl=Nl([].push),Xl=Nl("".indexOf),Zl=Nl("".slice),Gl="$0"==="a".replace(/./,"$0"),Hl=!!/./[Fl]&&""===/./[Fl]("a","$0");Tl("replace",(function(e,t,r){var n=Hl?"$":"$0";return[function(e,r){var n=jl(this),i=null==e?void 0:ql(e,Fl);return i?Il(i,e,n,r):Il(t,Ll(n),e,r)},function(e,i){var a=kl(this),o=Ll(e);if("string"==typeof i&&-1===Xl(i,n)&&-1===Xl(i,"$<")){var s=r(t,a,o,i);if(s.done)return s.value}var u=Ml(i);u||(i=Ll(i));var l=a.global;if(l){var c=a.unicode;a.lastIndex=0}for(var d=[];;){var f=Ul(a,o);if(null===f)break;if(Wl(d,f),!l)break;""===Ll(f[0])&&(a.lastIndex=_l(o,Dl(a.lastIndex),c))}for(var p,m="",h=0,g=0;g<d.length;g++){for(var y=Ll((f=d[g])[0]),b=Bl(zl($l(f.index),o.length),0),v=[],w=1;w<f.length;w++)Wl(v,void 0===(p=f[w])?p:String(p));var O=f.groups;if(u){var S=Kl([y],v,b,o);void 0!==O&&Wl(S,O);var C=Ll(Pl(i,void 0,S))}else C=Vl(y,o,b,v,O,i);b>=h&&(m+=Zl(o,h,b)+C,h=b+y.length)}return m+Zl(o,h)}]}),!!xl((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!Gl||Hl);var Jl={exports:{}},Yl=Ge("iterator"),Ql=!1;try{var ec=0,tc={next:function(){return{done:!!ec++}},return:function(){Ql=!0}};tc[Yl]=function(){return this},Array.from(tc,(function(){throw 2}))}catch(XV){}var rc,nc,ic,ac=function(e,t){if(!t&&!Ql)return!1;var r=!1;try{var n={};n[Yl]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch(e){}return r},oc="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,sc=oc,uc=a,lc=r,cc=j,dc=q,fc=Me,pc=wi,mc=le,hc=Ut,gc=Kr,yc=St.f,bc=z,vc=pa,wc=si,Oc=Ge,Sc=_e,Cc=Ir.enforce,Ec=Ir.get,Ac=lc.Int8Array,Rc=Ac&&Ac.prototype,Pc=lc.Uint8ClampedArray,Ic=Pc&&Pc.prototype,Nc=Ac&&vc(Ac),Tc=Rc&&vc(Rc),xc=Object.prototype,kc=lc.TypeError,Mc=Oc("toStringTag"),$c=Sc("TYPED_ARRAY_TAG"),Dc="TypedArrayConstructor",Lc=sc&&!!wc&&"Opera"!==pc(lc.opera),jc=!1,_c={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},qc={BigInt64Array:8,BigUint64Array:8},Vc=function(e){var t=vc(e);if(dc(t)){var r=Ec(t);return r&&fc(r,Dc)?r.TypedArrayConstructor:Vc(t)}},Uc=function(e){if(!dc(e))return!1;var t=pc(e);return fc(_c,t)||fc(qc,t)};for(rc in _c)(ic=(nc=lc[rc])&&nc.prototype)?Cc(ic).TypedArrayConstructor=nc:Lc=!1;for(rc in qc)(ic=(nc=lc[rc])&&nc.prototype)&&(Cc(ic).TypedArrayConstructor=nc);if((!Lc||!cc(Nc)||Nc===Function.prototype)&&(Nc=function(){throw kc("Incorrect invocation")},Lc))for(rc in _c)lc[rc]&&wc(lc[rc],Nc);if((!Lc||!Tc||Tc===xc)&&(Tc=Nc.prototype,Lc))for(rc in _c)lc[rc]&&wc(lc[rc].prototype,Tc);if(Lc&&vc(Ic)!==Tc&&wc(Ic,Tc),uc&&!fc(Tc,Mc))for(rc in jc=!0,yc(Tc,Mc,{get:function(){return dc(this)?this[$c]:void 0}}),_c)lc[rc]&&hc(lc[rc],$c,rc);var Fc={NATIVE_ARRAY_BUFFER_VIEWS:Lc,TYPED_ARRAY_TAG:jc&&$c,aTypedArray:function(e){if(Uc(e))return e;throw kc("Target is not a typed array")},aTypedArrayConstructor:function(e){if(cc(e)&&(!wc||bc(Nc,e)))return e;throw kc(mc(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(uc){if(r)for(var i in _c){var a=lc[i];if(a&&fc(a.prototype,e))try{delete a.prototype[e]}catch(r){try{a.prototype[e]=t}catch(e){}}}Tc[e]&&!r||gc(Tc,e,r?t:Lc&&Rc[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,i;if(uc){if(wc){if(r)for(n in _c)if((i=lc[n])&&fc(i,e))try{delete i[e]}catch(e){}if(Nc[e]&&!r)return;try{return gc(Nc,e,r?t:Lc&&Nc[e]||t)}catch(e){}}for(n in _c)!(i=lc[n])||i[e]&&!r||gc(i,e,t)}},getTypedArrayConstructor:Vc,isView:function(e){if(!dc(e))return!1;var t=pc(e);return"DataView"===t||fc(_c,t)||fc(qc,t)},isTypedArray:Uc,TypedArray:Nc,TypedArrayPrototype:Tc},Bc=r,zc=i,Kc=ac,Wc=Fc.NATIVE_ARRAY_BUFFER_VIEWS,Xc=Bc.ArrayBuffer,Zc=Bc.Int8Array,Gc=!Wc||!zc((function(){Zc(1)}))||!zc((function(){new Zc(-1)}))||!Kc((function(e){new Zc,new Zc(null),new Zc(1.5),new Zc(e)}),!0)||zc((function(){return 1!==new Zc(new Xc(2),1,void 0).length})),Hc=Kr,Jc=function(e,t,r){for(var n in t)Hc(e,n,t[n],r);return e},Yc=z,Qc=TypeError,ed=function(e,t){if(Yc(t,e))return e;throw Qc("Incorrect invocation")},td=Hr,rd=nn,nd=RangeError,id=function(e){if(void 0===e)return 0;var t=td(e),r=rd(t);if(t!==r)throw nd("Wrong length or index");return r},ad=Array,od=Math.abs,sd=Math.pow,ud=Math.floor,ld=Math.log,cd=Math.LN2,dd={pack:function(e,t,r){var n,i,a,o=ad(r),s=8*r-t-1,u=(1<<s)-1,l=u>>1,c=23===t?sd(2,-24)-sd(2,-77):0,d=e<0||0===e&&1/e<0?1:0,f=0;for((e=od(e))!=e||e===1/0?(i=e!=e?1:0,n=u):(n=ud(ld(e)/cd),e*(a=sd(2,-n))<1&&(n--,a*=2),(e+=n+l>=1?c/a:c*sd(2,1-l))*a>=2&&(n++,a/=2),n+l>=u?(i=0,n=u):n+l>=1?(i=(e*a-1)*sd(2,t),n+=l):(i=e*sd(2,l-1)*sd(2,t),n=0));t>=8;)o[f++]=255&i,i/=256,t-=8;for(n=n<<t|i,s+=t;s>0;)o[f++]=255&n,n/=256,s-=8;return o[--f]|=128*d,o},unpack:function(e,t){var r,n=e.length,i=8*n-t-1,a=(1<<i)-1,o=a>>1,s=i-7,u=n-1,l=e[u--],c=127&l;for(l>>=7;s>0;)c=256*c+e[u--],s-=8;for(r=c&(1<<-s)-1,c>>=-s,s+=t;s>0;)r=256*r+e[u--],s-=8;if(0===c)c=1-o;else{if(c===a)return r?NaN:l?-1/0:1/0;r+=sd(2,t),c-=o}return(l?-1:1)*r*sd(2,c-t)}},fd=Te,pd=en,md=on,hd=function(e){for(var t=fd(this),r=md(t),n=arguments.length,i=pd(n>1?arguments[1]:void 0,r),a=n>2?arguments[2]:void 0,o=void 0===a?r:pd(a,r);o>i;)t[i++]=e;return t},gd=ot,yd=St,bd=g,vd=function(e,t,r){var n=gd(t);n in e?yd.f(e,n,bd(0,r)):e[n]=r},wd=en,Od=on,Sd=vd,Cd=Array,Ed=Math.max,Ad=function(e,t,r){for(var n=Od(e),i=wd(t,n),a=wd(void 0===r?n:r,n),o=Cd(Ed(a-i,0)),s=0;i<a;i++,s++)Sd(o,s,e[i]);return o.length=s,o},Rd=r,Pd=S,Id=a,Nd=oc,Td=Zt,xd=Ut,kd=Jc,Md=i,$d=ed,Dd=Hr,Ld=nn,jd=id,_d=dd,qd=pa,Vd=si,Ud=Wr.f,Fd=St.f,Bd=hd,zd=Ad,Kd=Zs,Wd=Td.PROPER,Xd=Td.CONFIGURABLE,Zd=Ir.get,Gd=Ir.set,Hd="ArrayBuffer",Jd="DataView",Yd="Wrong index",Qd=Rd.ArrayBuffer,ef=Qd,tf=ef&&ef.prototype,rf=Rd.DataView,nf=rf&&rf.prototype,af=Object.prototype,of=Rd.Array,sf=Rd.RangeError,uf=Pd(Bd),lf=Pd([].reverse),cf=_d.pack,df=_d.unpack,ff=function(e){return[255&e]},pf=function(e){return[255&e,e>>8&255]},mf=function(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]},hf=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},gf=function(e){return cf(e,23,4)},yf=function(e){return cf(e,52,8)},bf=function(e,t){Fd(e.prototype,t,{get:function(){return Zd(this)[t]}})},vf=function(e,t,r,n){var i=jd(r),a=Zd(e);if(i+t>a.byteLength)throw sf(Yd);var o=Zd(a.buffer).bytes,s=i+a.byteOffset,u=zd(o,s,s+t);return n?u:lf(u)},wf=function(e,t,r,n,i,a){var o=jd(r),s=Zd(e);if(o+t>s.byteLength)throw sf(Yd);for(var u=Zd(s.buffer).bytes,l=o+s.byteOffset,c=n(+i),d=0;d<t;d++)u[l+d]=c[a?d:t-d-1]};if(Nd){var Of=Wd&&Qd.name!==Hd;if(Md((function(){Qd(1)}))&&Md((function(){new Qd(-1)}))&&!Md((function(){return new Qd,new Qd(1.5),new Qd(NaN),Of&&!Xd})))Of&&Xd&&xd(Qd,"name",Hd);else{ef=function(e){return $d(this,tf),new Qd(jd(e))},ef.prototype=tf;for(var Sf,Cf=Ud(Qd),Ef=0;Cf.length>Ef;)(Sf=Cf[Ef++])in ef||xd(ef,Sf,Qd[Sf]);tf.constructor=ef}Vd&&qd(nf)!==af&&Vd(nf,af);var Af=new rf(new ef(2)),Rf=Pd(nf.setInt8);Af.setInt8(0,2147483648),Af.setInt8(1,2147483649),!Af.getInt8(0)&&Af.getInt8(1)||kd(nf,{setInt8:function(e,t){Rf(this,e,t<<24>>24)},setUint8:function(e,t){Rf(this,e,t<<24>>24)}},{unsafe:!0})}else ef=function(e){$d(this,tf);var t=jd(e);Gd(this,{bytes:uf(of(t),0),byteLength:t}),Id||(this.byteLength=t)},tf=ef.prototype,nf=(rf=function(e,t,r){$d(this,nf),$d(e,tf);var n=Zd(e).byteLength,i=Dd(t);if(i<0||i>n)throw sf("Wrong offset");if(i+(r=void 0===r?n-i:Ld(r))>n)throw sf("Wrong length");Gd(this,{buffer:e,byteLength:r,byteOffset:i}),Id||(this.buffer=e,this.byteLength=r,this.byteOffset=i)}).prototype,Id&&(bf(ef,"byteLength"),bf(rf,"buffer"),bf(rf,"byteLength"),bf(rf,"byteOffset")),kd(nf,{getInt8:function(e){return vf(this,1,e)[0]<<24>>24},getUint8:function(e){return vf(this,1,e)[0]},getInt16:function(e){var t=vf(this,2,e,arguments.length>1?arguments[1]:void 0);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=vf(this,2,e,arguments.length>1?arguments[1]:void 0);return t[1]<<8|t[0]},getInt32:function(e){return hf(vf(this,4,e,arguments.length>1?arguments[1]:void 0))},getUint32:function(e){return hf(vf(this,4,e,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(e){return df(vf(this,4,e,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(e){return df(vf(this,8,e,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(e,t){wf(this,1,e,ff,t)},setUint8:function(e,t){wf(this,1,e,ff,t)},setInt16:function(e,t){wf(this,2,e,pf,t,arguments.length>2?arguments[2]:void 0)},setUint16:function(e,t){wf(this,2,e,pf,t,arguments.length>2?arguments[2]:void 0)},setInt32:function(e,t){wf(this,4,e,mf,t,arguments.length>2?arguments[2]:void 0)},setUint32:function(e,t){wf(this,4,e,mf,t,arguments.length>2?arguments[2]:void 0)},setFloat32:function(e,t){wf(this,4,e,gf,t,arguments.length>2?arguments[2]:void 0)},setFloat64:function(e,t){wf(this,8,e,yf,t,arguments.length>2?arguments[2]:void 0)}});Kd(ef,Hd),Kd(rf,Jd);var Pf={ArrayBuffer:ef,DataView:rf},If=q,Nf=Math.floor,Tf=Number.isInteger||function(e){return!If(e)&&isFinite(e)&&Nf(e)===e},xf=Hr,kf=RangeError,Mf=function(e){var t=xf(e);if(t<0)throw kf("The argument can't be less than 0");return t},$f=Mf,Df=RangeError,Lf=function(e,t){var r=$f(e);if(r%t)throw Df("Wrong offset");return r},jf=S,_f=i,qf=j,Vf=wi,Uf=tr,Ff=function(){},Bf=[],zf=B("Reflect","construct"),Kf=/^\s*(?:class|function)\b/,Wf=jf(Kf.exec),Xf=!Kf.exec(Ff),Zf=function(e){if(!qf(e))return!1;try{return zf(Ff,Bf,e),!0}catch(e){return!1}},Gf=function(e){if(!qf(e))return!1;switch(Vf(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Xf||!!Wf(Kf,Uf(e))}catch(e){return!0}};Gf.sham=!0;var Hf=!zf||_f((function(){var e;return Zf(Zf.call)||!Zf(Object)||!Zf((function(){e=!0}))||e}))?Gf:Zf,Jf=Hf,Yf=le,Qf=TypeError,ep=function(e){if(Jf(e))return e;throw Qf(Yf(e)+" is not a constructor")},tp=Ua,rp=l,np=ep,ip=Te,ap=on,op=io,sp=Ja,up=Wa,lp=Fc.aTypedArrayConstructor,cp=function(e){var t,r,n,i,a,o,s=np(this),u=ip(e),l=arguments.length,c=l>1?arguments[1]:void 0,d=void 0!==c,f=sp(u);if(f&&!up(f))for(o=(a=op(u,f)).next,u=[];!(i=rp(o,a)).done;)u.push(i.value);for(d&&l>2&&(c=tp(c,arguments[2])),r=ap(u),n=new(lp(s))(r),t=0;r>t;t++)n[t]=d?c(u[t],t):u[t];return n},dp=R,fp=Array.isArray||function(e){return"Array"==dp(e)},pp=fp,mp=Hf,hp=q,gp=Ge("species"),yp=Array,bp=function(e){var t;return pp(e)&&(t=e.constructor,(mp(t)&&(t===yp||pp(t.prototype))||hp(t)&&null===(t=t[gp]))&&(t=void 0)),void 0===t?yp:t},vp=function(e,t){return new(bp(e))(0===t?0:t)},wp=Ua,Op=x,Sp=Te,Cp=on,Ep=vp,Ap=S([].push),Rp=function(e){var t=1==e,r=2==e,n=3==e,i=4==e,a=6==e,o=7==e,s=5==e||a;return function(u,l,c,d){for(var f,p,m=Sp(u),h=Op(m),g=wp(l,c),y=Cp(h),b=0,v=d||Ep,w=t?v(u,y):r||o?v(u,0):void 0;y>b;b++)if((s||b in h)&&(p=g(f=h[b],b,m),e))if(t)w[b]=p;else if(p)switch(e){case 3:return!0;case 5:return f;case 6:return b;case 2:Ap(w,f)}else switch(e){case 4:return!1;case 7:Ap(w,f)}return a?-1:n||i?i:w}},Pp={forEach:Rp(0),map:Rp(1),filter:Rp(2),some:Rp(3),every:Rp(4),find:Rp(5),findIndex:Rp(6),filterReject:Rp(7)},Ip=B,Np=St,Tp=a,xp=Ge("species"),kp=function(e){var t=Ip(e),r=Np.f;Tp&&t&&!t[xp]&&r(t,xp,{configurable:!0,get:function(){return this}})},Mp=Gn,$p=r,Dp=l,Lp=a,jp=Gc,_p=Fc,qp=Pf,Vp=ed,Up=g,Fp=Ut,Bp=Tf,zp=nn,Kp=id,Wp=Lf,Xp=ot,Zp=Me,Gp=wi,Hp=q,Jp=se,Yp=ja,Qp=z,em=si,tm=Wr.f,rm=cp,nm=Pp.forEach,im=kp,am=St,om=n,sm=fi,um=Ir.get,lm=Ir.set,cm=Ir.enforce,dm=am.f,fm=om.f,pm=Math.round,mm=$p.RangeError,hm=qp.ArrayBuffer,gm=hm.prototype,ym=qp.DataView,bm=_p.NATIVE_ARRAY_BUFFER_VIEWS,vm=_p.TYPED_ARRAY_TAG,wm=_p.TypedArray,Om=_p.TypedArrayPrototype,Sm=_p.aTypedArrayConstructor,Cm=_p.isTypedArray,Em="BYTES_PER_ELEMENT",Am="Wrong length",Rm=function(e,t){Sm(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},Pm=function(e,t){dm(e,t,{get:function(){return um(this)[t]}})},Im=function(e){var t;return Qp(gm,e)||"ArrayBuffer"==(t=Gp(e))||"SharedArrayBuffer"==t},Nm=function(e,t){return Cm(e)&&!Jp(t)&&t in e&&Bp(+t)&&t>=0},Tm=function(e,t){return t=Xp(t),Nm(e,t)?Up(2,e[t]):fm(e,t)},xm=function(e,t,r){return t=Xp(t),!(Nm(e,t)&&Hp(r)&&Zp(r,"value"))||Zp(r,"get")||Zp(r,"set")||r.configurable||Zp(r,"writable")&&!r.writable||Zp(r,"enumerable")&&!r.enumerable?dm(e,t,r):(e[t]=r.value,e)};Lp?(bm||(om.f=Tm,am.f=xm,Pm(Om,"buffer"),Pm(Om,"byteOffset"),Pm(Om,"byteLength"),Pm(Om,"length")),Mp({target:"Object",stat:!0,forced:!bm},{getOwnPropertyDescriptor:Tm,defineProperty:xm}),Jl.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",a="get"+e,o="set"+e,s=$p[i],u=s,l=u&&u.prototype,c={},d=function(e,t){dm(e,t,{get:function(){return function(e,t){var r=um(e);return r.view[a](t*n+r.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,i){var a=um(e);r&&(i=(i=pm(i))<0?0:i>255?255:255&i),a.view[o](t*n+a.byteOffset,i,!0)}(this,t,e)},enumerable:!0})};bm?jp&&(u=t((function(e,t,r,i){return Vp(e,l),sm(Hp(t)?Im(t)?void 0!==i?new s(t,Wp(r,n),i):void 0!==r?new s(t,Wp(r,n)):new s(t):Cm(t)?Rm(u,t):Dp(rm,u,t):new s(Kp(t)),e,u)})),em&&em(u,wm),nm(tm(s),(function(e){e in u||Fp(u,e,s[e])})),u.prototype=l):(u=t((function(e,t,r,i){Vp(e,l);var a,o,s,c=0,f=0;if(Hp(t)){if(!Im(t))return Cm(t)?Rm(u,t):Dp(rm,u,t);a=t,f=Wp(r,n);var p=t.byteLength;if(void 0===i){if(p%n)throw mm(Am);if((o=p-f)<0)throw mm(Am)}else if((o=zp(i)*n)+f>p)throw mm(Am);s=o/n}else s=Kp(t),a=new hm(o=s*n);for(lm(e,{buffer:a,byteOffset:f,byteLength:o,length:s,view:new ym(a)});c<s;)d(e,c++)})),em&&em(u,wm),l=u.prototype=Yp(Om)),l.constructor!==u&&Fp(l,"constructor",u),cm(l).TypedArrayConstructor=u,vm&&Fp(l,vm,i);var f=u!=s;c[i]=u,Mp({global:!0,constructor:!0,forced:f,sham:!bm},c),Em in u||Fp(u,Em,n),Em in l||Fp(l,Em,n),im(i)}):Jl.exports=function(){},(0,Jl.exports)("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Int8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0),(0,Jl.exports)("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}})),(0,Jl.exports)("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}));var km=on,Mm=Hr,$m=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("at",(function(e){var t=$m(this),r=km(t),n=Mm(e),i=n>=0?n:r+n;return i<0||i>=r?void 0:t[i]}));var Dm=nt,Lm=TypeError,jm=function(e){var t=Dm(e,"number");if("number"==typeof t)throw Lm("Can't convert number to bigint");return BigInt(t)},_m=hd,qm=jm,Vm=wi,Um=l,Fm=i,Bm=Fc.aTypedArray,zm=Fc.exportTypedArrayMethod,Km=S("".slice);zm("fill",(function(e){var t=arguments.length;Bm(this);var r="Big"===Km(Vm(this),0,3)?qm(e):+e;return Um(_m,this,r,t>1?arguments[1]:void 0,t>2?arguments[2]:void 0)}),Fm((function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),1!==e})));var Wm=cs.findLast,Xm=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("findLast",(function(e){return Wm(Xm(this),e,arguments.length>1?arguments[1]:void 0)}));var Zm=cs.findLastIndex,Gm=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("findLastIndex",(function(e){return Zm(Gm(this),e,arguments.length>1?arguments[1]:void 0)})),(0,Fc.exportTypedArrayStaticMethod)("from",cp,Gc);var Hm=Fc.aTypedArrayConstructor;(0,Fc.exportTypedArrayStaticMethod)("of",(function(){for(var e=0,t=arguments.length,r=new(Hm(this))(t);t>e;)r[e]=arguments[e++];return r}),Gc);var Jm=r,Ym=l,Qm=Fc,eh=on,th=Lf,rh=Te,nh=i,ih=Jm.RangeError,ah=Jm.Int8Array,oh=ah&&ah.prototype,sh=oh&&oh.set,uh=Qm.aTypedArray,lh=Qm.exportTypedArrayMethod,ch=!nh((function(){var e=new Uint8ClampedArray(2);return Ym(sh,e,{length:1,0:3},1),3!==e[1]})),dh=ch&&Qm.NATIVE_ARRAY_BUFFER_VIEWS&&nh((function(){var e=new ah(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));lh("set",(function(e){uh(this);var t=th(arguments.length>1?arguments[1]:void 0,1),r=rh(e);if(ch)return Ym(sh,this,r,t);var n=this.length,i=eh(r),a=0;if(i+t>n)throw ih("Wrong length");for(;a<i;)this[t+a]=r[a++]}),!ch||dh);var fh=Ad,ph=Math.floor,mh=function(e,t){var r=e.length,n=ph(r/2);return r<8?hh(e,t):gh(e,mh(fh(e,0,n),t),mh(fh(e,n),t),t)},hh=function(e,t){for(var r,n,i=e.length,a=1;a<i;){for(n=a,r=e[a];n&&t(e[n-1],r)>0;)e[n]=e[--n];n!==a++&&(e[n]=r)}return e},gh=function(e,t,r,n){for(var i=t.length,a=r.length,o=0,s=0;o<i||s<a;)e[o+s]=o<i&&s<a?n(t[o],r[s])<=0?t[o++]:r[s++]:o<i?t[o++]:r[s++];return e},yh=mh,bh=K.match(/firefox\/(\d+)/i),vh=!!bh&&+bh[1],wh=/MSIE|Trident/.test(K),Oh=K.match(/AppleWebKit\/(\d+)\./),Sh=!!Oh&&+Oh[1],Ch=S,Eh=i,Ah=pe,Rh=yh,Ph=vh,Ih=wh,Nh=Y,Th=Sh,xh=Fc.aTypedArray,kh=Fc.exportTypedArrayMethod,Mh=r.Uint16Array,$h=Mh&&Ch(Mh.prototype.sort),Dh=!(!$h||Eh((function(){$h(new Mh(2),null)}))&&Eh((function(){$h(new Mh(2),{})}))),Lh=!!$h&&!Eh((function(){if(Nh)return Nh<74;if(Ph)return Ph<67;if(Ih)return!0;if(Th)return Th<602;var e,t,r=new Mh(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for($h(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));kh("sort",(function(e){return void 0!==e&&Ah(e),Lh?$h(this,e):Rh(xh(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!Lh||Dh);var jh,_h,qh=r,Vh=Re,Uh=j,Fh=pa,Bh=Kr,zh=Ge("asyncIterator"),Kh=qh.AsyncIterator,Wh=Vh.AsyncIteratorPrototype;if(Wh)jh=Wh;else if(Uh(Kh))jh=Kh.prototype;else if(Vh.USE_FUNCTION_CONSTRUCTOR||qh.USE_FUNCTION_CONSTRUCTOR)try{_h=Fh(Fh(Fh(Function("return async function*(){}()")()))),Fh(_h)===Object.prototype&&(jh=_h)}catch(XV){}jh||(jh={}),Uh(jh[zh])||Bh(jh,zh,(function(){return this}));var Xh=jh,Zh=ei,Gh=Pt,Hh=ja,Jh=he,Yh=Jc,Qh=Ir,eg=Xh,tg=B("Promise"),rg="AsyncFromSyncIterator",ng=Qh.set,ig=Qh.getterFor(rg),ag=function(e,t,r){var n=e.done;tg.resolve(e.value).then((function(e){t({done:n,value:e})}),r)},og=function(e){ng(this,{type:rg,iterator:Gh(e),next:e.next})};og.prototype=Yh(Hh(eg),{next:function(e){var t=ig(this),r=!!arguments.length;return new tg((function(n,i){var a=Gh(Zh(t.next,t.iterator,r?[e]:[]));ag(a,n,i)}))},return:function(e){var t=ig(this).iterator,r=!!arguments.length;return new tg((function(n,i){var a=Jh(t,"return");if(void 0===a)return n({done:!0,value:e});var o=Gh(Zh(a,t,r?[e]:[]));ag(o,n,i)}))},throw:function(e){var t=ig(this).iterator,r=!!arguments.length;return new tg((function(n,i){var a=Jh(t,"throw");if(void 0===a)return i(e);var o=Gh(Zh(a,t,r?[e]:[]));ag(o,n,i)}))}});var sg=og,ug=l,lg=sg,cg=Pt,dg=io,fg=he,pg=Ge("asyncIterator"),mg=function(e,t){var r=arguments.length<2?fg(e,pg):t;return r?cg(ug(r,e)):new lg(dg(e))},hg=r,gg=function(e){return hg[e].prototype},yg=l,bg=pe,vg=Pt,wg=bs,Og=B,Sg=he,Cg=function(e){var t=0==e,r=1==e,n=2==e,i=3==e;return function(e,a,o){vg(e);var s=Og("Promise"),u=bg(e.next),l=0,c=void 0!==a;return!c&&t||bg(a),new s((function(d,f){var p=function(t,r){try{var n=Sg(e,"return");if(n)return s.resolve(yg(n,e)).then((function(){t(r)}),(function(e){f(e)}))}catch(e){return f(e)}t(r)},m=function(e){p(f,e)},h=function(){try{t&&c&&wg(l),s.resolve(vg(yg(u,e))).then((function(e){try{if(vg(e).done)t?(o.length=l,d(o)):d(!i&&(n||void 0));else{var u=e.value;c?s.resolve(t?a(u,l):a(u)).then((function(e){r?h():n?e?h():p(d,!1):t?(o[l++]=e,h()):e?p(d,i||u):h()}),m):(o[l++]=u,h())}}catch(e){m(e)}}),m)}catch(e){m(e)}};h()}))}},Eg={toArray:Cg(0),forEach:Cg(1),every:Cg(2),some:Cg(3),find:Cg(4)},Ag=Ua,Rg=Te,Pg=Hf,Ig=mg,Ng=io,Tg=Ja,xg=he,kg=gg,Mg=B,$g=sg,Dg=Eg.toArray,Lg=Ge("asyncIterator"),jg=kg("Array").values,_g=function(e){var t=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(Mg("Promise"))((function(r){var a=Rg(e);void 0!==n&&(n=Ag(n,i));var o=xg(a,Lg),s=o?void 0:Tg(a)||jg,u=Pg(t)?new t:[],l=o?Ig(a,o):new $g(Ng(a,s));r(Dg(l,n,u))}))};Gn({target:"Array",stat:!0,forced:!0},{fromAsync:_g});var qg=Pp.filterReject,Vg=es;Gn({target:"Array",proto:!0,forced:!0},{filterOut:function(e){return qg(this,e,arguments.length>1?arguments[1]:void 0)}}),Vg("filterOut");var Ug=Pp.filterReject,Fg=es;Gn({target:"Array",proto:!0,forced:!0},{filterReject:function(e){return Ug(this,e,arguments.length>1?arguments[1]:void 0)}}),Fg("filterReject");var Bg=on,zg=function(e,t){for(var r=0,n=Bg(t),i=new e(n);n>r;)i[r]=t[r++];return i},Kg=Ua,Wg=x,Xg=Te,Zg=ot,Gg=on,Hg=ja,Jg=zg,Yg=Array,Qg=S([].push),ey=function(e,t,r,n){for(var i,a,o,s=Xg(e),u=Wg(s),l=Kg(t,r),c=Hg(null),d=Gg(u),f=0;d>f;f++)o=u[f],(a=Zg(l(o,f,s)))in c?Qg(c[a],o):c[a]=[o];if(n&&(i=n(s))!==Yg)for(a in c)c[a]=Jg(i,c[a]);return c},ty=ey,ry=es;Gn({target:"Array",proto:!0},{group:function(e){var t=arguments.length>1?arguments[1]:void 0;return ty(this,e,t)}}),ry("group");var ny=i,iy=function(e,t){var r=[][e];return!!r&&ny((function(){r.call(null,t||function(){return 1},1)}))},ay=ey,oy=es;Gn({target:"Array",proto:!0,forced:!iy("groupBy")},{groupBy:function(e){var t=arguments.length>1?arguments[1]:void 0;return ay(this,e,t)}}),oy("groupBy");var sy=Ua,uy=S,ly=x,cy=Te,dy=on,fy=B("Map"),py=fy.prototype,my=uy(py.get),hy=uy(py.has),gy=uy(py.set),yy=uy([].push),by=function(e){for(var t,r,n=cy(this),i=ly(n),a=sy(e,arguments.length>1?arguments[1]:void 0),o=new fy,s=dy(i),u=0;s>u;u++)t=a(r=i[u],u,n),hy(o,t)?yy(my(o,t),r):gy(o,t,[r]);return o},vy=es,wy=by;Gn({target:"Array",proto:!0,name:"groupToMap",forced:!iy("groupByToMap")},{groupByToMap:wy}),vy("groupByToMap");var Oy=es;Gn({target:"Array",proto:!0},{groupToMap:by}),Oy("groupToMap");var Sy=Gn,Cy=fp,Ey=Object.isFrozen,Ay=function(e,t){if(!Ey||!Cy(e)||!Ey(e))return!1;for(var r,n=0,i=e.length;n<i;)if(!("string"==typeof(r=e[n++])||t&&void 0===r))return!1;return 0!==i};Sy({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(e){if(!Ay(e,!0))return!1;var t=e.raw;return t.length===e.length&&Ay(t,!1)}});var Ry=es,Py=Te,Iy=on;a&&(Qs(Array.prototype,"lastIndex",{configurable:!0,get:function(){var e=Py(this),t=Iy(e);return 0==t?0:t-1}}),Ry("lastIndex"));var Ny=es,Ty=Te,xy=on;a&&(Qs(Array.prototype,"lastItem",{configurable:!0,get:function(){var e=Ty(this),t=xy(e);return 0==t?void 0:e[t-1]},set:function(e){var t=Ty(this),r=xy(t);return t[0==r?0:r-1]=e}}),Ny("lastItem"));var ky=on,My=function(e,t){for(var r=ky(e),n=new t(r),i=0;i<r;i++)n[i]=e[r-i-1];return n},$y=My,Dy=L,Ly=es,jy=Array;Gn({target:"Array",proto:!0},{toReversed:function(){return $y(Dy(this),jy)}}),Ly("toReversed");var _y=Gn,qy=pe,Vy=L,Uy=zg,Fy=es,By=Array,zy=S(gg("Array").sort);_y({target:"Array",proto:!0},{toSorted:function(e){void 0!==e&&qy(e);var t=Vy(this),r=Uy(By,t);return zy(r,e)}}),Fy("toSorted");var Ky=Gn,Wy=es,Xy=bs,Zy=on,Gy=en,Hy=L,Jy=Hr,Yy=Array,Qy=Math.max,eb=Math.min;Ky({target:"Array",proto:!0},{toSpliced:function(e,t){var r,n,i,a,o=Hy(this),s=Zy(o),u=Gy(e,s),l=arguments.length,c=0;for(0===l?r=n=0:1===l?(r=0,n=s-u):(r=l-2,n=eb(Qy(Jy(t),0),s-u)),i=Xy(s+r-n),a=Yy(i);c<u;c++)a[c]=o[c];for(;c<u+r;c++)a[c]=arguments[c-u+2];for(;c<i;c++)a[c]=o[c+n-r];return a}}),Wy("toSpliced");var tb=S,rb=pe,nb=on,ib=Te,ab=vp,ob=B("Map"),sb=ob.prototype,ub=tb(sb.forEach),lb=tb(sb.has),cb=tb(sb.set),db=tb([].push),fb=function(e){var t,r,n,i=ib(this),a=nb(i),o=ab(i,0),s=new ob,u=null!=e?rb(e):function(e){return e};for(t=0;t<a;t++)n=u(r=i[t]),lb(s,n)||cb(s,n,r);return ub(s,(function(e){db(o,e)})),o},pb=es;Gn({target:"Array",proto:!0,forced:!0},{uniqueBy:fb}),pb("uniqueBy");var mb=on,hb=Hr,gb=RangeError,yb=function(e,t,r,n){var i=mb(e),a=hb(r),o=a<0?i+a:a;if(o>=i||o<0)throw gb("Incorrect index");for(var s=new t(i),u=0;u<i;u++)s[u]=u===o?n:e[u];return s},bb=yb,vb=L,wb=Array;Gn({target:"Array",proto:!0},{with:function(e,t){return bb(vb(this),wb,e,t)}});var Ob=Gn,Sb=ed,Cb=Ut,Eb=Me,Ab=Xh,Rb=Ge("toStringTag"),Pb=function(){Sb(this,Ab)};Pb.prototype=Ab,Eb(Ab,Rb)||Cb(Ab,Rb,"AsyncIterator"),Eb(Ab,"constructor")&&Ab.constructor!==Object||Cb(Ab,"constructor",Pb),Ob({global:!0,constructor:!0,forced:false},{AsyncIterator:Pb});var Ib=l,Nb=pe,Tb=Pt,xb=ja,kb=Ut,Mb=Jc,$b=Ge,Db=Ir,Lb=he,jb=Xh,_b=B("Promise"),qb="AsyncIteratorProxy",Vb=Db.set,Ub=Db.getterFor(qb),Fb=$b("toStringTag"),Bb=function(e,t){var r=function(e){e.type=qb,e.next=Nb(e.iterator.next),e.done=!1,e.ignoreArgument=!t,Vb(this,e)};return r.prototype=Mb(xb(jb),{next:function(r){var n=this,i=!!arguments.length;return new _b((function(a){var o=Ub(n),s=i?[o.ignoreArgument?void 0:r]:t?[]:[void 0];o.ignoreArgument=!1,a(o.done?{done:!0,value:void 0}:Tb(Ib(e,o,_b,s)))}))},return:function(e){var t=this;return new _b((function(r,n){var i=Ub(t),a=i.iterator;i.done=!0;var o=Lb(a,"return");if(void 0===o)return r({done:!0,value:e});_b.resolve(Ib(o,a,e)).then((function(t){Tb(t),r({done:!0,value:e})}),n)}))},throw:function(e){var t=this;return new _b((function(r,n){var i=Ub(t),a=i.iterator;i.done=!0;var o=Lb(a,"throw");if(void 0===o)return n(e);r(Ib(o,a,e))}))}}),t||kb(r.prototype,Fb,"Generator"),r},zb=Gn,Kb=ei,Wb=Pt,Xb=Bb((function(e,t){var r=this,n=r.iterator;return e.resolve(Wb(Kb(r.next,n,t))).then((function(e){return Wb(e).done?(r.done=!0,{done:!0,value:void 0}):{done:!1,value:[r.index++,e.value]}}))}));zb({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{asIndexedPairs:function(){return new Xb({iterator:Wb(this),index:0})}});var Zb=Gn,Gb=ei,Hb=Pt,Jb=Mf,Yb=Bb((function(e,t){var r=this;return new e((function(n,i){var a=function(){try{e.resolve(Hb(Gb(r.next,r.iterator,r.remaining?[]:t))).then((function(e){try{Hb(e).done?(r.done=!0,n({done:!0,value:void 0})):r.remaining?(r.remaining--,a()):n({done:!1,value:e.value})}catch(e){i(e)}}),i)}catch(e){i(e)}};a()}))}));Zb({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{drop:function(e){return new Yb({iterator:Hb(this),remaining:Jb(e)})}});var Qb=Eg.every;Gn({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{every:function(e){return Qb(this,e)}});var ev=Gn,tv=ei,rv=pe,nv=Pt,iv=Bb((function(e,t){var r=this,n=r.filterer;return new e((function(i,a){var o=function(){try{e.resolve(nv(tv(r.next,r.iterator,t))).then((function(t){try{if(nv(t).done)r.done=!0,i({done:!0,value:void 0});else{var s=t.value;e.resolve(n(s)).then((function(e){e?i({done:!1,value:s}):o()}),a)}}catch(e){a(e)}}),a)}catch(e){a(e)}};o()}))}));ev({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{filter:function(e){return new iv({iterator:nv(this),filterer:rv(e)})}});var av=Eg.find;Gn({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{find:function(e){return av(this,e)}});var ov=Gn,sv=l,uv=pe,lv=Pt,cv=mg,dv=Bb((function(e){var t,r=this,n=r.mapper;return new e((function(i,a){var o=function(){try{e.resolve(lv(sv(r.next,r.iterator))).then((function(o){try{lv(o).done?(r.done=!0,i({done:!0,value:void 0})):e.resolve(n(o.value)).then((function(e){try{return r.innerIterator=t=cv(e),r.innerNext=uv(t.next),s()}catch(e){a(e)}}),a)}catch(e){a(e)}}),a)}catch(e){a(e)}},s=function(){if(t=r.innerIterator)try{e.resolve(lv(sv(r.innerNext,t))).then((function(e){try{lv(e).done?(r.innerIterator=r.innerNext=null,o()):i({done:!1,value:e.value})}catch(e){a(e)}}),a)}catch(e){a(e)}else o()};s()}))}));ov({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{flatMap:function(e){return new dv({iterator:lv(this),mapper:uv(e),innerIterator:null,innerNext:null})}});var fv=Eg.forEach;Gn({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{forEach:function(e){return fv(this,e)}});var pv=Gn,mv=ei,hv=Pt,gv=Te,yv=z,bv=Xh,vv=Bb,wv=mg,Ov=io,Sv=Ja,Cv=he,Ev=sg,Av=Ge("asyncIterator"),Rv=vv((function(e,t){return hv(mv(this.next,this.iterator,t))}),!0);pv({target:"AsyncIterator",stat:!0,forced:!0},{from:function(e){var t,r=gv(e),n=Cv(r,Av);return n&&(t=wv(r,n),yv(bv,t))?t:void 0===t&&(n=Sv(r))?new Ev(Ov(r,n)):new Rv({iterator:void 0!==t?t:r})}});var Pv=Gn,Iv=ei,Nv=pe,Tv=Pt,xv=Bb((function(e,t){var r=this,n=r.mapper;return e.resolve(Tv(Iv(r.next,r.iterator,t))).then((function(t){return Tv(t).done?(r.done=!0,{done:!0,value:void 0}):e.resolve(n(t.value)).then((function(e){return{done:!1,value:e}}))}))}));Pv({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{map:function(e){return new xv({iterator:Tv(this),mapper:Nv(e)})}});var kv=Gn,Mv=l,$v=pe,Dv=Pt,Lv=B("Promise"),jv=TypeError;kv({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=Dv(this),r=$v(t.next),n=arguments.length<2,i=n?void 0:arguments[1];return $v(e),new Lv((function(a,o){var s=function(){try{Lv.resolve(Dv(Mv(r,t))).then((function(t){try{if(Dv(t).done)n?o(jv("Reduce of empty iterator with no initial value")):a(i);else{var r=t.value;n?(n=!1,i=r,s()):Lv.resolve(e(i,r)).then((function(e){i=e,s()}),o)}}catch(e){o(e)}}),o)}catch(e){o(e)}};s()}))}});var _v=Eg.some;Gn({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{some:function(e){return _v(this,e)}});var qv=Gn,Vv=ei,Uv=l,Fv=Pt,Bv=Mf,zv=Bb((function(e,t){var r,n,i=this.iterator;return this.remaining--?Vv(this.next,i,t):(n={done:!0,value:void 0},this.done=!0,void 0!==(r=i.return)?e.resolve(Uv(r,i)).then((function(){return n})):n)}));qv({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{take:function(e){return new zv({iterator:Fv(this),remaining:Bv(e)})}});var Kv=Eg.toArray;Gn({target:"AsyncIterator",proto:!0,real:!0,forced:!0},{toArray:function(){return Kv(this,void 0,[])}});var Wv,Xv,Zv,Gv=i,Hv=j,Jv=pa,Yv=Kr,Qv=Ge("iterator"),ew=!1;[].keys&&("next"in(Zv=[].keys())?(Xv=Jv(Jv(Zv)))!==Object.prototype&&(Wv=Xv):ew=!0);var tw=null==Wv||Gv((function(){var e={};return Wv[Qv].call(e)!==e}));tw&&(Wv={}),Hv(Wv[Qv])||Yv(Wv,Qv,(function(){return this}));var rw={IteratorPrototype:Wv,BUGGY_SAFARI_ITERATORS:ew},nw=rw.IteratorPrototype,iw=ja,aw=g,ow=Zs,sw=Fa,uw=function(){return this},lw=function(e,t,r,n){var i=t+" Iterator";return e.prototype=iw(nw,{next:aw(+!n,r)}),ow(e,i,!1),sw[i]=uw,e},cw=Ir,dw=lw,fw=q,pw=ma.f,mw=a,hw="Incorrect Number.range arguments",gw="NumericRangeIterator",yw=cw.set,bw=cw.getterFor(gw),vw=RangeError,ww=TypeError,Ow=dw((function(e,t,r,n,i,a){if(typeof e!=n||t!==1/0&&t!==-1/0&&typeof t!=n)throw new ww(hw);if(e===1/0||e===-1/0)throw new vw(hw);var o,s=t>e,u=!1;if(void 0===r)o=void 0;else if(fw(r))o=r.step,u=!!r.inclusive;else{if(typeof r!=n)throw new ww(hw);o=r}if(null==o&&(o=s?a:-a),typeof o!=n)throw new ww(hw);if(o===1/0||o===-1/0||o===i&&e!==t)throw new vw(hw);yw(this,{type:gw,start:e,end:t,step:o,inclusiveEnd:u,hitsEnd:e!=e||t!=t||o!=o||t>e!=o>i,currentCount:i,zero:i}),mw||(this.start=e,this.end=t,this.step=o,this.inclusive=u)}),gw,(function(){var e=bw(this);if(e.hitsEnd)return{value:void 0,done:!0};var t=e.start,r=e.end,n=t+e.step*e.currentCount++;n===r&&(e.hitsEnd=!0);var i=e.inclusiveEnd;return(r>t?i?n>r:n>=r:i?r>n:r>=n)?{value:void 0,done:e.hitsEnd=!0}:{value:n,done:!1}})),Sw=function(e){return{get:e,set:function(){},configurable:!0,enumerable:!1}};mw&&pw(Ow.prototype,{start:Sw((function(){return bw(this).start})),end:Sw((function(){return bw(this).end})),inclusive:Sw((function(){return bw(this).inclusiveEnd})),step:Sw((function(){return bw(this).step}))});var Cw=Ow,Ew=Cw;"function"==typeof BigInt&&Gn({target:"BigInt",stat:!0,forced:!0},{range:function(e,t,r){return new Ew(e,t,r,"bigint",BigInt(0),BigInt(1))}});var Aw={exports:{}},Rw={},Pw=R,Iw=L,Nw=Wr.f,Tw=Ad,xw="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];Rw.f=function(e){return xw&&"Window"==Pw(e)?function(e){try{return Nw(e)}catch(e){return Tw(xw)}}(e):Nw(Iw(e))};var kw=i((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}})),Mw=i,$w=q,Dw=R,Lw=kw,jw=Object.isExtensible,_w=Mw((function(){jw(1)}))||Lw?function(e){return!!$w(e)&&((!Lw||"ArrayBuffer"!=Dw(e))&&(!jw||jw(e)))}:jw,qw=!i((function(){return Object.isExtensible(Object.preventExtensions({}))})),Vw=Gn,Uw=S,Fw=cr,Bw=q,zw=Me,Kw=St.f,Ww=Wr,Xw=Rw,Zw=_w,Gw=qw,Hw=!1,Jw=_e("meta"),Yw=0,Qw=function(e){Kw(e,Jw,{value:{objectID:"O"+Yw++,weakData:{}}})},eO=Aw.exports={enable:function(){eO.enable=function(){},Hw=!0;var e=Ww.f,t=Uw([].splice),r={};r[Jw]=1,e(r).length&&(Ww.f=function(r){for(var n=e(r),i=0,a=n.length;i<a;i++)if(n[i]===Jw){t(n,i,1);break}return n},Vw({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Xw.f}))},fastKey:function(e,t){if(!Bw(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!zw(e,Jw)){if(!Zw(e))return"F";if(!t)return"E";Qw(e)}return e[Jw].objectID},getWeakData:function(e,t){if(!zw(e,Jw)){if(!Zw(e))return!0;if(!t)return!1;Qw(e)}return e[Jw].weakData},onFreeze:function(e){return Gw&&Hw&&Zw(e)&&!zw(e,Jw)&&Qw(e),e}};Fw[Jw]=!0;var tO=Gn,rO=r,nO=S,iO=Un,aO=Kr,oO=Aw.exports,sO=Co,uO=ed,lO=j,cO=q,dO=i,fO=ac,pO=Zs,mO=fi,hO=function(e,t,r){var n=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),a=n?"set":"add",o=rO[e],s=o&&o.prototype,u=o,l={},c=function(e){var t=nO(s[e]);aO(s,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(i&&!cO(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return i&&!cO(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(i&&!cO(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})};if(iO(e,!lO(o)||!(i||s.forEach&&!dO((function(){(new o).entries().next()})))))u=r.getConstructor(t,e,n,a),oO.enable();else if(iO(e,!0)){var d=new u,f=d[a](i?{}:-0,1)!=d,p=dO((function(){d.has(1)})),m=fO((function(e){new o(e)})),h=!i&&dO((function(){for(var e=new o,t=5;t--;)e[a](t,t);return!e.has(-0)}));m||((u=t((function(e,t){uO(e,s);var r=mO(new o,e,u);return null!=t&&sO(t,r[a],{that:r,AS_ENTRIES:n}),r}))).prototype=s,s.constructor=u),(p||h)&&(c("delete"),c("has"),n&&c("get")),(h||f)&&c(a),i&&s.clear&&delete s.clear}return l[e]=u,tO({global:!0,constructor:!0,forced:u!=o},l),pO(u,e),i||r.setStrong(u,e,n),u},gO=Gn,yO=l,bO=j,vO=lw,wO=pa,OO=si,SO=Zs,CO=Ut,EO=Kr,AO=Fa,RO=Zt.PROPER,PO=Zt.CONFIGURABLE,IO=rw.IteratorPrototype,NO=rw.BUGGY_SAFARI_ITERATORS,TO=Ge("iterator"),xO="keys",kO="values",MO="entries",$O=function(){return this},DO=function(e,t,r,n,i,a,o){vO(r,t,n);var s,u,l,c=function(e){if(e===i&&h)return h;if(!NO&&e in p)return p[e];switch(e){case xO:case kO:case MO:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,p=e.prototype,m=p[TO]||p["@@iterator"]||i&&p[i],h=!NO&&m||c(i),g="Array"==t&&p.entries||m;if(g&&(s=wO(g.call(new e)))!==Object.prototype&&s.next&&(wO(s)!==IO&&(OO?OO(s,IO):bO(s[TO])||EO(s,TO,$O)),SO(s,d,!0)),RO&&i==kO&&m&&m.name!==kO&&(PO?CO(p,"name",kO):(f=!0,h=function(){return yO(m,this)})),i)if(u={values:c(kO),keys:a?h:c(xO),entries:c(MO)},o)for(l in u)(NO||f||!(l in p))&&EO(p,l,u[l]);else gO({target:t,proto:!0,forced:NO||f},u);return p[TO]!==h&&EO(p,TO,h,{name:i}),AO[t]=h,u},LO=St.f,jO=ja,_O=Jc,qO=Ua,VO=ed,UO=Co,FO=DO,BO=kp,zO=a,KO=Aw.exports.fastKey,WO=Ir.set,XO=Ir.getterFor,ZO={getConstructor:function(e,t,r,n){var i=e((function(e,i){VO(e,a),WO(e,{type:t,index:jO(null),first:void 0,last:void 0,size:0}),zO||(e.size=0),null!=i&&UO(i,e[n],{that:e,AS_ENTRIES:r})})),a=i.prototype,o=XO(t),s=function(e,t,r){var n,i,a=o(e),s=u(e,t);return s?s.value=r:(a.last=s={index:i=KO(t,!0),key:t,value:r,previous:n=a.last,next:void 0,removed:!1},a.first||(a.first=s),n&&(n.next=s),zO?a.size++:e.size++,"F"!==i&&(a.index[i]=s)),e},u=function(e,t){var r,n=o(e),i=KO(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return _O(a,{clear:function(){for(var e=o(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,zO?e.size=0:this.size=0},delete:function(e){var t=this,r=o(t),n=u(t,e);if(n){var i=n.next,a=n.previous;delete r.index[n.index],n.removed=!0,a&&(a.next=i),i&&(i.previous=a),r.first==n&&(r.first=i),r.last==n&&(r.last=a),zO?r.size--:t.size--}return!!n},forEach:function(e){for(var t,r=o(this),n=qO(e,arguments.length>1?arguments[1]:void 0);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!u(this,e)}}),_O(a,r?{get:function(e){var t=u(this,e);return t&&t.value},set:function(e,t){return s(this,0===e?0:e,t)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),zO&&LO(a,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=XO(t),a=XO(n);FO(e,t,(function(e,t){WO(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=a(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),BO(t)}};hO("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),ZO);var GO=S,HO=Jc,JO=Aw.exports.getWeakData,YO=Pt,QO=q,eS=ed,tS=Co,rS=Me,nS=Ir.set,iS=Ir.getterFor,aS=Pp.find,oS=Pp.findIndex,sS=GO([].splice),uS=0,lS=function(e){return e.frozen||(e.frozen=new cS)},cS=function(){this.entries=[]},dS=function(e,t){return aS(e.entries,(function(e){return e[0]===t}))};cS.prototype={get:function(e){var t=dS(this,e);if(t)return t[1]},has:function(e){return!!dS(this,e)},set:function(e,t){var r=dS(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=oS(this.entries,(function(t){return t[0]===e}));return~t&&sS(this.entries,t,1),!!~t}};var fS,pS={getConstructor:function(e,t,r,n){var i=e((function(e,i){eS(e,a),nS(e,{type:t,id:uS++,frozen:void 0}),null!=i&&tS(i,e[n],{that:e,AS_ENTRIES:r})})),a=i.prototype,o=iS(t),s=function(e,t,r){var n=o(e),i=JO(YO(t),!0);return!0===i?lS(n).set(t,r):i[n.id]=r,e};return HO(a,{delete:function(e){var t=o(this);if(!QO(e))return!1;var r=JO(e);return!0===r?lS(t).delete(e):r&&rS(r,t.id)&&delete r[t.id]},has:function(e){var t=o(this);if(!QO(e))return!1;var r=JO(e);return!0===r?lS(t).has(e):r&&rS(r,t.id)}}),HO(a,r?{get:function(e){var t=o(this);if(QO(e)){var r=JO(e);return!0===r?lS(t).get(e):r?r[t.id]:void 0}},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),i}},mS=r,hS=S,gS=Jc,yS=Aw.exports,bS=hO,vS=pS,wS=q,OS=_w,SS=Ir.enforce,CS=ar,ES=!mS.ActiveXObject&&"ActiveXObject"in mS,AS=function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},RS=bS("WeakMap",AS,vS);if(CS&&ES){fS=vS.getConstructor(AS,"WeakMap",!0),yS.enable();var PS=RS.prototype,IS=hS(PS.delete),NS=hS(PS.has),TS=hS(PS.get),xS=hS(PS.set);gS(PS,{delete:function(e){if(wS(e)&&!OS(e)){var t=SS(this);return t.frozen||(t.frozen=new fS),IS(this,e)||t.frozen.delete(e)}return IS(this,e)},has:function(e){if(wS(e)&&!OS(e)){var t=SS(this);return t.frozen||(t.frozen=new fS),NS(this,e)||t.frozen.has(e)}return NS(this,e)},get:function(e){if(wS(e)&&!OS(e)){var t=SS(this);return t.frozen||(t.frozen=new fS),NS(this,e)?TS(this,e):t.frozen.get(e)}return TS(this,e)},set:function(e,t){if(wS(e)&&!OS(e)){var r=SS(this);r.frozen||(r.frozen=new fS),NS(this,e)?xS(this,e,t):r.frozen.set(e,t)}else xS(this,e,t);return this}})}var kS=B,MS=ja,$S=q,DS=Object,LS=TypeError,jS=kS("Map"),_S=kS("WeakMap"),qS=function(){this.object=null,this.symbol=null,this.primitives=null,this.objectsByIndex=MS(null)};qS.prototype.get=function(e,t){return this[e]||(this[e]=t())},qS.prototype.next=function(e,t,r){var n=r?this.objectsByIndex[e]||(this.objectsByIndex[e]=new _S):this.primitives||(this.primitives=new jS),i=n.get(t);return i||n.set(t,i=new qS),i};var VS=new qS,US=function(){var e,t,r=VS,n=arguments.length;for(e=0;e<n;e++)$S(t=arguments[e])&&(r=r.next(e,t,!0));if(this===DS&&r===VS)throw LS("Composite keys must contain a non-primitive component");for(e=0;e<n;e++)$S(t=arguments[e])||(r=r.next(e,t,!1));return r},FS=ei,BS=US,zS=B,KS=ja,WS=Object,XS=function(){var e=zS("Object","freeze");return e?e(KS(null)):KS(null)};Gn({global:!0,forced:!0},{compositeKey:function(){return FS(BS,WS,arguments).get("object",XS)}});var ZS=US,GS=B,HS=ei;Gn({global:!0,forced:!0},{compositeSymbol:function(){return 1==arguments.length&&"string"==typeof arguments[0]?GS("Symbol").for(arguments[0]):HS(ZS,null,arguments).get("symbol",GS("Symbol"))}});var JS=Gn,YS=S,QS=j,eC=tr,tC=Me,rC=a,nC=Object.getOwnPropertyDescriptor,iC=/^\s*class\b/,aC=YS(iC.exec);JS({target:"Function",stat:!0,sham:!0,forced:!0},{isCallable:function(e){return QS(e)&&!function(e){try{if(!rC||!aC(iC,eC(e)))return!1}catch(e){}var t=nC(e,"prototype");return!!t&&tC(t,"writable")&&!t.writable}(e)}}),Gn({target:"Function",stat:!0,forced:!0},{isConstructor:Hf});var oC=S,sC=pe;Gn({target:"Function",proto:!0,forced:!0},{unThis:function(){return oC(sC(this))}});var uC=Gn,lC=r,cC=ed,dC=j,fC=Ut,pC=i,mC=Me,hC=rw.IteratorPrototype,gC=Ge("toStringTag"),yC=lC.Iterator,bC=!dC(yC)||yC.prototype!==hC||!pC((function(){yC({})})),vC=function(){cC(this,hC)};mC(hC,gC)||fC(hC,gC,"Iterator"),!bC&&mC(hC,"constructor")&&hC.constructor!==Object||fC(hC,"constructor",vC),vC.prototype=hC,uC({global:!0,constructor:!0,forced:bC},{Iterator:vC});var wC=l,OC=pe,SC=Pt,CC=ja,EC=Ut,AC=Jc,RC=Ge,PC=Ir,IC=he,NC=rw.IteratorPrototype,TC="IteratorProxy",xC=PC.set,kC=PC.getterFor(TC),MC=RC("toStringTag"),$C=function(e,t){var r=function(e){e.type=TC,e.next=OC(e.iterator.next),e.done=!1,e.ignoreArg=!t,xC(this,e)};return r.prototype=AC(CC(NC),{next:function(r){var n=kC(this),i=arguments.length?[n.ignoreArg?void 0:r]:t?[]:[void 0];n.ignoreArg=!1;var a=n.done?void 0:wC(e,n,i);return{done:n.done,value:a}},return:function(e){var t=kC(this),r=t.iterator;t.done=!0;var n=IC(r,"return");return{done:!0,value:n?SC(wC(n,r,e)).value:e}},throw:function(e){var t=kC(this),r=t.iterator;t.done=!0;var n=IC(r,"throw");if(n)return wC(n,r,e);throw e}}),t||EC(r.prototype,MC,"Generator"),r},DC=Gn,LC=ei,jC=Pt,_C=$C((function(e){var t=jC(LC(this.next,this.iterator,e));if(!(this.done=!!t.done))return[this.index++,t.value]}));DC({target:"Iterator",proto:!0,real:!0,forced:!0},{asIndexedPairs:function(){return new _C({iterator:jC(this),index:0})}});var qC=Gn,VC=ei,UC=l,FC=Pt,BC=Mf,zC=$C((function(e){for(var t,r=this.iterator,n=this.next;this.remaining;)if(this.remaining--,t=FC(UC(n,r)),this.done=!!t.done)return;if(t=FC(VC(n,r,e)),!(this.done=!!t.done))return t.value}));qC({target:"Iterator",proto:!0,real:!0,forced:!0},{drop:function(e){return new zC({iterator:FC(this),remaining:BC(e)})}});var KC=Co,WC=pe,XC=Pt;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{every:function(e){return XC(this),WC(e),!KC(this,(function(t,r){if(!e(t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var ZC=Pt,GC=uo,HC=function(e,t,r,n){try{return n?t(ZC(r)[0],r[1]):t(r)}catch(t){GC(e,"throw",t)}},JC=Gn,YC=ei,QC=pe,eE=Pt,tE=HC,rE=$C((function(e){for(var t,r,n=this.iterator,i=this.filterer,a=this.next;;){if(t=eE(YC(a,n,e)),this.done=!!t.done)return;if(r=t.value,tE(n,i,r))return r}}));JC({target:"Iterator",proto:!0,real:!0,forced:!0},{filter:function(e){return new rE({iterator:eE(this),filterer:QC(e)})}});var nE=Co,iE=pe,aE=Pt;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{find:function(e){return aE(this),iE(e),nE(this,(function(t,r){if(e(t))return r(t)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var oE=Gn,sE=l,uE=pe,lE=Pt,cE=Ja,dE=uo,fE=TypeError,pE=$C((function(){for(var e,t,r,n,i=this.iterator,a=this.mapper;;)try{if(n=this.innerIterator){if(!(e=lE(sE(this.innerNext,n))).done)return e.value;this.innerIterator=this.innerNext=null}if(e=lE(sE(this.next,i)),this.done=!!e.done)return;if(t=a(e.value),!(r=cE(t)))throw fE(".flatMap callback should return an iterable object");this.innerIterator=n=lE(sE(r,t)),this.innerNext=uE(n.next)}catch(e){dE(i,"throw",e)}}));oE({target:"Iterator",proto:!0,real:!0,forced:!0},{flatMap:function(e){return new pE({iterator:lE(this),mapper:uE(e),innerIterator:null,innerNext:null})}});var mE=Co,hE=Pt;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{forEach:function(e){mE(hE(this),e,{IS_ITERATOR:!0})}});var gE=Gn,yE=ei,bE=Pt,vE=Te,wE=z,OE=rw.IteratorPrototype,SE=io,CE=Ja,EE=$C((function(e){var t=bE(yE(this.next,this.iterator,e));if(!(this.done=!!t.done))return t.value}),!0);gE({target:"Iterator",stat:!0,forced:!0},{from:function(e){var t,r=vE(e),n=CE(r);if(n){if(t=SE(r,n),wE(OE,t))return t}else t=r;return new EE({iterator:t})}});var AE=Gn,RE=ei,PE=pe,IE=Pt,NE=HC,TE=$C((function(e){var t=this.iterator,r=IE(RE(this.next,t,e));if(!(this.done=!!r.done))return NE(t,this.mapper,r.value)}));AE({target:"Iterator",proto:!0,real:!0,forced:!0},{map:function(e){return new TE({iterator:IE(this),mapper:PE(e)})}});var xE=Co,kE=pe,ME=Pt,$E=TypeError;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{reduce:function(e){ME(this),kE(e);var t=arguments.length<2,r=t?void 0:arguments[1];if(xE(this,(function(n){t?(t=!1,r=n):r=e(r,n)}),{IS_ITERATOR:!0}),t)throw $E("Reduce of empty iterator with no initial value");return r}});var DE=Co,LE=pe,jE=Pt;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{some:function(e){return jE(this),LE(e),DE(this,(function(t,r){if(e(t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var _E=Gn,qE=ei,VE=Pt,UE=Mf,FE=uo,BE=$C((function(e){var t=this.iterator;if(!this.remaining--)return this.done=!0,FE(t,"normal",void 0);var r=VE(qE(this.next,t,e));return(this.done=!!r.done)?void 0:r.value}));_E({target:"Iterator",proto:!0,real:!0,forced:!0},{take:function(e){return new BE({iterator:VE(this),remaining:UE(e)})}});var zE=Co,KE=Pt,WE=[].push;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{toArray:function(){var e=[];return zE(KE(this),WE,{that:e,IS_ITERATOR:!0}),e}});var XE=sg;Gn({target:"Iterator",proto:!0,real:!0,forced:!0},{toAsync:function(){return new XE(this)}});var ZE=l,GE=pe,HE=Pt,JE=function(){for(var e,t=HE(this),r=GE(t.delete),n=!0,i=0,a=arguments.length;i<a;i++)e=ZE(r,t,arguments[i]),n=n&&e;return!!n};Gn({target:"Map",proto:!0,real:!0,forced:!0},{deleteAll:JE});var YE=l,QE=pe,eA=Pt,tA=function(e,t){var r=eA(this),n=QE(r.get),i=QE(r.has),a=QE(r.set),o=YE(i,r,e)&&"update"in t?t.update(YE(n,r,e),e,r):t.insert(e,r);return YE(a,r,e,o),o};Gn({target:"Map",proto:!0,real:!0,forced:!0},{emplace:tA});var rA=l,nA=function(e){return rA(Map.prototype.entries,e)},iA=Pt,aA=Ua,oA=nA,sA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{every:function(e){var t=iA(this),r=oA(t),n=aA(e,arguments.length>1?arguments[1]:void 0);return!sA(r,(function(e,r,i){if(!n(r,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var uA=Pt,lA=ep,cA=Ge("species"),dA=function(e,t){var r,n=uA(e).constructor;return void 0===n||null==(r=uA(n)[cA])?t:lA(r)},fA=B,pA=Ua,mA=l,hA=pe,gA=Pt,yA=dA,bA=nA,vA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{filter:function(e){var t=gA(this),r=bA(t),n=pA(e,arguments.length>1?arguments[1]:void 0),i=new(yA(t,fA("Map"))),a=hA(i.set);return vA(r,(function(e,r){n(r,e,t)&&mA(a,i,e,r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var wA=Pt,OA=Ua,SA=nA,CA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{find:function(e){var t=wA(this),r=SA(t),n=OA(e,arguments.length>1?arguments[1]:void 0);return CA(r,(function(e,r,i){if(n(r,e,t))return i(r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var EA=Pt,AA=Ua,RA=nA,PA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{findKey:function(e){var t=EA(this),r=RA(t),n=AA(e,arguments.length>1?arguments[1]:void 0);return PA(r,(function(e,r,i){if(n(r,e,t))return i(e)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var IA=Ua,NA=l,TA=pe,xA=ep,kA=Co,MA=[].push,$A=function(e){var t,r,n,i,a=arguments.length,o=a>1?arguments[1]:void 0;return xA(this),(t=void 0!==o)&&TA(o),null==e?new this:(r=[],t?(n=0,i=IA(o,a>2?arguments[2]:void 0),kA(e,(function(e){NA(MA,r,i(e,n++))}))):kA(e,MA,{that:r}),new this(r))};Gn({target:"Map",stat:!0,forced:!0},{from:$A});var DA=Gn,LA=l,jA=pe,_A=io,qA=Co,VA=S([].push);DA({target:"Map",stat:!0,forced:!0},{groupBy:function(e,t){jA(t);var r=_A(e),n=new this,i=jA(n.has),a=jA(n.get),o=jA(n.set);return qA(r,(function(e){var r=t(e);LA(i,n,r)?VA(LA(a,n,r),e):LA(o,n,r,[e])}),{IS_ITERATOR:!0}),n}});var UA=Pt,FA=nA,BA=function(e,t){return e===t||e!=e&&t!=t},zA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{includes:function(e){return zA(FA(UA(this)),(function(t,r,n){if(BA(r,e))return n()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var KA=l,WA=Co,XA=pe;Gn({target:"Map",stat:!0,forced:!0},{keyBy:function(e,t){var r=new this;XA(t);var n=XA(r.set);return WA(e,(function(e){KA(n,r,t(e),e)})),r}});var ZA=Pt,GA=nA,HA=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{keyOf:function(e){return HA(GA(ZA(this)),(function(t,r,n){if(r===e)return n(t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).result}});var JA=B,YA=Ua,QA=l,eR=pe,tR=Pt,rR=dA,nR=nA,iR=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{mapKeys:function(e){var t=tR(this),r=nR(t),n=YA(e,arguments.length>1?arguments[1]:void 0),i=new(rR(t,JA("Map"))),a=eR(i.set);return iR(r,(function(e,r){QA(a,i,n(r,e,t),r)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var aR=B,oR=Ua,sR=l,uR=pe,lR=Pt,cR=dA,dR=nA,fR=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{mapValues:function(e){var t=lR(this),r=dR(t),n=oR(e,arguments.length>1?arguments[1]:void 0),i=new(cR(t,aR("Map"))),a=uR(i.set);return fR(r,(function(e,r){sR(a,i,e,n(r,e,t))}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),i}});var pR=pe,mR=Pt,hR=Co;Gn({target:"Map",proto:!0,real:!0,arity:1,forced:!0},{merge:function(e){for(var t=mR(this),r=pR(t.set),n=arguments.length,i=0;i<n;)hR(arguments[i++],r,{that:t,AS_ENTRIES:!0});return t}});var gR=S([].slice),yR=gR,bR=function(){return new this(yR(arguments))};Gn({target:"Map",stat:!0,forced:!0},{of:bR});var vR=Pt,wR=pe,OR=nA,SR=Co,CR=TypeError;Gn({target:"Map",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=vR(this),r=OR(t),n=arguments.length<2,i=n?void 0:arguments[1];if(wR(e),SR(r,(function(r,a){n?(n=!1,i=a):i=e(i,a,r,t)}),{AS_ENTRIES:!0,IS_ITERATOR:!0}),n)throw CR("Reduce of empty map with no initial value");return i}});var ER=Pt,AR=Ua,RR=nA,PR=Co;Gn({target:"Map",proto:!0,real:!0,forced:!0},{some:function(e){var t=ER(this),r=RR(t),n=AR(e,arguments.length>1?arguments[1]:void 0);return PR(r,(function(e,r,i){if(n(r,e,t))return i()}),{AS_ENTRIES:!0,IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var IR=l,NR=Pt,TR=pe,xR=TypeError;Gn({target:"Map",proto:!0,real:!0,forced:!0},{update:function(e,t){var r=NR(this),n=TR(r.get),i=TR(r.has),a=TR(r.set),o=arguments.length;TR(t);var s=IR(i,r,e);if(!s&&o<3)throw xR("Updating absent value");var u=s?IR(n,r,e):TR(o>2?arguments[2]:void 0)(e,r);return IR(a,r,e,t(u,e,r)),r}});var kR=l,MR=pe,$R=j,DR=Pt,LR=TypeError,jR=function(e,t){var r,n=DR(this),i=MR(n.get),a=MR(n.has),o=MR(n.set),s=arguments.length>2?arguments[2]:void 0;if(!$R(t)&&!$R(s))throw LR("At least one callback required");return kR(a,n,e)?(r=kR(i,n,e),$R(t)&&(r=t(r),kR(o,n,e,r))):$R(s)&&(r=s(),kR(o,n,e,r)),r};Gn({target:"Map",proto:!0,real:!0,name:"upsert",forced:!0},{updateOrInsert:jR}),Gn({target:"Map",proto:!0,real:!0,forced:!0},{upsert:jR});var _R=Gn,qR=Math.min,VR=Math.max;_R({target:"Math",stat:!0,forced:!0},{clamp:function(e,t,r){return qR(r,VR(t,e))}}),Gn({target:"Math",stat:!0,nonConfigurable:!0,nonWritable:!0},{DEG_PER_RAD:Math.PI/180});var UR=Gn,FR=180/Math.PI;UR({target:"Math",stat:!0,forced:!0},{degrees:function(e){return e*FR}});var BR=Math.scale||function(e,t,r,n,i){var a=+e,o=+t,s=+r,u=+n,l=+i;return a!=a||o!=o||s!=s||u!=u||l!=l?NaN:a===1/0||a===-1/0?a:(a-o)*(l-u)/(s-o)+u},zR=Math.sign||function(e){var t=+e;return 0==t||t!=t?t:t<0?-1:1},KR=Math.abs,WR=Math.pow,XR=WR(2,-52),ZR=WR(2,-23),GR=WR(2,127)*(2-ZR),HR=WR(2,-126),JR=Math.fround||function(e){var t,r,n=+e,i=KR(n),a=zR(n);return i<HR?a*function(e){return e+1/XR-1/XR}(i/HR/ZR)*HR*ZR:(r=(t=(1+ZR/XR)*i)-(t-i))>GR||r!=r?a*(1/0):a*r},YR=BR,QR=JR;Gn({target:"Math",stat:!0,forced:!0},{fscale:function(e,t,r,n,i){return QR(YR(e,t,r,n,i))}}),Gn({target:"Math",stat:!0,forced:!0},{iaddh:function(e,t,r,n){var i=e>>>0,a=r>>>0;return(t>>>0)+(n>>>0)+((i&a|(i|a)&~(i+a>>>0))>>>31)|0}}),Gn({target:"Math",stat:!0,forced:!0},{imulh:function(e,t){var r=65535,n=+e,i=+t,a=n&r,o=i&r,s=n>>16,u=i>>16,l=(s*o>>>0)+(a*o>>>16);return s*u+(l>>16)+((a*u>>>0)+(l&r)>>16)}}),Gn({target:"Math",stat:!0,forced:!0},{isubh:function(e,t,r,n){var i=e>>>0,a=r>>>0;return(t>>>0)-(n>>>0)-((~i&a|~(i^a)&i-a>>>0)>>>31)|0}}),Gn({target:"Math",stat:!0,nonConfigurable:!0,nonWritable:!0},{RAD_PER_DEG:180/Math.PI});var eP=Gn,tP=Math.PI/180;eP({target:"Math",stat:!0,forced:!0},{radians:function(e){return e*tP}}),Gn({target:"Math",stat:!0,forced:!0},{scale:BR});var rP=r.isFinite,nP=Number.isFinite||function(e){return"number"==typeof e&&rP(e)},iP=Gn,aP=Pt,oP=nP,sP=lw,uP=Ir,lP="Seeded Random",cP="Seeded Random Generator",dP=uP.set,fP=uP.getterFor(cP),pP=TypeError,mP=sP((function(e){dP(this,{type:cP,seed:e%2147483647})}),lP,(function(){var e=fP(this);return{value:(1073741823&(e.seed=(1103515245*e.seed+12345)%2147483647))/1073741823,done:!1}}));iP({target:"Math",stat:!0,forced:!0},{seededPRNG:function(e){var t=aP(e).seed;if(!oP(t))throw pP('Math.seededPRNG() argument should have a "seed" field with a finite value.');return new mP(t)}}),Gn({target:"Math",stat:!0,forced:!0},{signbit:function(e){var t=+e;return t==t&&0==t?1/t==-1/0:t<0}}),Gn({target:"Math",stat:!0,forced:!0},{umulh:function(e,t){var r=65535,n=+e,i=+t,a=n&r,o=i&r,s=n>>>16,u=i>>>16,l=(s*o>>>0)+(a*o>>>16);return s*u+(l>>>16)+((a*u>>>0)+(l&r)>>>16)}});var hP="\t\n\v\f\r                　\u2028\u2029\ufeff",gP=M,yP=Ci,bP=S("".replace),vP="[\t\n\v\f\r                　\u2028\u2029\ufeff]",wP=RegExp("^"+vP+vP+"*"),OP=RegExp(vP+vP+"*$"),SP=function(e){return function(t){var r=yP(gP(t));return 1&e&&(r=bP(r,wP,"")),2&e&&(r=bP(r,OP,"")),r}},CP={start:SP(1),end:SP(2),trim:SP(3)},EP=r,AP=i,RP=S,PP=Ci,IP=CP.trim,NP=hP,TP=EP.parseInt,xP=EP.Symbol,kP=xP&&xP.iterator,MP=/^[+-]?0x/i,$P=RP(MP.exec),DP=8!==TP(NP+"08")||22!==TP(NP+"0x16")||kP&&!AP((function(){TP(Object(kP))})),LP=Gn,jP=S,_P=Hr,qP=DP?function(e,t){var r=IP(PP(e));return TP(r,t>>>0||($P(MP,r)?16:10))}:TP,VP="Invalid number representation",UP=RangeError,FP=SyntaxError,BP=TypeError,zP=/^[\da-z]+$/,KP=jP("".charAt),WP=jP(zP.exec),XP=jP(1..toString),ZP=jP("".slice);LP({target:"Number",stat:!0,forced:!0},{fromString:function(e,t){var r,n,i=1;if("string"!=typeof e)throw BP(VP);if(!e.length)throw FP(VP);if("-"==KP(e,0)&&(i=-1,!(e=ZP(e,1)).length))throw FP(VP);if((r=void 0===t?10:_P(t))<2||r>36)throw UP("Invalid radix");if(!WP(zP,e)||XP(n=qP(e,r),r)!==e)throw FP(VP);return i*n}});var GP=Cw;Gn({target:"Number",stat:!0,forced:!0},{range:function(e,t,r){return new GP(e,t,r,"number",0,1)}});var HP=Ir,JP=lw,YP=Me,QP=ya,eI=Te,tI="Object Iterator",rI=HP.set,nI=HP.getterFor(tI),iI=JP((function(e,t){var r=eI(e);rI(this,{type:tI,mode:t,object:r,keys:QP(r),index:0})}),"Object",(function(){for(var e=nI(this),t=e.keys;;){if(null===t||e.index>=t.length)return e.object=e.keys=null,{value:void 0,done:!0};var r=t[e.index++],n=e.object;if(YP(n,r)){switch(e.mode){case"keys":return{value:r,done:!1};case"values":return{value:n[r],done:!1}}return{value:[r,n[r]],done:!1}}}})),aI=iI;Gn({target:"Object",stat:!0,forced:!0},{iterateEntries:function(e){return new aI(e,"entries")}});var oI=iI;Gn({target:"Object",stat:!0,forced:!0},{iterateKeys:function(e){return new oI(e,"keys")}});var sI=iI;Gn({target:"Object",stat:!0,forced:!0},{iterateValues:function(e){return new sI(e,"values")}});var uI=r,lI=r,cI=j,dI=Ge("observable"),fI=lI.Observable,pI=fI&&fI.prototype,mI=!(cI(fI)&&cI(fI.from)&&cI(fI.of)&&cI(pI.subscribe)&&cI(pI[dI])),hI=Gn,gI=l,yI=a,bI=kp,vI=pe,wI=j,OI=Pt,SI=q,CI=ed,EI=he,AI=Kr,RI=Jc,PI=Qs,II=function(e,t){var r=uI.console;r&&r.error&&(1==arguments.length?r.error(e):r.error(e,t))},NI=Ir,TI=mI,xI=Ge("observable"),kI="Observable",MI="Subscription",$I="SubscriptionObserver",DI=NI.getterFor,LI=NI.set,jI=DI(kI),_I=DI(MI),qI=DI($I),VI=function(e){this.observer=OI(e),this.cleanup=void 0,this.subscriptionObserver=void 0};VI.prototype={type:MI,clean:function(){var e=this.cleanup;if(e){this.cleanup=void 0;try{e()}catch(e){II(e)}}},close:function(){if(!yI){var e=this.facade,t=this.subscriptionObserver;e.closed=!0,t&&(t.closed=!0)}this.observer=void 0},isClosed:function(){return void 0===this.observer}};var UI=function(e,t){var r,n=LI(this,new VI(e));yI||(this.closed=!1);try{(r=EI(e,"start"))&&gI(r,e,this)}catch(e){II(e)}if(!n.isClosed()){var i=n.subscriptionObserver=new FI(n);try{var a=t(i),o=a;null!=a&&(n.cleanup=wI(a.unsubscribe)?function(){o.unsubscribe()}:vI(a))}catch(e){return void i.error(e)}n.isClosed()&&n.clean()}};UI.prototype=RI({},{unsubscribe:function(){var e=_I(this);e.isClosed()||(e.close(),e.clean())}}),yI&&PI(UI.prototype,"closed",{configurable:!0,get:function(){return _I(this).isClosed()}});var FI=function(e){LI(this,{type:$I,subscriptionState:e}),yI||(this.closed=!1)};FI.prototype=RI({},{next:function(e){var t=qI(this).subscriptionState;if(!t.isClosed()){var r=t.observer;try{var n=EI(r,"next");n&&gI(n,r,e)}catch(e){II(e)}}},error:function(e){var t=qI(this).subscriptionState;if(!t.isClosed()){var r=t.observer;t.close();try{var n=EI(r,"error");n?gI(n,r,e):II(e)}catch(e){II(e)}t.clean()}},complete:function(){var e=qI(this).subscriptionState;if(!e.isClosed()){var t=e.observer;e.close();try{var r=EI(t,"complete");r&&gI(r,t)}catch(e){II(e)}e.clean()}}}),yI&&PI(FI.prototype,"closed",{configurable:!0,get:function(){return qI(this).subscriptionState.isClosed()}});var BI=function(e){CI(this,zI),LI(this,{type:kI,subscriber:vI(e)})},zI=BI.prototype;RI(zI,{subscribe:function(e){var t=arguments.length;return new UI(wI(e)?{next:e,error:t>1?arguments[1]:void 0,complete:t>2?arguments[2]:void 0}:SI(e)?e:{},jI(this).subscriber)}}),AI(zI,xI,(function(){return this})),hI({global:!0,constructor:!0,forced:TI},{Observable:BI}),bI(kI);var KI=Gn,WI=B,XI=l,ZI=Pt,GI=Hf,HI=io,JI=he,YI=Co,QI=mI,eN=Ge("observable");KI({target:"Observable",stat:!0,forced:QI},{from:function(e){var t=GI(this)?this:WI("Observable"),r=JI(ZI(e),eN);if(r){var n=ZI(XI(r,e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}var i=HI(e);return new t((function(e){YI(i,(function(t,r){if(e.next(t),e.closed)return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}),e.complete()}))}});var tN=Gn,rN=B,nN=Hf,iN=mI,aN=rN("Array");tN({target:"Observable",stat:!0,forced:iN},{of:function(){for(var e=nN(this)?this:rN("Observable"),t=arguments.length,r=aN(t),n=0;n<t;)r[n]=arguments[n++];return new e((function(e){for(var n=0;n<t;n++)if(e.next(r[n]),e.closed)return;e.complete()}))}});var oN=$s,sN=js;Gn({target:"Promise",stat:!0,forced:!0},{try:function(e){var t=oN.f(this),r=sN(e);return(r.error?t.reject:t.resolve)(r.value),t.promise}});var uN=B,lN=S,cN=we.exports,dN=uN("Map"),fN=uN("WeakMap"),pN=lN([].push),mN=cN("metadata"),hN=mN.store||(mN.store=new fN),gN=function(e,t,r){var n=hN.get(e);if(!n){if(!r)return;hN.set(e,n=new dN)}var i=n.get(t);if(!i){if(!r)return;n.set(t,i=new dN)}return i},yN={store:hN,getMap:gN,has:function(e,t,r){var n=gN(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=gN(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){gN(r,n,!0).set(e,t)},keys:function(e,t){var r=gN(e,t,!1),n=[];return r&&r.forEach((function(e,t){pN(n,t)})),n},toKey:function(e){return void 0===e||"symbol"==typeof e?e:String(e)}},bN=Pt,vN=yN.toKey,wN=yN.set;Gn({target:"Reflect",stat:!0},{defineMetadata:function(e,t,r){var n=arguments.length<4?void 0:vN(arguments[3]);wN(e,t,bN(r),n)}});var ON=Pt,SN=yN.toKey,CN=yN.getMap,EN=yN.store;Gn({target:"Reflect",stat:!0},{deleteMetadata:function(e,t){var r=arguments.length<3?void 0:SN(arguments[2]),n=CN(ON(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var i=EN.get(t);return i.delete(r),!!i.size||EN.delete(t)}});var AN=Pt,RN=pa,PN=yN.has,IN=yN.get,NN=yN.toKey,TN=function(e,t,r){if(PN(e,t,r))return IN(e,t,r);var n=RN(t);return null!==n?TN(e,n,r):void 0};Gn({target:"Reflect",stat:!0},{getMetadata:function(e,t){var r=arguments.length<3?void 0:NN(arguments[2]);return TN(e,AN(t),r)}});var xN=Gn,kN=S,MN=yN,$N=Pt,DN=pa,LN=kN(fb),jN=kN([].concat),_N=MN.keys,qN=MN.toKey,VN=function(e,t){var r=_N(e,t),n=DN(e);if(null===n)return r;var i=VN(n,t);return i.length?r.length?LN(jN(r,i)):i:r};xN({target:"Reflect",stat:!0},{getMetadataKeys:function(e){var t=arguments.length<2?void 0:qN(arguments[1]);return VN($N(e),t)}});var UN=Pt,FN=yN.get,BN=yN.toKey;Gn({target:"Reflect",stat:!0},{getOwnMetadata:function(e,t){var r=arguments.length<3?void 0:BN(arguments[2]);return FN(e,UN(t),r)}});var zN=Pt,KN=yN.keys,WN=yN.toKey;Gn({target:"Reflect",stat:!0},{getOwnMetadataKeys:function(e){var t=arguments.length<2?void 0:WN(arguments[1]);return KN(zN(e),t)}});var XN=Pt,ZN=pa,GN=yN.has,HN=yN.toKey,JN=function(e,t,r){if(GN(e,t,r))return!0;var n=ZN(t);return null!==n&&JN(e,n,r)};Gn({target:"Reflect",stat:!0},{hasMetadata:function(e,t){var r=arguments.length<3?void 0:HN(arguments[2]);return JN(e,XN(t),r)}});var YN=Pt,QN=yN.has,eT=yN.toKey;Gn({target:"Reflect",stat:!0},{hasOwnMetadata:function(e,t){var r=arguments.length<3?void 0:eT(arguments[2]);return QN(e,YN(t),r)}});var tT=Pt,rT=yN.toKey,nT=yN.set;Gn({target:"Reflect",stat:!0},{metadata:function(e,t){return function(r,n){nT(e,t,tT(r),rT(n))}}});var iT=l,aT=pe,oT=Pt,sT=function(){for(var e=oT(this),t=aT(e.add),r=0,n=arguments.length;r<n;r++)iT(t,e,arguments[r]);return e};Gn({target:"Set",proto:!0,real:!0,forced:!0},{addAll:sT}),Gn({target:"Set",proto:!0,real:!0,forced:!0},{deleteAll:JE});var uT=B,lT=l,cT=pe,dT=Pt,fT=dA,pT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{difference:function(e){var t=dT(this),r=new(fT(t,uT("Set")))(t),n=cT(r.delete);return pT(e,(function(e){lT(n,r,e)})),r}});var mT=l,hT=function(e){return mT(Set.prototype.values,e)},gT=Pt,yT=Ua,bT=hT,vT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{every:function(e){var t=gT(this),r=bT(t),n=yT(e,arguments.length>1?arguments[1]:void 0);return!vT(r,(function(e,r){if(!n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var wT=B,OT=l,ST=pe,CT=Pt,ET=Ua,AT=dA,RT=hT,PT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{filter:function(e){var t=CT(this),r=RT(t),n=ET(e,arguments.length>1?arguments[1]:void 0),i=new(AT(t,wT("Set"))),a=ST(i.add);return PT(r,(function(e){n(e,e,t)&&OT(a,i,e)}),{IS_ITERATOR:!0}),i}});var IT=Pt,NT=Ua,TT=hT,xT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{find:function(e){var t=IT(this),r=TT(t),n=NT(e,arguments.length>1?arguments[1]:void 0);return xT(r,(function(e,r){if(n(e,e,t))return r(e)}),{IS_ITERATOR:!0,INTERRUPTED:!0}).result}}),Gn({target:"Set",stat:!0,forced:!0},{from:$A});var kT=B,MT=l,$T=pe,DT=Pt,LT=dA,jT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{intersection:function(e){var t=DT(this),r=new(LT(t,kT("Set"))),n=$T(t.has),i=$T(r.add);return jT(e,(function(e){MT(n,t,e)&&MT(i,r,e)})),r}});var _T=l,qT=pe,VT=Pt,UT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{isDisjointFrom:function(e){var t=VT(this),r=qT(t.has);return!UT(e,(function(e,n){if(!0===_T(r,t,e))return n()}),{INTERRUPTED:!0}).stopped}});var FT=B,BT=l,zT=pe,KT=j,WT=Pt,XT=io,ZT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{isSubsetOf:function(e){var t=XT(this),r=WT(e),n=r.has;return KT(n)||(r=new(FT("Set"))(e),n=zT(r.has)),!ZT(t,(function(e,t){if(!1===BT(n,r,e))return t()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var GT=l,HT=pe,JT=Pt,YT=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{isSupersetOf:function(e){var t=JT(this),r=HT(t.has);return!YT(e,(function(e,n){if(!1===GT(r,t,e))return n()}),{INTERRUPTED:!0}).stopped}});var QT=Gn,ex=Pt,tx=Ci,rx=hT,nx=Co,ix=S([].join),ax=[].push;QT({target:"Set",proto:!0,real:!0,forced:!0},{join:function(e){var t=ex(this),r=rx(t),n=void 0===e?",":tx(e),i=[];return nx(r,ax,{that:i,IS_ITERATOR:!0}),ix(i,n)}});var ox=B,sx=Ua,ux=l,lx=pe,cx=Pt,dx=dA,fx=hT,px=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{map:function(e){var t=cx(this),r=fx(t),n=sx(e,arguments.length>1?arguments[1]:void 0),i=new(dx(t,ox("Set"))),a=lx(i.add);return px(r,(function(e){ux(a,i,n(e,e,t))}),{IS_ITERATOR:!0}),i}}),Gn({target:"Set",stat:!0,forced:!0},{of:bR});var mx=pe,hx=Pt,gx=hT,yx=Co,bx=TypeError;Gn({target:"Set",proto:!0,real:!0,forced:!0},{reduce:function(e){var t=hx(this),r=gx(t),n=arguments.length<2,i=n?void 0:arguments[1];if(mx(e),yx(r,(function(r){n?(n=!1,i=r):i=e(i,r,r,t)}),{IS_ITERATOR:!0}),n)throw bx("Reduce of empty set with no initial value");return i}});var vx=Pt,wx=Ua,Ox=hT,Sx=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{some:function(e){var t=vx(this),r=Ox(t),n=wx(e,arguments.length>1?arguments[1]:void 0);return Sx(r,(function(e,r){if(n(e,e,t))return r()}),{IS_ITERATOR:!0,INTERRUPTED:!0}).stopped}});var Cx=B,Ex=l,Ax=pe,Rx=Pt,Px=dA,Ix=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{symmetricDifference:function(e){var t=Rx(this),r=new(Px(t,Cx("Set")))(t),n=Ax(r.delete),i=Ax(r.add);return Ix(e,(function(e){Ex(n,r,e)||Ex(i,r,e)})),r}});var Nx=B,Tx=pe,xx=Pt,kx=dA,Mx=Co;Gn({target:"Set",proto:!0,real:!0,forced:!0},{union:function(e){var t=xx(this),r=new(kx(t,Nx("Set")))(t);return Mx(e,Tx(r.add),{that:r}),r}});var $x=dl.charAt,Dx=M,Lx=Hr,jx=Ci;Gn({target:"String",proto:!0,forced:!0},{at:function(e){var t=jx(Dx(this)),r=t.length,n=Lx(e),i=n>=0?n:r+n;return i<0||i>=r?void 0:$x(t,i)}});var _x=Gn,qx=S,Vx=L,Ux=Ci,Fx=on,Bx=TypeError,zx=Array.prototype,Kx=qx(zx.push),Wx=qx(zx.join);_x({target:"String",stat:!0,forced:!0},{cooked:function(e){for(var t=Vx(e),r=Fx(t),n=arguments.length,i=[],a=0;r>a;){var o=t[a++];if(void 0===o)throw Bx("Incorrect template");if(Kx(i,Ux(o)),a===r)return Wx(i,"");a<n&&Kx(i,Ux(arguments[a]))}}});var Xx=Gn,Zx=lw,Gx=M,Hx=Ci,Jx=Ir,Yx=dl.codeAt,Qx=dl.charAt,ek="String Iterator",tk=Jx.set,rk=Jx.getterFor(ek),nk=Zx((function(e){tk(this,{type:ek,string:e,index:0})}),"String",(function(){var e,t=rk(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=Qx(r,n),t.index+=e.length,{value:{codePoint:Yx(e,0),position:n},done:!1})}));Xx({target:"String",proto:!0,forced:!0},{codePoints:function(){return new nk(Hx(Gx(this)))}});var ik=r,ak={},ok=Ge;ak.f=ok;var sk=ik,uk=Me,lk=ak,ck=St.f,dk=function(e){var t=sk.Symbol||(sk.Symbol={});uk(t,e)||ck(t,e,{value:lk.f(e)})};dk("asyncDispose"),dk("dispose"),dk("matcher"),dk("metadata"),dk("metadataKey"),dk("observable"),dk("patternMatch"),dk("replaceAll");var fk=B,pk=ep,mk=_g,hk=zg,gk=Fc.aTypedArrayConstructor;(0,Fc.exportTypedArrayStaticMethod)("fromAsync",(function(e){var t=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(fk("Promise"))((function(r){pk(t),r(mk(e,n,i))})).then((function(e){return hk(gk(t),e)}))}),!0);var yk=dA,bk=Fc.aTypedArrayConstructor,vk=Fc.getTypedArrayConstructor,wk=function(e){return bk(yk(e,vk(e)))},Ok=zg,Sk=wk,Ck=function(e,t){return Ok(Sk(e),t)},Ek=Pp.filterReject,Ak=Ck,Rk=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("filterOut",(function(e){var t=Ek(Rk(this),e,arguments.length>1?arguments[1]:void 0);return Ak(this,t)}),!0);var Pk=Pp.filterReject,Ik=Ck,Nk=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("filterReject",(function(e){var t=Pk(Nk(this),e,arguments.length>1?arguments[1]:void 0);return Ik(this,t)}),!0);var Tk=ey,xk=wk,kk=Fc.aTypedArray;(0,Fc.exportTypedArrayMethod)("groupBy",(function(e){var t=arguments.length>1?arguments[1]:void 0;return Tk(kk(this),e,t,xk)}),!0);var Mk=My,$k=Fc.aTypedArray,Dk=Fc.getTypedArrayConstructor;(0,Fc.exportTypedArrayMethod)("toReversed",(function(){return Mk($k(this),Dk(this))}));var Lk=pe,jk=zg,_k=Fc.aTypedArray,qk=Fc.getTypedArrayConstructor,Vk=Fc.exportTypedArrayMethod,Uk=S(Fc.TypedArrayPrototype.sort);Vk("toSorted",(function(e){void 0!==e&&Lk(e);var t=_k(this),r=jk(qk(t),t);return Uk(r,e)}));var Fk=on,Bk=en,zk=Hr,Kk=i,Wk=Fc.aTypedArray,Xk=Fc.getTypedArrayConstructor,Zk=Fc.exportTypedArrayMethod,Gk=Math.max,Hk=Math.min;Zk("toSpliced",(function(e,t){var r,n,i,a,o,s=Wk(this),u=Xk(s),l=Fk(s),c=Bk(e,l),d=arguments.length,f=0;if(0===d)r=n=0;else if(1===d)r=0,n=l-c;else if(n=Hk(Gk(zk(t),0),l-c),r=d-2){i=new u(r);for(var p=2;p<d;p++)i[p-2]=arguments[p]}for(o=new u(a=l+r-n);f<c;f++)o[f]=s[f];for(;f<c+r;f++)o[f]=i[f-c];for(;f<a;f++)o[f]=s[f+n-r];return o}),!!Kk((function(){var e=new Int8Array([1]),t=e.toSpliced(1,0,{valueOf:function(){return e[0]=2,3}});return 2!==t[0]||3!==t[1]})));var Jk=Ck,Yk=Fc.aTypedArray,Qk=Fc.exportTypedArrayMethod,eM=S(fb);Qk("uniqueBy",(function(e){return Jk(this,eM(Yk(this),e))}),!0);var tM=wi,rM=S("".slice),nM=yb,iM=function(e){return"Big"===rM(tM(e),0,3)},aM=Hr,oM=jm,sM=Fc.aTypedArray,uM=Fc.getTypedArrayConstructor,lM=Fc.exportTypedArrayMethod,cM=!!function(){try{new Int8Array(1).with(2,{valueOf:function(){throw 8}})}catch(e){return 8===e}}();lM("with",{with:function(e,t){var r=sM(this),n=aM(e),i=iM(r)?oM(t):+t;return nM(r,uM(r),n,i)}}.with,!cM),Gn({target:"WeakMap",proto:!0,real:!0,forced:!0},{deleteAll:JE}),Gn({target:"WeakMap",stat:!0,forced:!0},{from:$A}),Gn({target:"WeakMap",stat:!0,forced:!0},{of:bR}),Gn({target:"WeakMap",proto:!0,real:!0,forced:!0},{emplace:tA}),Gn({target:"WeakMap",proto:!0,real:!0,forced:!0},{upsert:jR}),Gn({target:"WeakSet",proto:!0,real:!0,forced:!0},{addAll:sT}),Gn({target:"WeakSet",proto:!0,real:!0,forced:!0},{deleteAll:JE}),Gn({target:"WeakSet",stat:!0,forced:!0},{from:$A}),Gn({target:"WeakSet",stat:!0,forced:!0},{of:bR});var dM=Gn,fM=B,pM=g,mM=St.f,hM=Me,gM=ed,yM=fi,bM=Ai,vM={IndexSizeError:{s:"INDEX_SIZE_ERR",c:1,m:1},DOMStringSizeError:{s:"DOMSTRING_SIZE_ERR",c:2,m:0},HierarchyRequestError:{s:"HIERARCHY_REQUEST_ERR",c:3,m:1},WrongDocumentError:{s:"WRONG_DOCUMENT_ERR",c:4,m:1},InvalidCharacterError:{s:"INVALID_CHARACTER_ERR",c:5,m:1},NoDataAllowedError:{s:"NO_DATA_ALLOWED_ERR",c:6,m:0},NoModificationAllowedError:{s:"NO_MODIFICATION_ALLOWED_ERR",c:7,m:1},NotFoundError:{s:"NOT_FOUND_ERR",c:8,m:1},NotSupportedError:{s:"NOT_SUPPORTED_ERR",c:9,m:1},InUseAttributeError:{s:"INUSE_ATTRIBUTE_ERR",c:10,m:1},InvalidStateError:{s:"INVALID_STATE_ERR",c:11,m:1},SyntaxError:{s:"SYNTAX_ERR",c:12,m:1},InvalidModificationError:{s:"INVALID_MODIFICATION_ERR",c:13,m:1},NamespaceError:{s:"NAMESPACE_ERR",c:14,m:1},InvalidAccessError:{s:"INVALID_ACCESS_ERR",c:15,m:1},ValidationError:{s:"VALIDATION_ERR",c:16,m:0},TypeMismatchError:{s:"TYPE_MISMATCH_ERR",c:17,m:1},SecurityError:{s:"SECURITY_ERR",c:18,m:1},NetworkError:{s:"NETWORK_ERR",c:19,m:1},AbortError:{s:"ABORT_ERR",c:20,m:1},URLMismatchError:{s:"URL_MISMATCH_ERR",c:21,m:1},QuotaExceededError:{s:"QUOTA_EXCEEDED_ERR",c:22,m:1},TimeoutError:{s:"TIMEOUT_ERR",c:23,m:1},InvalidNodeTypeError:{s:"INVALID_NODE_TYPE_ERR",c:24,m:1},DataCloneError:{s:"DATA_CLONE_ERR",c:25,m:1}},wM=$i,OM="DOMException",SM=fM("Error"),CM=fM(OM),EM=function(){gM(this,AM);var e=arguments.length,t=bM(e<1?void 0:arguments[0]),r=bM(e<2?void 0:arguments[1],"Error"),n=new CM(t,r),i=SM(t);return i.name=OM,mM(n,"stack",pM(1,wM(i.stack,1))),yM(n,this,EM),n},AM=EM.prototype=CM.prototype,RM="stack"in SM(OM),PM="stack"in new CM(1,2),IM=RM&&!PM;dM({global:!0,constructor:!0,forced:IM},{DOMException:IM?EM:CM});var NM=fM(OM),TM=NM.prototype;if(TM.constructor!==NM)for(var xM in mM(TM,"constructor",pM(1,NM)),vM)if(hM(vM,xM)){var kM=vM[xM],MM=kM.s;hM(NM,MM)||mM(NM,MM,pM(6,kM.c))}var $M,DM,LM,jM,_M=TypeError,qM=function(e,t){if(e<t)throw _M("Not enough arguments");return e},VM=/(?:ipad|iphone|ipod).*applewebkit/i.test(K),UM="process"==R(r.process),FM=r,BM=ei,zM=Ua,KM=j,WM=Me,XM=i,ZM=Aa,GM=gR,HM=ct,JM=qM,YM=VM,QM=UM,e$=FM.setImmediate,t$=FM.clearImmediate,r$=FM.process,n$=FM.Dispatch,i$=FM.Function,a$=FM.MessageChannel,o$=FM.String,s$=0,u$={},l$="onreadystatechange";try{$M=FM.location}catch(XV){}var c$=function(e){if(WM(u$,e)){var t=u$[e];delete u$[e],t()}},d$=function(e){return function(){c$(e)}},f$=function(e){c$(e.data)},p$=function(e){FM.postMessage(o$(e),$M.protocol+"//"+$M.host)};e$&&t$||(e$=function(e){JM(arguments.length,1);var t=KM(e)?e:i$(e),r=GM(arguments,1);return u$[++s$]=function(){BM(t,void 0,r)},DM(s$),s$},t$=function(e){delete u$[e]},QM?DM=function(e){r$.nextTick(d$(e))}:n$&&n$.now?DM=function(e){n$.now(d$(e))}:a$&&!YM?(jM=(LM=new a$).port2,LM.port1.onmessage=f$,DM=zM(jM.postMessage,jM)):FM.addEventListener&&KM(FM.postMessage)&&!FM.importScripts&&$M&&"file:"!==$M.protocol&&!XM(p$)?(DM=p$,FM.addEventListener("message",f$,!1)):DM=l$ in HM("script")?function(e){ZM.appendChild(HM("script")).onreadystatechange=function(){ZM.removeChild(this),c$(e)}}:function(e){setTimeout(d$(e),0)});var m$={set:e$,clear:t$},h$=m$.clear;Gn({global:!0,bind:!0,enumerable:!0,forced:r.clearImmediate!==h$},{clearImmediate:h$});var g$=m$.set;Gn({global:!0,bind:!0,enumerable:!0,forced:r.setImmediate!==g$},{setImmediate:g$});var y$,b$=l,v$=Me,w$=z,O$=tu,S$=RegExp.prototype,C$="object"==typeof window&&"object"!=typeof Deno,E$="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,A$=Gn,R$=r,P$=B,I$=S,N$=i,T$=_e,x$=j,k$=Hf,M$=q,$$=se,D$=Co,L$=Pt,j$=wi,_$=Me,q$=vd,V$=Ut,U$=on,F$=qM,B$=function(e){var t=e.flags;return void 0!==t||"flags"in S$||v$(e,"flags")||!w$(S$,e)?t:b$(O$,e)},z$=Li,K$=Y,W$=C$,X$=E$,Z$=UM,G$=R$.Object,H$=R$.Date,J$=R$.Error,Y$=R$.EvalError,Q$=R$.RangeError,eD=R$.ReferenceError,tD=R$.SyntaxError,rD=R$.TypeError,nD=R$.URIError,iD=R$.PerformanceMark,aD=R$.WebAssembly,oD=aD&&aD.CompileError||J$,sD=aD&&aD.LinkError||J$,uD=aD&&aD.RuntimeError||J$,lD=P$("DOMException"),cD=P$("Set"),dD=P$("Map"),fD=dD.prototype,pD=I$(fD.has),mD=I$(fD.get),hD=I$(fD.set),gD=I$(cD.prototype.add),yD=P$("Object","keys"),bD=I$([].push),vD=I$((!0).valueOf),wD=I$(1..valueOf),OD=I$("".valueOf),SD=I$(H$.prototype.getTime),CD=T$("structuredClone"),ED="DataCloneError",AD="Transferring",RD=function(e){return!N$((function(){var t=new R$.Set([7]),r=e(t),n=e(G$(7));return r==t||!r.has(7)||"object"!=typeof n||7!=n}))&&e},PD=function(e,t){return!N$((function(){var r=new t,n=e({a:r,b:r});return!(n&&n.a===n.b&&n.a instanceof t)}))},ID=R$.structuredClone,ND=!PD(ID,J$)||!PD(ID,lD)||(y$=ID,!!N$((function(){var e=y$(new R$.AggregateError([1],CD,{cause:3}));return"AggregateError"!=e.name||1!=e.errors[0]||e.message!=CD||3!=e.cause}))),TD=!ID&&RD((function(e){return new iD(CD,{detail:e}).detail})),xD=RD(ID)||TD,kD=function(e){throw new lD("Uncloneable type: "+e,ED)},MD=function(e,t){throw new lD((t||"Cloning")+" of "+e+" cannot be properly polyfilled in this engine",ED)},$D=function(e,t){if($$(e)&&kD("Symbol"),!M$(e))return e;if(t){if(pD(t,e))return mD(t,e)}else t=new dD;var r,n,i,a,o,s,u,l,c,d,f=j$(e),p=!1;switch(f){case"Array":i=[],p=!0;break;case"Object":i={},p=!0;break;case"Map":i=new dD,p=!0;break;case"Set":i=new cD,p=!0;break;case"RegExp":i=new RegExp(e.source,B$(e));break;case"Error":switch(n=e.name){case"AggregateError":i=P$("AggregateError")([]);break;case"EvalError":i=Y$();break;case"RangeError":i=Q$();break;case"ReferenceError":i=eD();break;case"SyntaxError":i=tD();break;case"TypeError":i=rD();break;case"URIError":i=nD();break;case"CompileError":i=oD();break;case"LinkError":i=sD();break;case"RuntimeError":i=uD();break;default:i=J$()}p=!0;break;case"DOMException":i=new lD(e.message,e.name),p=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":r=R$[f],M$(r)||MD(f),i=new r($D(e.buffer,t),e.byteOffset,"DataView"===f?e.byteLength:e.length);break;case"DOMQuad":try{i=new DOMQuad($D(e.p1,t),$D(e.p2,t),$D(e.p3,t),$D(e.p4,t))}catch(t){xD?i=xD(e):MD(f)}break;case"FileList":if(r=R$.DataTransfer,k$(r)){for(a=new r,o=0,s=U$(e);o<s;o++)a.items.add($D(e[o],t));i=a.files}else xD?i=xD(e):MD(f);break;case"ImageData":try{i=new ImageData($D(e.data,t),e.width,e.height,{colorSpace:e.colorSpace})}catch(t){xD?i=xD(e):MD(f)}break;default:if(xD)i=xD(e);else switch(f){case"BigInt":i=G$(e.valueOf());break;case"Boolean":i=G$(vD(e));break;case"Number":i=G$(wD(e));break;case"String":i=G$(OD(e));break;case"Date":i=new H$(SD(e));break;case"ArrayBuffer":(r=R$.DataView)||"function"==typeof e.slice||MD(f);try{if("function"==typeof e.slice)i=e.slice(0);else for(s=e.byteLength,i=new ArrayBuffer(s),c=new r(e),d=new r(i),o=0;o<s;o++)d.setUint8(o,c.getUint8(o))}catch(e){throw new lD("ArrayBuffer is detached",ED)}break;case"SharedArrayBuffer":i=e;break;case"Blob":try{i=e.slice(0,e.size,e.type)}catch(e){MD(f)}break;case"DOMPoint":case"DOMPointReadOnly":r=R$[f];try{i=r.fromPoint?r.fromPoint(e):new r(e.x,e.y,e.z,e.w)}catch(e){MD(f)}break;case"DOMRect":case"DOMRectReadOnly":r=R$[f];try{i=r.fromRect?r.fromRect(e):new r(e.x,e.y,e.width,e.height)}catch(e){MD(f)}break;case"DOMMatrix":case"DOMMatrixReadOnly":r=R$[f];try{i=r.fromMatrix?r.fromMatrix(e):new r(e)}catch(e){MD(f)}break;case"AudioData":case"VideoFrame":x$(e.clone)||MD(f);try{i=e.clone()}catch(e){kD(f)}break;case"File":try{i=new File([e],e.name,e)}catch(e){MD(f)}break;case"CryptoKey":case"GPUCompilationMessage":case"GPUCompilationInfo":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":MD(f);default:kD(f)}}if(hD(t,e,i),p)switch(f){case"Array":case"Object":for(u=yD(e),o=0,s=U$(u);o<s;o++)l=u[o],q$(i,l,$D(e[l],t));break;case"Map":e.forEach((function(e,r){hD(i,$D(r,t),$D(e,t))}));break;case"Set":e.forEach((function(e){gD(i,$D(e,t))}));break;case"Error":V$(i,"message",$D(e.message,t)),_$(e,"cause")&&V$(i,"cause",$D(e.cause,t)),"AggregateError"==n&&(i.errors=$D(e.errors,t));case"DOMException":z$&&V$(i,"stack",$D(e.stack,t))}return i},DD=ID&&!N$((function(){if(X$&&K$>92||Z$&&K$>94||W$&&K$>97)return!1;var e=new ArrayBuffer(8),t=ID(e,{transfer:[e]});return 0!=e.byteLength||8!=t.byteLength})),LD=function(e,t){if(!M$(e))throw rD("Transfer option cannot be converted to a sequence");var r=[];D$(e,(function(e){bD(r,L$(e))}));var n,i,a,o,s,u,l=0,c=U$(r);if(DD)for(o=ID(r,{transfer:r});l<c;)hD(t,r[l],o[l++]);else for(;l<c;){if(n=r[l++],pD(t,n))throw new lD("Duplicate transferable",ED);switch(i=j$(n)){case"ImageBitmap":a=R$.OffscreenCanvas,k$(a)||MD(i,AD);try{(u=new a(n.width,n.height)).getContext("bitmaprenderer").transferFromImageBitmap(n),s=u.transferToImageBitmap()}catch(e){}break;case"AudioData":case"VideoFrame":x$(n.clone)&&x$(n.close)||MD(i,AD);try{s=n.clone(),n.close()}catch(e){}break;case"ArrayBuffer":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":MD(i,AD)}if(void 0===s)throw new lD("This object cannot be transferred: "+i,ED);hD(t,n,s)}};A$({global:!0,enumerable:!0,sham:!DD,forced:ND},{structuredClone:function(e){var t,r=F$(arguments.length,1)>1&&null!=arguments[1]?L$(arguments[1]):void 0,n=r?r.transfer:void 0;return void 0!==n&&(t=new dD,LD(n,t)),$D(e,t)}});var jD=dl.charAt,_D=Ci,qD=Ir,VD=DO,UD="String Iterator",FD=qD.set,BD=qD.getterFor(UD);VD(String,"String",(function(e){FD(this,{type:UD,string:_D(e),index:0})}),(function(){var e,t=BD(this),r=t.string,n=t.index;return n>=r.length?{value:void 0,done:!0}:(e=jD(r,n),t.index+=e.length,{value:e,done:!1})}));var zD=i,KD=Ge("iterator"),WD=!zD((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[KD]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://тест").host||"#%D0%B1"!==new URL("http://a#б").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host})),XD=a,ZD=S,GD=l,HD=i,JD=ya,YD=On,QD=c,eL=Te,tL=x,rL=Object.assign,nL=Object.defineProperty,iL=ZD([].concat),aL=!rL||HD((function(){if(XD&&1!==rL({b:1},rL(nL({},"a",{enumerable:!0,get:function(){nL(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=rL({},e)[r]||JD(rL({},t)).join("")!=n}))?function(e,t){for(var r=eL(e),n=arguments.length,i=1,a=YD.f,o=QD.f;n>i;)for(var s,u=tL(arguments[i++]),l=a?iL(JD(u),a(u)):JD(u),c=l.length,d=0;c>d;)s=l[d++],XD&&!GD(o,u,s)||(r[s]=u[s]);return r}:rL,oL=Ua,sL=l,uL=Te,lL=HC,cL=Wa,dL=Hf,fL=on,pL=vd,mL=io,hL=Ja,gL=Array,yL=S,bL=2147483647,vL=/[^\0-\u007E]/,wL=/[.\u3002\uFF0E\uFF61]/g,OL="Overflow: input needs wider integers to process",SL=RangeError,CL=yL(wL.exec),EL=Math.floor,AL=String.fromCharCode,RL=yL("".charCodeAt),PL=yL([].join),IL=yL([].push),NL=yL("".replace),TL=yL("".split),xL=yL("".toLowerCase),kL=function(e){return e+22+75*(e<26)},ML=function(e,t,r){var n=0;for(e=r?EL(e/700):e>>1,e+=EL(e/t);e>455;)e=EL(e/35),n+=36;return EL(n+36*e/(e+38))},$L=function(e){var t=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=RL(e,r++);if(i>=55296&&i<=56319&&r<n){var a=RL(e,r++);56320==(64512&a)?IL(t,((1023&i)<<10)+(1023&a)+65536):(IL(t,i),r--)}else IL(t,i)}return t}(e);var r,n,i=e.length,a=128,o=0,s=72;for(r=0;r<e.length;r++)(n=e[r])<128&&IL(t,AL(n));var u=t.length,l=u;for(u&&IL(t,"-");l<i;){var c=bL;for(r=0;r<e.length;r++)(n=e[r])>=a&&n<c&&(c=n);var d=l+1;if(c-a>EL((bL-o)/d))throw SL(OL);for(o+=(c-a)*d,a=c,r=0;r<e.length;r++){if((n=e[r])<a&&++o>bL)throw SL(OL);if(n==a){for(var f=o,p=36;;){var m=p<=s?1:p>=s+26?26:p-s;if(f<m)break;var h=f-m,g=36-m;IL(t,AL(kL(m+h%g))),f=EL(h/g),p+=36}IL(t,AL(kL(f))),s=ML(o,d,l==u),o=0,l++}}o++,a++}return PL(t,"")},DL=L,LL=es,jL=Fa,_L=Ir,qL=St.f,VL=DO,UL=a,FL="Array Iterator",BL=_L.set,zL=_L.getterFor(FL);VL(Array,"Array",(function(e,t){BL(this,{type:FL,target:DL(e),index:0,kind:t})}),(function(){var e=zL(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values");var KL=jL.Arguments=jL.Array;if(LL("keys"),LL("values"),LL("entries"),UL&&"values"!==KL.name)try{qL(KL,"name",{value:"values"})}catch(XV){}var WL=Gn,XL=r,ZL=l,GL=S,HL=a,JL=WD,YL=Kr,QL=Jc,ej=Zs,tj=lw,rj=Ir,nj=ed,ij=j,aj=Me,oj=Ua,sj=wi,uj=Pt,lj=q,cj=Ci,dj=ja,fj=g,pj=io,mj=Ja,hj=qM,gj=yh,yj=Ge("iterator"),bj="URLSearchParams",vj="URLSearchParamsIterator",wj=rj.set,Oj=rj.getterFor(bj),Sj=rj.getterFor(vj),Cj=Object.getOwnPropertyDescriptor,Ej=function(e){if(!HL)return XL[e];var t=Cj(XL,e);return t&&t.value},Aj=Ej("fetch"),Rj=Ej("Request"),Pj=Ej("Headers"),Ij=Rj&&Rj.prototype,Nj=Pj&&Pj.prototype,Tj=XL.RegExp,xj=XL.TypeError,kj=XL.decodeURIComponent,Mj=XL.encodeURIComponent,$j=GL("".charAt),Dj=GL([].join),Lj=GL([].push),jj=GL("".replace),_j=GL([].shift),qj=GL([].splice),Vj=GL("".split),Uj=GL("".slice),Fj=/\+/g,Bj=Array(4),zj=function(e){return Bj[e-1]||(Bj[e-1]=Tj("((?:%[\\da-f]{2}){"+e+"})","gi"))},Kj=function(e){try{return kj(e)}catch(t){return e}},Wj=function(e){var t=jj(e,Fj," "),r=4;try{return kj(t)}catch(e){for(;r;)t=jj(t,zj(r--),Kj);return t}},Xj=/[!'()~]|%20/g,Zj={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Gj=function(e){return Zj[e]},Hj=function(e){return jj(Mj(e),Xj,Gj)},Jj=tj((function(e,t){wj(this,{type:vj,iterator:pj(Oj(e).entries),kind:t})}),"Iterator",(function(){var e=Sj(this),t=e.kind,r=e.iterator.next(),n=r.value;return r.done||(r.value="keys"===t?n.key:"values"===t?n.value:[n.key,n.value]),r}),!0),Yj=function(e){this.entries=[],this.url=null,void 0!==e&&(lj(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===$j(e,0)?Uj(e,1):e:cj(e)))};Yj.prototype={type:bj,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,i,a,o,s,u=mj(e);if(u)for(r=(t=pj(e,u)).next;!(n=ZL(r,t)).done;){if(a=(i=pj(uj(n.value))).next,(o=ZL(a,i)).done||(s=ZL(a,i)).done||!ZL(a,i).done)throw xj("Expected sequence with length 2");Lj(this.entries,{key:cj(o.value),value:cj(s.value)})}else for(var l in e)aj(e,l)&&Lj(this.entries,{key:l,value:cj(e[l])})},parseQuery:function(e){if(e)for(var t,r,n=Vj(e,"&"),i=0;i<n.length;)(t=n[i++]).length&&(r=Vj(t,"="),Lj(this.entries,{key:Wj(_j(r)),value:Wj(Dj(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],Lj(r,Hj(e.key)+"="+Hj(e.value));return Dj(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Qj=function(){nj(this,e_);var e=arguments.length>0?arguments[0]:void 0;wj(this,new Yj(e))},e_=Qj.prototype;if(QL(e_,{append:function(e,t){hj(arguments.length,2);var r=Oj(this);Lj(r.entries,{key:cj(e),value:cj(t)}),r.updateURL()},delete:function(e){hj(arguments.length,1);for(var t=Oj(this),r=t.entries,n=cj(e),i=0;i<r.length;)r[i].key===n?qj(r,i,1):i++;t.updateURL()},get:function(e){hj(arguments.length,1);for(var t=Oj(this).entries,r=cj(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){hj(arguments.length,1);for(var t=Oj(this).entries,r=cj(e),n=[],i=0;i<t.length;i++)t[i].key===r&&Lj(n,t[i].value);return n},has:function(e){hj(arguments.length,1);for(var t=Oj(this).entries,r=cj(e),n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){hj(arguments.length,1);for(var r,n=Oj(this),i=n.entries,a=!1,o=cj(e),s=cj(t),u=0;u<i.length;u++)(r=i[u]).key===o&&(a?qj(i,u--,1):(a=!0,r.value=s));a||Lj(i,{key:o,value:s}),n.updateURL()},sort:function(){var e=Oj(this);gj(e.entries,(function(e,t){return e.key>t.key?1:-1})),e.updateURL()},forEach:function(e){for(var t,r=Oj(this).entries,n=oj(e,arguments.length>1?arguments[1]:void 0),i=0;i<r.length;)n((t=r[i++]).value,t.key,this)},keys:function(){return new Jj(this,"keys")},values:function(){return new Jj(this,"values")},entries:function(){return new Jj(this,"entries")}},{enumerable:!0}),YL(e_,yj,e_.entries,{name:"entries"}),YL(e_,"toString",(function(){return Oj(this).serialize()}),{enumerable:!0}),ej(Qj,bj),WL({global:!0,constructor:!0,forced:!JL},{URLSearchParams:Qj}),!JL&&ij(Pj)){var t_=GL(Nj.has),r_=GL(Nj.set),n_=function(e){if(lj(e)){var t,r=e.body;if(sj(r)===bj)return t=e.headers?new Pj(e.headers):new Pj,t_(t,"content-type")||r_(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),dj(e,{body:fj(0,cj(r)),headers:fj(0,t)})}return e};if(ij(Aj)&&WL({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return Aj(e,arguments.length>1?n_(arguments[1]):{})}}),ij(Rj)){var i_=function(e){return nj(this,Ij),new Rj(e,arguments.length>1?n_(arguments[1]):{})};Ij.constructor=i_,i_.prototype=Ij,WL({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:i_})}}var a_,o_=Gn,s_=a,u_=WD,l_=r,c_=Ua,d_=S,f_=Kr,p_=Qs,m_=ed,h_=Me,g_=aL,y_=function(e){var t=uL(e),r=dL(this),n=arguments.length,i=n>1?arguments[1]:void 0,a=void 0!==i;a&&(i=oL(i,n>2?arguments[2]:void 0));var o,s,u,l,c,d,f=hL(t),p=0;if(!f||this===gL&&cL(f))for(o=fL(t),s=r?new this(o):gL(o);o>p;p++)d=a?i(t[p],p):t[p],pL(s,p,d);else for(c=(l=mL(t,f)).next,s=r?new this:[];!(u=sL(c,l)).done;p++)d=a?lL(l,i,[u.value,p],!0):u.value,pL(s,p,d);return s.length=p,s},b_=Ad,v_=dl.codeAt,w_=function(e){var t,r,n=[],i=TL(NL(xL(e),wL,"."),".");for(t=0;t<i.length;t++)r=i[t],IL(n,CL(vL,r)?"xn--"+$L(r):r);return PL(n,".")},O_=Ci,S_=Zs,C_=qM,E_={URLSearchParams:Qj,getState:Oj},A_=Ir,R_=A_.set,P_=A_.getterFor("URL"),I_=E_.URLSearchParams,N_=E_.getState,T_=l_.URL,x_=l_.TypeError,k_=l_.parseInt,M_=Math.floor,$_=Math.pow,D_=d_("".charAt),L_=d_(/./.exec),j_=d_([].join),__=d_(1..toString),q_=d_([].pop),V_=d_([].push),U_=d_("".replace),F_=d_([].shift),B_=d_("".split),z_=d_("".slice),K_=d_("".toLowerCase),W_=d_([].unshift),X_="Invalid scheme",Z_="Invalid host",G_="Invalid port",H_=/[a-z]/i,J_=/[\d+-.a-z]/i,Y_=/\d/,Q_=/^0x/i,eq=/^[0-7]+$/,tq=/^\d+$/,rq=/^[\da-f]+$/i,nq=/[\0\t\n\r #%/:<>?@[\\\]^|]/,iq=/[\0\t\n\r #/:<>?@[\\\]^|]/,aq=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,oq=/[\t\n\r]/g,sq=function(e){var t,r,n,i;if("number"==typeof e){for(t=[],r=0;r<4;r++)W_(t,e%256),e=M_(e/256);return j_(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,i=0,a=0;a<8;a++)0!==e[a]?(i>r&&(t=n,r=i),n=null,i=0):(null===n&&(n=a),++i);return i>r&&(t=n,r=i),t}(e),r=0;r<8;r++)i&&0===e[r]||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=__(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},uq={},lq=g_({},uq,{" ":1,'"':1,"<":1,">":1,"`":1}),cq=g_({},lq,{"#":1,"?":1,"{":1,"}":1}),dq=g_({},cq,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),fq=function(e,t){var r=v_(e,0);return r>32&&r<127&&!h_(t,e)?e:encodeURIComponent(e)},pq={ftp:21,file:null,http:80,https:443,ws:80,wss:443},mq=function(e,t){var r;return 2==e.length&&L_(H_,D_(e,0))&&(":"==(r=D_(e,1))||!t&&"|"==r)},hq=function(e){var t;return e.length>1&&mq(z_(e,0,2))&&(2==e.length||"/"===(t=D_(e,2))||"\\"===t||"?"===t||"#"===t)},gq=function(e){return"."===e||"%2e"===K_(e)},yq={},bq={},vq={},wq={},Oq={},Sq={},Cq={},Eq={},Aq={},Rq={},Pq={},Iq={},Nq={},Tq={},xq={},kq={},Mq={},$q={},Dq={},Lq={},jq={},_q=function(e,t,r){var n,i,a,o=O_(e);if(t){if(i=this.parse(o))throw x_(i);this.searchParams=null}else{if(void 0!==r&&(n=new _q(r,!0)),i=this.parse(o,null,n))throw x_(i);(a=N_(new I_)).bindURL(this),this.searchParams=a}};_q.prototype={type:"URL",parse:function(e,t,r){var n,i,a,o,s,u=this,l=t||yq,c=0,d="",f=!1,p=!1,m=!1;for(e=O_(e),t||(u.scheme="",u.username="",u.password="",u.host=null,u.port=null,u.path=[],u.query=null,u.fragment=null,u.cannotBeABaseURL=!1,e=U_(e,aq,"")),e=U_(e,oq,""),n=y_(e);c<=n.length;){switch(i=n[c],l){case yq:if(!i||!L_(H_,i)){if(t)return X_;l=vq;continue}d+=K_(i),l=bq;break;case bq:if(i&&(L_(J_,i)||"+"==i||"-"==i||"."==i))d+=K_(i);else{if(":"!=i){if(t)return X_;d="",l=vq,c=0;continue}if(t&&(u.isSpecial()!=h_(pq,d)||"file"==d&&(u.includesCredentials()||null!==u.port)||"file"==u.scheme&&!u.host))return;if(u.scheme=d,t)return void(u.isSpecial()&&pq[u.scheme]==u.port&&(u.port=null));d="","file"==u.scheme?l=Tq:u.isSpecial()&&r&&r.scheme==u.scheme?l=wq:u.isSpecial()?l=Eq:"/"==n[c+1]?(l=Oq,c++):(u.cannotBeABaseURL=!0,V_(u.path,""),l=Dq)}break;case vq:if(!r||r.cannotBeABaseURL&&"#"!=i)return X_;if(r.cannotBeABaseURL&&"#"==i){u.scheme=r.scheme,u.path=b_(r.path),u.query=r.query,u.fragment="",u.cannotBeABaseURL=!0,l=jq;break}l="file"==r.scheme?Tq:Sq;continue;case wq:if("/"!=i||"/"!=n[c+1]){l=Sq;continue}l=Aq,c++;break;case Oq:if("/"==i){l=Rq;break}l=$q;continue;case Sq:if(u.scheme=r.scheme,i==a_)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=b_(r.path),u.query=r.query;else if("/"==i||"\\"==i&&u.isSpecial())l=Cq;else if("?"==i)u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=b_(r.path),u.query="",l=Lq;else{if("#"!=i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=b_(r.path),u.path.length--,l=$q;continue}u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,u.path=b_(r.path),u.query=r.query,u.fragment="",l=jq}break;case Cq:if(!u.isSpecial()||"/"!=i&&"\\"!=i){if("/"!=i){u.username=r.username,u.password=r.password,u.host=r.host,u.port=r.port,l=$q;continue}l=Rq}else l=Aq;break;case Eq:if(l=Aq,"/"!=i||"/"!=D_(d,c+1))continue;c++;break;case Aq:if("/"!=i&&"\\"!=i){l=Rq;continue}break;case Rq:if("@"==i){f&&(d="%40"+d),f=!0,a=y_(d);for(var h=0;h<a.length;h++){var g=a[h];if(":"!=g||m){var y=fq(g,dq);m?u.password+=y:u.username+=y}else m=!0}d=""}else if(i==a_||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(f&&""==d)return"Invalid authority";c-=y_(d).length+1,d="",l=Pq}else d+=i;break;case Pq:case Iq:if(t&&"file"==u.scheme){l=kq;continue}if(":"!=i||p){if(i==a_||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()){if(u.isSpecial()&&""==d)return Z_;if(t&&""==d&&(u.includesCredentials()||null!==u.port))return;if(o=u.parseHost(d))return o;if(d="",l=Mq,t)return;continue}"["==i?p=!0:"]"==i&&(p=!1),d+=i}else{if(""==d)return Z_;if(o=u.parseHost(d))return o;if(d="",l=Nq,t==Iq)return}break;case Nq:if(!L_(Y_,i)){if(i==a_||"/"==i||"?"==i||"#"==i||"\\"==i&&u.isSpecial()||t){if(""!=d){var b=k_(d,10);if(b>65535)return G_;u.port=u.isSpecial()&&b===pq[u.scheme]?null:b,d=""}if(t)return;l=Mq;continue}return G_}d+=i;break;case Tq:if(u.scheme="file","/"==i||"\\"==i)l=xq;else{if(!r||"file"!=r.scheme){l=$q;continue}if(i==a_)u.host=r.host,u.path=b_(r.path),u.query=r.query;else if("?"==i)u.host=r.host,u.path=b_(r.path),u.query="",l=Lq;else{if("#"!=i){hq(j_(b_(n,c),""))||(u.host=r.host,u.path=b_(r.path),u.shortenPath()),l=$q;continue}u.host=r.host,u.path=b_(r.path),u.query=r.query,u.fragment="",l=jq}}break;case xq:if("/"==i||"\\"==i){l=kq;break}r&&"file"==r.scheme&&!hq(j_(b_(n,c),""))&&(mq(r.path[0],!0)?V_(u.path,r.path[0]):u.host=r.host),l=$q;continue;case kq:if(i==a_||"/"==i||"\\"==i||"?"==i||"#"==i){if(!t&&mq(d))l=$q;else if(""==d){if(u.host="",t)return;l=Mq}else{if(o=u.parseHost(d))return o;if("localhost"==u.host&&(u.host=""),t)return;d="",l=Mq}continue}d+=i;break;case Mq:if(u.isSpecial()){if(l=$q,"/"!=i&&"\\"!=i)continue}else if(t||"?"!=i)if(t||"#"!=i){if(i!=a_&&(l=$q,"/"!=i))continue}else u.fragment="",l=jq;else u.query="",l=Lq;break;case $q:if(i==a_||"/"==i||"\\"==i&&u.isSpecial()||!t&&("?"==i||"#"==i)){if(".."===(s=K_(s=d))||"%2e."===s||".%2e"===s||"%2e%2e"===s?(u.shortenPath(),"/"==i||"\\"==i&&u.isSpecial()||V_(u.path,"")):gq(d)?"/"==i||"\\"==i&&u.isSpecial()||V_(u.path,""):("file"==u.scheme&&!u.path.length&&mq(d)&&(u.host&&(u.host=""),d=D_(d,0)+":"),V_(u.path,d)),d="","file"==u.scheme&&(i==a_||"?"==i||"#"==i))for(;u.path.length>1&&""===u.path[0];)F_(u.path);"?"==i?(u.query="",l=Lq):"#"==i&&(u.fragment="",l=jq)}else d+=fq(i,cq);break;case Dq:"?"==i?(u.query="",l=Lq):"#"==i?(u.fragment="",l=jq):i!=a_&&(u.path[0]+=fq(i,uq));break;case Lq:t||"#"!=i?i!=a_&&("'"==i&&u.isSpecial()?u.query+="%27":u.query+="#"==i?"%23":fq(i,uq)):(u.fragment="",l=jq);break;case jq:i!=a_&&(u.fragment+=fq(i,lq))}c++}},parseHost:function(e){var t,r,n;if("["==D_(e,0)){if("]"!=D_(e,e.length-1))return Z_;if(t=function(e){var t,r,n,i,a,o,s,u=[0,0,0,0,0,0,0,0],l=0,c=null,d=0,f=function(){return D_(e,d)};if(":"==f()){if(":"!=D_(e,1))return;d+=2,c=++l}for(;f();){if(8==l)return;if(":"!=f()){for(t=r=0;r<4&&L_(rq,f());)t=16*t+k_(f(),16),d++,r++;if("."==f()){if(0==r)return;if(d-=r,l>6)return;for(n=0;f();){if(i=null,n>0){if(!("."==f()&&n<4))return;d++}if(!L_(Y_,f()))return;for(;L_(Y_,f());){if(a=k_(f(),10),null===i)i=a;else{if(0==i)return;i=10*i+a}if(i>255)return;d++}u[l]=256*u[l]+i,2!=++n&&4!=n||l++}if(4!=n)return;break}if(":"==f()){if(d++,!f())return}else if(f())return;u[l++]=t}else{if(null!==c)return;d++,c=++l}}if(null!==c)for(o=l-c,l=7;0!=l&&o>0;)s=u[l],u[l--]=u[c+o-1],u[c+--o]=s;else if(8!=l)return;return u}(z_(e,1,-1)),!t)return Z_;this.host=t}else if(this.isSpecial()){if(e=w_(e),L_(nq,e))return Z_;if(t=function(e){var t,r,n,i,a,o,s,u=B_(e,".");if(u.length&&""==u[u.length-1]&&u.length--,(t=u.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(i=u[n]))return e;if(a=10,i.length>1&&"0"==D_(i,0)&&(a=L_(Q_,i)?16:8,i=z_(i,8==a?1:2)),""===i)o=0;else{if(!L_(10==a?tq:8==a?eq:rq,i))return e;o=k_(i,a)}V_(r,o)}for(n=0;n<t;n++)if(o=r[n],n==t-1){if(o>=$_(256,5-t))return null}else if(o>255)return null;for(s=q_(r),n=0;n<r.length;n++)s+=r[n]*$_(256,3-n);return s}(e),null===t)return Z_;this.host=t}else{if(L_(iq,e))return Z_;for(t="",r=y_(e),n=0;n<r.length;n++)t+=fq(r[n],uq);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"==this.scheme},includesCredentials:function(){return""!=this.username||""!=this.password},isSpecial:function(){return h_(pq,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"==this.scheme&&1==t&&mq(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,a=e.port,o=e.path,s=e.query,u=e.fragment,l=t+":";return null!==i?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=sq(i),null!==a&&(l+=":"+a)):"file"==t&&(l+="//"),l+=e.cannotBeABaseURL?o[0]:o.length?"/"+j_(o,"/"):"",null!==s&&(l+="?"+s),null!==u&&(l+="#"+u),l},setHref:function(e){var t=this.parse(e);if(t)throw x_(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"==e)try{return new qq(e.path[0]).origin}catch(e){return"null"}return"file"!=e&&this.isSpecial()?e+"://"+sq(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(O_(e)+":",yq)},getUsername:function(){return this.username},setUsername:function(e){var t=y_(O_(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=fq(t[r],dq)}},getPassword:function(){return this.password},setPassword:function(e){var t=y_(O_(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=fq(t[r],dq)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?sq(e):sq(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Pq)},getHostname:function(){var e=this.host;return null===e?"":sq(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Iq)},getPort:function(){var e=this.port;return null===e?"":O_(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""==(e=O_(e))?this.port=null:this.parse(e,Nq))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+j_(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Mq))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""==(e=O_(e))?this.query=null:("?"==D_(e,0)&&(e=z_(e,1)),this.query="",this.parse(e,Lq)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!=(e=O_(e))?("#"==D_(e,0)&&(e=z_(e,1)),this.fragment="",this.parse(e,jq)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var qq=function(e){var t=m_(this,Vq),r=C_(arguments.length,1)>1?arguments[1]:void 0,n=R_(t,new _q(e,!1,r));s_||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},Vq=qq.prototype,Uq=function(e,t){return{get:function(){return P_(this)[e]()},set:t&&function(e){return P_(this)[t](e)},configurable:!0,enumerable:!0}};if(s_&&(p_(Vq,"href",Uq("serialize","setHref")),p_(Vq,"origin",Uq("getOrigin")),p_(Vq,"protocol",Uq("getProtocol","setProtocol")),p_(Vq,"username",Uq("getUsername","setUsername")),p_(Vq,"password",Uq("getPassword","setPassword")),p_(Vq,"host",Uq("getHost","setHost")),p_(Vq,"hostname",Uq("getHostname","setHostname")),p_(Vq,"port",Uq("getPort","setPort")),p_(Vq,"pathname",Uq("getPathname","setPathname")),p_(Vq,"search",Uq("getSearch","setSearch")),p_(Vq,"searchParams",Uq("getSearchParams")),p_(Vq,"hash",Uq("getHash","setHash"))),f_(Vq,"toJSON",(function(){return P_(this).serialize()}),{enumerable:!0}),f_(Vq,"toString",(function(){return P_(this).serialize()}),{enumerable:!0}),T_){var Fq=T_.createObjectURL,Bq=T_.revokeObjectURL;Fq&&f_(qq,"createObjectURL",c_(Fq,T_)),Bq&&f_(qq,"revokeObjectURL",c_(Bq,T_))}S_(qq,"URL"),o_({global:!0,constructor:!0,forced:!u_,sham:!s_},{URL:qq});var zq=l;Gn({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return zq(URL.prototype.toString,this)}});const Kq=window.console=window.console||{},Wq=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];let Xq,{length:Zq}=Wq;for(;Zq--;)Xq=Wq[Zq],!Kq[Xq]&&(Kq[Xq]=function(){});try{window.document.querySelectorAll(":scope *")}catch(e){["querySelector","querySelectorAll"].forEach((e=>{const t=Element.prototype[e],r=window.document.createElement("div");Element.prototype[e]=function(e){if(!/(?:^|,)\s*:scope/.test(e))return t.call(this,e);const n=Date.now();this.setAttribute("data-scopeid",n);let i=!1;this.parentNode||(r.appendChild(this),i=!0),e=e.replace(/((?:^|,)\s*):scope/g,`$1[data-scopeid="${n}"]`);const a=this.parentNode.querySelectorAll(e);return i&&r.removeChild(this),this.removeAttribute("data-scopeid"),a}}))}function Gq(e,...t){const r=Object.assign(e,...t);return Object.entries(r).reduce(((e,[n,i])=>{if(null==i||!Qq(i))return e;const a=[r,...t].map((e=>(e??{})[n]??{}));return e[n]=Gq({},...a),e}),r)}function Hq(e){return 0===Object.getOwnPropertyNames(e).length}function Jq(e){return null==e}function Yq(e){return Jq(e)||Hq(e)}function Qq(e){return"object"==typeof e&&e.constructor===Object}function eV(e){return null==e||"string"!=typeof e||0===e.trim().length}function tV(e){return"[object String]"===Object.prototype.toString.call(e)}function rV(e,t=0,r=" "){if(!tV(e))throw new TypeError("Expected 'input' to be a string.");if(!Number.isNumeric(t))throw new TypeError("Expected 'count' to be a number.");return 0===t?e:e.replace(/^(?!\s*$)/gm,r.repeat(t))}Number.prototype.padLeft=function(e=2,t="0"){let r=this.toString();for(;r.length<e;)r=t+r;return r},Number.prototype.padRight=function(e=2,t="0"){let r=this.toString();for(;r.length<e;)r+=t;return r},Number.isInt=function(e){return/^(-|\+)?([0-9]+|Infinity)$/.test(e)},Number.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},Number.isValueZero=function(e){return e=e||0,Number.isInt(e)&&0===e},Object.deepAssign=Gq,Object.fakeCast=(e,t)=>"boolean"==typeof e?e:"object"==typeof t?e||t:e||new t,Object.isEmpty=Hq,Object.assertDefaultValue=(e,t,r)=>e?Object.prototype.hasOwnProperty.call(e,t)?(Jq(e[t])&&(e[t]=r),e):(e[t]=r,e):e,Object.isNullOrUndefined=Jq,Object.isNullOrEmpty=Yq,Promise.props=function(e){return Promise.all(Object.values(e)).then((t=>Object.keys(e).reduce(((e,r,n)=>(e[r]=t[n],e)),{})))},String.prototype.escapeXML=function(){return this.replace(/[<>&'"]/g,(e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&apos;";case'"':return"&quot;";default:return e}}))},String.prototype.unescapeXML=function(){return this.replace(/&lt;|&gt;|&amp;|&apos;|&quot;|&#34;|&#38;|&#39;|&#60;|&#62;/g,(e=>{switch(e){case"&#60;":case"&lt;":return"<";case"&#62;":case"&gt;":return">";case"&#38;":case"&amp;":return"&";case"&#39;":case"&apos;":return"'";case"&#34;":case"&quot;":return'"';default:return e}}))},String.isNullOrWhiteSpace=eV,String.isNullOrEmpty=function(e){return null==e||"string"!=typeof e||0===e.length},String.isString=tV;const nV={DELETE:"DELETE",GET:"GET",HEAD:"HEAD",OPTIONS:"OPTIONS",PATCH:"PATCH",POST:"POST",PUT:"PUT"},iV={CSS:"text/css",HTML:"text/html",HTTP:"application/http",JavaScript:"application/javascript",JSON:"application/json",Mixed:"multipart/mixed",XML:"text/xml",TXT:"text/plain"},aV={Continue:100,SwitchingProtocols:101,Processing:102,OK:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,IMUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,URITooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,UnprocessableEntity:422,Locked:423,FailedDependency:424,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HTTPVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,NetworkAuthenticationRequired:511};var oV=Object.freeze({__proto__:null,HttpMethod:nV,MimeType:iV,HttpStatus:aV});const sV={Offline:"offlineAPI",SOAP:"soapAPI",WebAPI:"webAPI"},uV=nV,lV=iV,cV="http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService",dV={Associate:`${cV}/Associate`,Create:`${cV}/Create`,Delete:`${cV}/Delete`,Disassociate:`${cV}/Disassociate`,Execute:`${cV}/Execute`,Retrieve:`${cV}/Retrieve`,RetrieveMultiple:`${cV}/RetrieveMultiple`,Update:`${cV}/Update`},fV={From:1,To:2,CC:3,BCC:4,RequiredAttendee:5,OptionalAttendee:6,Organizer:7,Regarding:8,Owner:9,Resource:10,Customer:11,Partner:12},pV={Create:"Create",Update:"Update",None:"None"},mV={Auto:"Auto",Normal:"Normal",CustomAction:"CustomAction"},hV={All:"All",OneToMany:"Microsoft.Dynamics.CRM.OneToManyRelationshipMetadata",ManyToMany:"Microsoft.Dynamics.CRM.ManyToManyRelationshipMetadata"};var gV=Object.freeze({__proto__:null,API:sV,HttpMethod:uV,MimeType:lV,SoapAction:dV,ParticipationTypeMask:fV,UpsertPrevent:pV,FetchMode:mV,RelationshipType:hV});function yV(e,t,r){if(!t.has(e))throw new TypeError("attempted to "+r+" private field on non-instance");return t.get(e)}function bV(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,yV(e,t,"get"))}function vV(e,t,r){return function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,yV(e,t,"set"),r),r}const wV="00000000-0000-0000-0000-000000000000",OV=/^\s*[{(]?([a-f0-9]{8})-?([a-f0-9]{4})-?([a-f0-9]{4})-?([a-f0-9]{4})-?([a-f0-9]{12})[})]?\s*$/i,SV={N:{left:"",right:"",join:""},B:{left:"{",right:"}",join:"-"},P:{left:"(",right:")",join:"-"},D:{left:"",right:"",join:"-"}},CV=Array.from(Array(256),((e,t)=>`${t<16?"0":""}${t.toString(16)}`));function EV(e){let t,r=null;return null!==e&&(r=e.toLowerCase()),null===(t=OV.exec(r))&&(r=wV,t=OV.exec(wV)),this._parts=t.slice(1),this._parts.join(SV.D.join)}class AV{constructor(e=function(){const e=4294967296*Math.random()>>>0,t=4294967296*Math.random()>>>0,r=4294967296*Math.random()>>>0,n=4294967296*Math.random()>>>0;return`${CV[255&e]+CV[e>>8&255]+CV[e>>16&255]+CV[e>>24&255]}-${CV[255&t]+CV[t>>8&255]}-${CV[t>>16&15|64]+CV[t>>24&255]}-${CV[63&r|128]+CV[r>>8&255]}-${CV[r>>16&255]+CV[r>>24&255]+CV[255&n]+CV[n>>8&255]+CV[n>>16&255]+CV[n>>24&255]}`}()){let t=e;if(e instanceof AV)t=e.toString("D");else if(null===e)t=null;else if("string"!=typeof e)throw new Error("new GUID(...) only accepts other GUID objects, strings, undefined or null");this.guid=t}get guid(){return this._guid}set guid(e){this._guid=EV.call(this,e)}get isValid(){return!this.isEmpty&&OV.test(this._guid)}get isEmpty(){return this._guid===wV}get hash(){return this.toString("N")}equals(e){if(e===this)return!0;if(!(e instanceof AV)){if(null==e)return!1;if("string"==typeof e)return new AV(e).hash===this.hash}return e.hash===this.hash}toString(e="D"){return`${(e=SV[e.toUpperCase()]||SV.D).left}${this._parts.join(e.join)}${e.right}`}static newGuid(){return new AV}static newGuidString(e){return(new AV).toString(e)}static validate(e){return!Object.isNullOrUndefined(e)&&new AV(e).isValid}static get empty(){return new AV(wV)}static get emptyString(){return wV}}const RV={None:"None",SystemRequired:"SystemRequired",ApplicationRequired:"ApplicationRequired",Recommended:"Recommended"},PV={"-1":"None",0:"None",1:"SystemRequired",2:"ApplicationRequired",3:"Recommended"},IV={Boolean:"Boolean",boolean:"Boolean",Customer:"Customer",customer:"Customer",DateTime:"DateTime",datetime:"DateTime",Decimal:"Decimal",decimal:"Decimal",Double:"Double",double:"Double",File:"File",file:"File",Integer:"Integer",integer:"Integer",Lookup:"Lookup",lookup:"Lookup",Memo:"Memo",memo:"Memo",Money:"Money",money:"Money",Owner:"Owner",owner:"Owner",PartyList:"PartyList",partylist:"PartyList",Picklist:"Picklist",picklist:"Picklist",MultiSelectPicklist:"MultiSelectPicklist",multiselectpicklist:"MultiSelectPicklist",State:"State",state:"State",Status:"Status",status:"Status",String:"String",string:"String",Uniqueidentifier:"Uniqueidentifier",uniqueidentifier:"Uniqueidentifier",CalendarRules:"CalendarRules",calendarrules:"CalendarRules",Virtual:"Virtual",virtual:"Virtual",BigInt:"BigInt",bigint:"BigInt",Int32:"Int32",int32:"Int32",ManagedProperty:"ManagedProperty",managedproperty:"ManagedProperty",EntityName:"EntityName",entityname:"EntityName",EntityCollection:"EntityCollection",entitycollection:"EntityCollection",EntityReference:"EntityReference",entityreference:"EntityReference",Entity:"Entity",entity:"Entity",OptionSetValue:"OptionSetValue",optionsetvalue:"OptionSetValue"},NV={18:"BigInt",0:"Boolean",16:"CalendarRules",1:"Customer",2:"DateTime",3:"Decimal",4:"Double",20:"EntityName",5:"Integer",6:"Lookup",19:"ManagedProperty",7:"Memo",8:"Money",9:"Owner",10:"PartyList",11:"Picklist",12:"State",13:"Status",14:"String",15:"Uniqueidentifier",17:"Virtual"},TV={DateOnly:"DateOnly",DateAndTime:"DateAndTime",None:"None",Duration:"Duration",TimeZone:"TimeZone",Language:"Language",Locale:"Locale",Email:"Email",Text:"Text",TextArea:"TextArea",Url:"Url",TickerSymbol:"TickerSymbol",PhoneticGuide:"PhoneticGuide",VersionNumber:"VersionNumber",Phone:"Phone"},xV={DateOnly:"DateOnly",TimeZoneIndependent:"TimeZoneIndependent",UserLocal:"UserLocal"},kV={1:"UserLocal",2:"DateOnly",3:"TimeZoneIndependent"},MV={Sender:1,ToRecipient:2,CCRecipient:3,BccRecipient:4,RequiredAttendee:5,OptionalAttendee:6,Organizer:7,Regarding:8,Owner:9,Resource:10,Customer:11,Partner:12},$V={[MV.Sender]:"from",[MV.ToRecipient]:"to",[MV.CCRecipient]:"cc",[MV.BccRecipient]:"bcc",[MV.RequiredAttendee]:"requiredattendees",[MV.OptionalAttendee]:"optionalattendees",[MV.Organizer]:"organizer",[MV.Resource]:"resources",[MV.Customer]:"customers",[MV.Partner]:"partners"},DV={...$V,[MV.Customer]:"customer",[MV.Partner]:"partner"},LV={from:MV.Sender,to:MV.ToRecipient,cc:MV.CCRecipient,bcc:MV.BccRecipient,requiredattendees:MV.RequiredAttendee,optionalattendees:MV.OptionalAttendee,organizer:MV.Organizer,resources:MV.Resource,customers:MV.Customer,customer:MV.Customer,partners:MV.Partner,partner:MV.Partner},jV=[IV.Lookup,IV.Owner,IV.Customer,IV.EntityReference],_V=[IV.PartyList],qV=[IV.Picklist,IV.OptionSetValue,IV.State,IV.Status],VV=[IV.Integer,IV.BigInt,IV.Decimal,IV.Double,IV.Int32],UV=[IV.Customer];var FV=Object.freeze({__proto__:null,RequiredLevel:RV,RequiredLevelValues:PV,AttributeTypeCode:IV,AttributeTypeCodeValues:NV,Format:TV,Direction:{Input:"Input",Output:"Output"},Behavior:xV,BehaviorValues:kV,ParticipationTypeMask:MV,ParticipationTypeMap:$V,ParticipationTypeMapCampaignResponse:DV,ReverseParticipationTypeMap:LV,ENTITY_REFERENCE_TYPES:jV,PARTY_LIST_TYPES:_V,OPTIONSET_TYPES:qV,NUMBER_TYPES:VV,CUSTOMER_TYPES:UV});function BV(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zV(e,...t){return`[ORBIS.Core] ${e}\r\n${rV(t.join("\r\n"),1,"\t")}\r\n`}function KV(e,...t){console.debug(zV(e,...t))}function WV(e,...t){console.warn(zV(e,...t))}function XV(e,...t){console.error(zV(e,...t))}function ZV(e,t,r={},{separator:n=".",applyFunction:i=!1}={}){return e.split(n).reduce(((e,t,n,a)=>{const o=t.trim();return e[o]=e[o]||(n===a.length-1?"function"==typeof r&&!0===i?r()||{}:r:{}),e[o]}),t||window)}function GV(e,t,r=null,{separator:n=".",autoExecute:i=!1}={}){if(String.isNullOrWhiteSpace(e))return console.error("ORBIS.Namespace.extract() requires a namespace but supplied value was whitespace or null. Returning default value instead."),r;let a=t||window;!0===i&&"function"==typeof a&&(a=a());const o=e.split(n);for(let e=0,{length:t}=o;e<t&&!Object.isNullOrUndefined(a);e++){a=a[o[e].trim()],!0===i&&"function"==typeof a&&(a=a())}return Object.isNullOrUndefined(a)?r:a}function HV(e,t,{separator:r="."}={}){let n=t||window;"function"==typeof n&&(n=n());const i=e.split(r).map((e=>e.trim())),a=i.slice(0,i.length-1).join(r),o=""!==a?GV(a,n,null,{separator:r}):n;Object.isNullOrUndefined(o)||delete o[i.slice(-1)]}var JV={define:ZV,extract:GV,delete:HV,del:HV};const YV=function(e,t,...r){const n=/\$\{((\w*(\.\w+)*)|(\w*(\.\w+)*\[\d+\])+?)\}/gi;let i={};for(let e=0;e<r.length;e++)"function"==typeof r[e]&&(r[e]=r[e]()),"object"==typeof r[e]?i=Object.assign(i,r[e]):i[e]=r[e];let a=e||"",o="";for(;a!==o;)o=a,a=o.replace(n,((e,r)=>GV(r,i,!0===t?"":e,{autoExecute:!0})));return a};function QV(e,...t){return YV(e,!0,...t)}function eU(e,...t){return YV(e,!1,...t)}var tU=Object.freeze({__proto__:null,evaluate:QV,evaluateIfFound:eU,evaluateIf:function(e,t,...r){return t?!0===t()?QV(e,...r):"":QV(e,...r)}});const rU=/(?:\(.*?\)(?![^[\]]*])|[+-])(?![^[\]]*])/,nU=/\+(?![^[\]]*])/,iU=/[\d#,.]+/,aU=/[+-]/g,oU=/\(/g,sU=/\)/g,uU=/[\d#,.]+/g;class lU{static registerDelimiters(e,t,r,n=!1){if(Number.isNumeric(e)&&(e=e.toString()),String.isNullOrWhiteSpace(e))throw new Error('Missing required parameter "id" in NumberHelper.registerDelimiters()');lU.delimiters[e]={decimal:t,thousand:r},n&&lU.selectDelimiters(e)}static selectDelimiters(e){const t=Object.isNullOrUndefined(e);!Object.isNullOrUndefined(lU.activeDelimiters)&&t||(t||String.isNullOrWhiteSpace(e)?e="1033":Number.isNumeric(e)?e=e.toString():Object.isNullOrUndefined(lU.delimiters[e])&&(WV("NumberHelper",`No delimiters found for ID ${e}. Using default delimiters for ID 1033 instead.`),e="1033"),lU.activeDelimiters=lU.delimiters[e])}constructor(e,t){e=e||0,lU.selectDelimiters(t);const r="string"!=typeof e&&Number.isNumeric(e);this.internalValue=r?e:lU.parse(e.toString())}static parse(e){const{decimal:t}=lU.activeDelimiters;"."!==t&&(e=e.replace(/\./g,"").replace(t,"."));return((e.split("-").length+Math.min(e.split("(").length-1,e.split(")").length-1))%2==0?-1:1)*Number(e.replace(/[^0-9.]/g,""))}value(){return this.internalValue}static getDelimiterObject(e){const t=(e=e||"").split("."),r=t.length>1,n=t[0].split(","),i=n.length>1;return{decimal:{use:r,precision:r?t[1].length:0},thousand:{use:i,groupSize:i?n[0].length:0,lastGroupSize:n[n.length-1].length}}}static buildThousandsRegEx(e,t){let r="";if(e>0){let n="";e!==t&&(n=`\\d{${t=Math.abs(t-e)}}`),r=`(?=(?:\\d{${e}})+${n}$)`}else r=`(?=\\d{${t}}$)`;return new RegExp(`(\\d)${r}`,"g")}static getNumberFormat(e){let t;return null!==(t=iU.exec(e))&&t[0]||null}formatValue(e){if(null==(e=lU.getNumberFormat(e)))return"Invalid format.";const t=this.internalValue||0,r=lU.getDelimiterObject(e),{use:n,precision:i}=r.decimal;let a=Math.abs(t).toFixed(n?i:0);const[o,s=0]=a.split(".");if(a=o,r.thousand.use){const{groupSize:e,lastGroupSize:t}=r.thousand,n=lU.activeDelimiters.thousand;a=o.replace(lU.buildThousandsRegEx(e,t),`$1${n}`)}if(r.decimal.use){a+=`${lU.activeDelimiters.decimal}${s}`}return a}format(e){e=e||lU.defaultFormatString;const t=rU.test(e),r=nU.test(e),n=this.internalValue<0,i=this.formatValue(e),a=[];return(e=QV((e=eU(e=(e=e.replace(/\[([^]*?)\]/gm,((e,t)=>(a.push(t),"??")))).replace(uU,"${numberFormat}").replace(aU,"${sign}").replace(oU,"${signOpen}").replace(sU,"${signClose}"),{sign:n&&t?"-":r?"+":"",signOpen:n&&t?"(":"",signClose:n&&t?")":""})).trim(),{numberFormat:i})).replace(/\?\?/g,(()=>a.shift()))}}BV(lU,"defaultFormatString","-#"),BV(lU,"delimiters",Object.assign(Object.create(null),{1033:{decimal:".",thousand:","}})),BV(lU,"activeDelimiters",lU.delimiters[1033]);const cU=(e,t)=>e.length===t.length&&e.every(((e,r)=>Array.isArray(e)&&Array.isArray(t[r])?cU(e,t[r]):e===t[r]));function dU(e,{timeout:t=null,keepLast:r=!1}={}){const n=new Map;return(...i)=>{const a=((e,t)=>{if(!(e.size<=0))return e.has(t)?t:Array.from(e.keys()).find((e=>cU(e,t)))})(n,i);if(void 0===a){const a=e.apply(this,i);return!0===r&&n.clear(),n.set(i,a),null!=t&&window.setTimeout((()=>{n.delete(i)}),t),a}return n.get(a)}}const fU={Days:"Days",Months:"Months",Years:"Years",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds"},pU={Date:"Date",Day:"Day",FullYear:"FullYear",Hours:"Hours",Milliseconds:"Milliseconds",Minutes:"Minutes",Month:"Month",Seconds:"Seconds"},mU={ClientTime:"ClientTime",UserTime:"UserTime",UTC:"UTC"},hU={ISO8601:"ISO8601",ISO8601DateOnly:"ISO8601DateOnly",JSON:"JSON"},gU={[hU.ISO8601]:"yyyy-MM-ddTHH:mm:ssK",[hU.ISO8601DateOnly]:"yyyy-MM-dd"};var yU=Object.freeze({__proto__:null,DateUnit:fU,DateElement:pU,DateZone:mU,DateFormat:hU,DateMask:gU});function bU(e,t){wU(e,t),t.add(e)}function vU(e,t,r){wU(e,t),t.set(e,r)}function wU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OU(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var SU=new WeakMap,CU=new WeakMap,EU=new WeakMap,AU=new WeakSet,RU=new WeakMap,PU=new WeakMap,IU=new WeakSet;class NU{constructor(e){bU(this,IU),bU(this,AU),vU(this,SU,{writable:!0,value:null}),vU(this,CU,{writable:!0,value:{}}),vU(this,EU,{writable:!0,value:null}),vU(this,RU,{writable:!0,value:!1}),vU(this,PU,{writable:!0,value:new Map}),vV(this,SU,e?.organizationSettings)}setOrgSettings(e){vV(this,CU,e)}get baseCurrencyName(){return OU(this,AU,TU).call(this).currencyName??OU(this,IU,xU).call(this,"baseCurrencyName","Euro")}get baseCurrencyCode(){return OU(this,AU,TU).call(this).currencyCode??OU(this,IU,xU).call(this,"baseCurrencyCode","EUR")}get baseCurrencyPrecision(){return OU(this,AU,TU).call(this).currencyPrecision??OU(this,IU,xU).call(this,"baseCurrencyPrecision",2)}get baseCurrencySymbol(){return OU(this,AU,TU).call(this).currencySymbol??OU(this,IU,xU).call(this,"baseCurrencySymbol","€")}get currencyDisplayOption(){return OU(this,AU,TU).call(this).currencyDisplayOption??OU(this,IU,xU).call(this,"currencyDisplayOption",0)}get dateFormatString(){return bV(this,CU).dateFormatString??OU(this,IU,xU).call(this,"dateFormatString","M/d/yyyy")}get dateFormattedString(){return bV(this,CU).dateFormatString.replace(/\//g,this.dateSeparator)??OU(this,IU,xU).call(this,"dateFormattedString","M/d/yyyy")}get dateSeparator(){return bV(this,CU).dateSeparator??OU(this,IU,xU).call(this,"dateSeparator","/")}get isLoaded(){return bV(this,RU)}set isLoaded(e){vV(this,RU,e)}get pricingDecimalPrecision(){return bV(this,CU).pricingDecimalPrecision??OU(this,IU,xU).call(this,"pricingDecimalPrecision",2)}get timeFormatString(){return bV(this,CU).timeFormatString??OU(this,IU,xU).call(this,"timeFormatString","h:mm tt")}get timeSeparator(){return bV(this,CU).timeSeparator??OU(this,IU,xU).call(this,"timeSeparator",":")}get isAutoSaveEnabled(){return bV(this,CU)?.isAutoSaveEnabled??bV(this,SU).isAutoSaveEnabled??!0}get organizationId(){return bV(this,CU)?.organizationId??bV(this,SU).organizationId??null}get uniqueName(){return bV(this,CU)?.uniqueName??bV(this,SU).uniqueName??null}get languageId(){return bV(this,CU)?.languageId??OU(this,IU,xU).call(this,"languageId",1033)}}function TU(){return null!=bV(this,EU)||vV(this,EU,{currencyCode:bV(this,CU).currencyCode??"EUR",currencyPrecision:bV(this,CU).currencyPrecision??2,currencyName:bV(this,CU).currencyName??"Euro",currencySymbol:bV(this,CU).currencySymbol??"€",currencyDisplayOption:bV(this,CU).currencyDisplayOption??0,...bV(this,CU).currencyById?.[bV(this,CU).transactionCurrencyId]??{}}),bV(this,EU)}function xU(e,t,r=!0){return r&&bV(this,PU).set(e,!0)||(WV("OrganizationSettings",`No value for ${e} found. Returning default value.`,"It's possible, that OrganizationSettings were not loaded properly through 'ORBIS.Core.Context.UserSettings.load()'"),r&&bV(this,PU).set(e,!0)),t}function kU(){let e=xF?.OrganizationSettings?.uniqueName;return""!==e&&null!=e||(e=xF?.Xrm?.organizationSettings?.uniqueName),e?e.toLowerCase():""}function MU(e,{applyOrganizationName:t=!0,applyLanguage:r=!1,rootName:n="ORBIS"}={}){return["[",[!0===t?kU():null,!0===r?xF.UserSettings.languageId:null,n].filter(Boolean).join("."),"] ",e??""].join("")}class $U{constructor(e){BV(this,"storageType",null),this.storageType=e}get(e,t={}){const r=MU(e,t);try{return window[this.storageType].getItem(r)}catch(e){return console.error(`Error in ${this.storageType}.get, in parsing root, key ${r}: ${e.message}`),null}}getKeys(e,t={}){const r=Object.keys(window[this.storageType]);if(null==e)return r;const n=MU("",t);return r.filter((t=>e.test(t)&&(""===n||t.startsWith(n)))).map((e=>e.replace(n,"")))}getJSON(e,t={}){try{const r=this.get(e,t);return null!=r?JSON.parse(r):r}catch(t){return console.error(`Error in ${this.storageType}.getJSON, in parsing key ${e}: ${t.message}`),null}}set(e,t,r={}){if(null==t)return this.remove(e,r);const n=MU(e,r);try{return window[this.storageType].setItem(n,t),!0}catch(e){return console.error(`Error in ${this.storageType}.set for key "${n}", seting the value "${t}"`),!1}}setJSON(e,t,r={}){const n=null!=t?JSON.stringify(t):t;return this.set(e,n,r)}remove(e,t={}){const r=MU(e,t);try{return window[this.storageType].removeItem(r),!0}catch(e){return console.error(`Error in remove from ${this.storageType} for key: ${r}`),!1}}}const DU=new $U("localStorage"),LU=new $U("sessionStorage");var jU=Object.freeze({__proto__:null,LocalStorage:DU,SessionStorage:LU});function _U(e,t){VU(e,t),t.add(e)}function qU(e,t,r){VU(e,t),t.set(e,r)}function VU(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UU(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}const FU=Object.create(null),BU="Context-UserSettings",zU={rootName:"ORBIS.Core",applyLanguage:!0},KU=["amdesignator","currencyformatcode","dateformatstring","dateseparator","decimalsymbol","localeid","negativecurrencyformatcode","negativeformatcode","numbergroupformat","numberseparator","paginglimit","pmdesignator","pricingdecimalprecision","showweeknumber","timeformatstring","timeseparator","timezonebias","timezonecode","timezonedaylightbias","timezonedaylightday","timezonedaylightdayofweek","timezonedaylighthour","timezonedaylightminute","timezonedaylightmonth","timezonedaylightsecond","timezonedaylightyear","timezonestandardbias","timezonestandardday","timezonestandarddayofweek","timezonestandardhour","timezonestandardminute","timezonestandardmonth","timezonestandardsecond","timezonestandardyear","uilanguageid","workdaystarttime","workdaystoptime"],WU=["amdesignator","currencydisplayoption","dateformatstring","dateseparator","pmdesignator","pricingdecimalprecision","timeformatstring","timeseparator"],XU=["currencyprecision","currencysymbol","isocurrencycode"];const ZU=dU((e=>{const t=function(e){if(null!=e)return qF(e)?e:tV(e)?VF.parse(e):void 0}(e);if(null!=t)return{hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),year:t.getFullYear()}})),GU=(e,...t)=>{const r=GV(e,...t);return null==r&&KV("UserSettings",`The property at '${e}' was not found.`),r};var HU=new WeakMap,JU=new WeakMap,YU=new WeakMap,QU=new WeakMap,eF=new WeakMap,tF=new WeakMap,rF=new WeakSet,nF=new WeakSet,iF=new WeakSet,aF=new WeakMap,oF=new WeakSet,sF=new WeakSet,uF=new WeakSet,lF=new WeakMap,cF=new WeakMap,dF=new WeakSet,fF=new WeakMap,pF=new WeakSet;function mF(e,t,r,n,i){return UU(this,nF,hF).call(this,e)??UU(this,iF,gF).call(this,t)??UU(this,oF,yF).call(this,r,n)??UU(this,sF,bF).call(this,i)}function hF(e){if(null!=e)return GU(e,bV(this,JU),void 0,{autoExecute:!0})}function gF(e){if(null!=e)return GU(e,bV(this,HU).organizationSettings,void 0,{autoExecute:!0})}function yF(e,t){if(null==e)return;if(null==bV(this,aF)&&(vV(this,aF,bV(this,JU)?._clientApiExecutor?._store?.getState()),null==bV(this,aF)))return void WV("UserSettings","Could not get internal Dynamics store. Maybe a possible change.");let r;if(e.includes("[]")){const t=e.split("[]"),n=GV(t[0],bV(this,aF),void 0,{autoExecute:!0});if(null==n)return void console.debug("not found");r=GU(t[1],n[0],void 0,{autoExecute:!0})}else r=GU(e,bV(this,aF),void 0,{autoExecute:!0});return"function"==typeof t?t(r):r}async function bF(e){if(null==e)return;const t=LU.getJSON(BU,zU);if(null!=t)return GU(e,t,void 0,{separator:"/"});const r=await bV(this,lF).call(this);if(null!=r)return LU.setJSON(BU,r,zU),GU(e,r,void 0,{separator:"/"});console.debug("not found")}async function vF(){if(xF.isOffline())return;const e=['<fetch no-lock="true">','<entity name="usersettings">',KU.map((e=>`<attribute name="${e}"/>`)).join(""),"<filter>",'<condition attribute="systemuserid" operator="eq-userid"/>',"</filter>",'<link-entity name="systemuser" from="systemuserid" to="systemuserid" link-type="inner">','<link-entity name="organization" from="organizationid" to="organizationid" alias="orgsettings">',WU.map((e=>`<attribute name="${e}"/>`)).join(""),'<link-entity name="transactioncurrency" from="transactioncurrencyid" to="basecurrencyid" link-type="outer" alias="basecurrency">','<attribute name="transactioncurrencyid"/>',XU.map((e=>`<attribute name="${e}"/>`)).join(""),"</link-entity>","</link-entity>","</link-entity>",'<link-entity name="transactioncurrency" from="transactioncurrencyid" to="transactioncurrencyid" link-type="outer" alias="currency">','<attribute name="transactioncurrencyid"/>',XU.map((e=>`<attribute name="${e}"/>`)).join(""),"</link-entity>","</entity>","</fetch>"].join("");try{const{data:t}=await JH.fetch(e);if(GV("values.length",t,0)<=0)throw new Error("UserSettings fetch result is empty.");const[r]=t.values;return r}catch(e){XV("Context.UserSettings","Retrieving User Settings failed.")}}function wF(){return null!=bV(this,cF)||vV(this,cF,{currencyCode:bV(this,QU).currencyCode??bV(this,YU).baseCurrencyCode,currencyPrecision:bV(this,QU).currencyPrecision??bV(this,YU).baseCurrencyPrecision,currencyName:bV(this,QU).currencyName??bV(this,YU).baseCurrencyName,currencySymbol:bV(this,QU).currencySymbol??bV(this,YU).baseCurrencySymbol,...bV(this,QU).currencyById?.[bV(this,QU).transactionCurrencyId]??{}}),bV(this,cF)}function OF(e,t,r=!0){return r&&null!=bV(this,fF).get(e)||(WV("UserSettings",`No value for ${e} found. Returning default value.`,"It's possible, that UserSettings were not loaded properly with 'ORBIS.Core.Context.UserSettings.load()'"),r&&bV(this,fF).set(e,!0)),t}function SF(e){return null==e||0===e?e=>e:t=>(t??0)/e}function CF(e){return t=>(t??0)+(e??0)}var EF=Object.freeze({__proto__:null,Client:{Web:"Web",Outlook:"Outlook",Mobile:"Mobile"},ClientState:{Online:"Online",Offline:"Offline"},FormFactor:{Unknown:0,Desktop:1,Tablet:2,Phone:3}});let AF=!1,RF=NF();const PF=new class{constructor(e){_U(this,pF),_U(this,dF),_U(this,uF),_U(this,sF),_U(this,oF),_U(this,iF),_U(this,nF),_U(this,rF),qU(this,HU,{writable:!0,value:null}),qU(this,JU,{writable:!0,value:null}),qU(this,YU,{writable:!0,value:null}),qU(this,QU,{writable:!0,value:{}}),qU(this,eF,{writable:!0,value:[{prop:"amDesignator",us:"dateFormattingInfo.AMDesignator",store:"user.userSettings.dateFormatInfo.AMDesignator",request:"amdesignator"},{prop:"currencyById",store:"user.userSettings.transactionCurrencyById"},{prop:"currencyCode",request:"currency.isocurrencycode"},{prop:"currencyDecimalPrecision",store:"user.userSettings.numberFormatInfo.CurrencyDecimalDigits",request:"pricingdecimalprecision"},{prop:"currencyFormatCode",store:"user.userSettings.numberFormatInfo.CurrencyPositivePattern",request:"currencyformatcode"},{prop:"currencyName",us:"transactionCurrency.name"},{prop:"currencyPrecision",request:"currency.currencyprecision"},{prop:"currencySymbol",request:"currency.currencysymbol"},{prop:"dateFormatString",us:"dateFormattingInfo.ShortDatePattern",store:"user.userSettings.dateFormatInfo.ShortDatePattern",request:"dateformatstring"},{prop:"dateSeparator",us:"dateFormattingInfo.DateSeparator",store:"user.userSettings.dateFormatInfo.DateSeparator",request:"dateseparator"},{prop:"decimalSymbol",store:"user.userSettings.numberFormatInfo.NumberDecimalSeparator",request:"decimalsymbol"},{prop:"localTimezoneOffsetMinutes",us:"getTimeZoneOffsetMinutes"},{prop:"negativeCurrencyFormatCode",store:"user.userSettings.numberFormatInfo.CurrencyNegativePattern",request:"negativecurrencyformatcode"},{prop:"negativeFormatCode",store:"user.userSettings.numberFormatInfo.NumberNegativePattern",request:"negativeformatcode"},{prop:"numberGroupFormat",store:"user.userSettings.numberFormatInfo.NumberGroupSizes",request:"numbergroupformat"},{prop:"numberSeparator",store:"user.userSettings.numberFormatInfo.NumberGroupSeparator",request:"numberseparator"},{prop:"orgsettings.currencyById",store:"organization.organizationSettings.transactionCurrencyById"},{prop:"orgsettings.currencyCode",request:"basecurrency.isocurrencycode"},{prop:"orgsettings.currencyPrecision",request:"basecurrency.currencyprecision"},{prop:"orgsettings.currencySymbol",request:"basecurrency.currencysymbol"},{prop:"orgsettings.isAutoSaveEnabled",os:"isAutoSaveEnabled",store:"organization.organizationSettings.isAutoSaveEnabled"},{prop:"orgsettings.languageId",os:"languageId",store:"organization.organizationsettings.orgCultureInfoLCID",request:"localeid"},{prop:"orgsettings.organizationId",os:"organizationId",store:"organization.organizationId"},{prop:"orgsettings.pricingDecimalPrecision",store:"organization.organizationSettings.pricingDecimalPrecision",request:"orgsettings.pricingdecimalprecision"},{prop:"orgsettings.transactionCurrencyId",os:"baseCurrencyId",store:"organization.organizationSettings.baseCurrencyId.guid",request:"basecurrency.transactioncurrencyid"},{prop:"orgsettings.uniqueName",os:"uniqueName",store:"organization.organizationSettings.organizationUniqueName"},{prop:"pagingLimit",us:"pagingLimit",store:"user.userSettings.recordsPerPage",request:"paginglimit"},{prop:"pmDesignator",us:"dateFormattingInfo.PMDesignator",store:"user.userSettings.dateFormatInfo.PMDesignator",request:"pmdesignator"},{prop:"roles",us:"roles",store:"user.userRolesToNames"},{prop:"showWeekNumber",us:"dateFormattingInfo.CalendarWeekRule",store:"user.userSettings.dateFormatInfo.CalendarWeekRule",storeFn:e=>1===e,request:"showweeknumber"},{prop:"timeFormatString",us:"dateFormattingInfo.ShortTimePattern",store:"user.userSettings.dateFormatInfo.ShortTimePattern",request:"timeformatstring"},{prop:"timeSeparator",us:"dateFormattingInfo.TimeSeparator",store:"user.userSettings.dateFormatInfo.TimeSeparator",request:"timeseparator"},{prop:"timeZoneBias",store:"user.userSettings.timeZoneUtcOffsetMinutes",storeFn:e=>-e,request:"timezonebias"},{prop:"timeZoneCode",request:"timezonecode"},{prop:"timeZoneDaylightBias",store:"user.userSettings.timeZoneAdjusters[]delta",storeFn:SF(-6e4),request:"timezonedaylightbias"},{prop:"timeZoneDaylightDay",store:"user.userSettings.timeZoneAdjusters[]daylightStart.week",request:"timezonedaylightday"},{prop:"timeZoneDaylightDayOfWeek",store:"user.userSettings.timeZoneAdjusters[]daylightStart.dayOfWeek",request:"timezonedaylightdayofweek"},{prop:"timeZoneDaylightHour",store:"user.userSettings.timeZoneAdjusters[]daylightStart.timeOfDay",storeFn:e=>ZU(e)?.hour,request:"timezonedaylighthour"},{prop:"timeZoneDaylightMinute",store:"user.userSettings.timeZoneAdjusters[]daylightStart.timeOfDay",storeFn:e=>ZU(e)?.minute,request:"timezonedaylightminute"},{prop:"timeZoneDaylightMonth",store:"user.userSettings.timeZoneAdjusters[]daylightStart.month",storeFn:CF(1),request:"timezonedaylightmonth"},{prop:"timeZoneDaylightSecond",store:"user.userSettings.timeZoneAdjusters[]daylightStart.timeOfDay",storeFn:e=>ZU(e)?.second,request:"timezonedaylightsecond"},{prop:"timeZoneDaylightYear",store:"user.userSettings.timeZoneAdjusters[]daylightStart.timeOfDay",storeFn:e=>ZU(e)?.year,request:"timezonedaylightyear"},{prop:"timeZoneStandardBias",request:"timezonestandardbias"},{prop:"timeZoneStandardDay",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.week",request:"timezonestandardday"},{prop:"timeZoneStandardDayOfWeek",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.dayOfWeek",request:"timezonestandarddayofweek"},{prop:"timeZoneStandardHour",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.timeOfDay",storeFn:e=>ZU(e)?.hour,request:"timezonestandardhour"},{prop:"timeZoneStandardMinute",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.timeOfDay",storeFn:e=>ZU(e)?.minute,request:"timezonestandardminute"},{prop:"timeZoneStandardMonth",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.month",storeFn:CF(1),request:"timezonestandardmonth"},{prop:"timeZoneStandardSecond",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.timeOfDay",storeFn:e=>ZU(e)?.second,request:"timezonestandardsecond"},{prop:"timeZoneStandardYear",store:"user.userSettings.timeZoneAdjusters[]daylightEnd.timeOfDay",storeFn:e=>ZU(e)?.year,request:"timezonestandardyear"},{prop:"transactionCurrencyId",us:"transactionCurrencyId",store:"user.userSettings.transactionCurrencyId.guid",request:"currency.transactioncurrencyid"},{prop:"userId",us:"userId",store:"user.userId.guid"},{prop:"userName",us:"userName",store:"user.userDisplayName"},{prop:"workdayStartTime",store:"user.userSettings.workDayStartTime",request:"workdaystarttime"},{prop:"workdayStopTime",request:"workdaystoptime"}]}),qU(this,tF,{writable:!0,value:!1}),qU(this,aF,{writable:!0,value:null}),qU(this,lF,{writable:!0,value:dU(UU(this,uF,vF))}),qU(this,cF,{writable:!0,value:null}),qU(this,fF,{writable:!0,value:new Map}),vV(this,HU,e),vV(this,JU,e.userSettings),vV(this,YU,new NU(e))}async load(e=!1){return!0===bV(this,tF)&&!0!==e||(!0===e&&!0===this.isLoaded&&(LU.remove(BU,zU),vV(this,lF,dU(UU(this,uF,vF))),vV(this,aF,null)),vV(this,QU,await Promise.props(bV(this,eF).filter((({prop:e})=>!e.startsWith("orgsettings."))).reduce(((e,{prop:t,request:r,store:n,storeFn:i,us:a,os:o})=>({...e,[t]:UU(this,rF,mF).call(this,a,o,n,i,r)})),{}))),bV(this,YU).setOrgSettings(await Promise.props(bV(this,eF).filter((({prop:e})=>e.startsWith("orgsettings."))).reduce(((e,{prop:t,request:r,store:n,storeFn:i,us:a,os:o})=>({...e,[t.split(".")[1]]:UU(this,rF,mF).call(this,a,o,n,i,r)})),{}))),lU.registerDelimiters(this.localeId,this.decimalSymbol,this.numberSeparator,!0),vV(this,tF,!0),bV(this,YU).isLoaded=!0),this}get isLoaded(){return bV(this,tF)}get currencyDecimalPrecision(){return UU(this,dF,wF).call(this).currencyPrecision}get currencySymbol(){return UU(this,dF,wF).call(this).currencySymbol}get isoCurrencyCode(){return UU(this,dF,wF).call(this).currencyCode}get currencyFormatCode(){return bV(this,QU).currencyFormatCode}get negativeCurrencyFormatCode(){return bV(this,QU).negativeCurrencyFormatCode}get pricingDecimalPrecision(){return bV(this,QU).pricingDecimalPrecision??bV(this,YU).pricingDecimalPrecision??2}get dateFormatString(){return bV(this,QU).dateFormatString??UU(this,pF,OF).call(this,"dateFormatString","M/d/yyyy")}get dateFormattedString(){return bV(this,QU).dateFormatString.replace(/\//g,this.dateSeparator)??"M.d.yyyy"}get dateSeparator(){return bV(this,QU).dateSeparator??UU(this,pF,OF).call(this,"dateSeparator",".")}get showWeekNumber(){return bV(this,QU).showWeekNumber??UU(this,pF,OF).call(this,"showWeekNumber",!1)}get decimalSymbol(){return bV(this,QU).decimalSymbol??UU(this,pF,OF).call(this,"decimalSymbol",",")}get numberSeparator(){return bV(this,QU).numberSeparator??UU(this,pF,OF).call(this,"numberSeparator",".")}get negativeFormatCode(){return bV(this,QU).negativeFormatCode??UU(this,pF,OF).call(this,"negativeFormatCode",1)}get numberGroupFormat(){return Array.isArray(bV(this,QU).numberGroupFormat)?bV(this,QU).numberGroupFormat.length<=0?UU(this,pF,OF).call(this,"numberGroupFormat",3):bV(this,QU).numberGroupFormat.join(","):bV(this,QU).numberGroupFormat??UU(this,pF,OF).call(this,"numberGroupFormat",3)}get localeId(){return bV(this,YU).languageId??UU(this,pF,OF).call(this,"localeId",1033)}get uiLanguageId(){return this.languageId}get languageId(){return bV(this,JU).languageId??UU(this,pF,OF).call(this,"languageId",1033)}get amDesignator(){return bV(this,QU).amDesignator??UU(this,pF,OF).call(this,"amDesignator","AM")}get pmDesignator(){return bV(this,QU).pmDesignator??UU(this,pF,OF).call(this,"pmDesignator","PM")}get timeFormatString(){return bV(this,QU).timeFormatString??UU(this,pF,OF).call(this,"timeFormatString","hh:mm tt")}get timeSeparator(){return bV(this,QU).timeSeparator??UU(this,pF,OF).call(this,"timeSeparator",":")}get localTimeZoneOffsetMinutes(){return null==bV(this,QU).localTimezoneOffsetMinutes?bV(this,JU).getTimeZoneOffsetMinutes()??(new Date).getTimeZoneOffsetMinutes():bV(this,QU).localTimezoneOffsetMinutes}get timeZoneBias(){return bV(this,QU).timeZoneBias??UU(this,pF,OF).call(this,"timeZoneBias",-60)}get timeZoneCode(){return bV(this,QU).timeZoneCode??UU(this,pF,OF).call(this,"timeZoneCode",110)}get timeZoneDaylightBias(){return bV(this,QU).timeZoneDaylightBias??UU(this,pF,OF).call(this,"timeZoneDaylightBias",-60)}get timeZoneDaylightDay(){return bV(this,QU).timeZoneDaylightDay??UU(this,pF,OF).call(this,"timeZoneDaylightDay",5)}get timeZoneDaylightDayOfWeek(){return bV(this,QU).timeZoneDaylightDayOfWeek??UU(this,pF,OF).call(this,"timeZoneDaylightDayOfWeek",0)}get timeZoneDaylightHour(){return bV(this,QU).timeZoneDaylightHour??UU(this,pF,OF).call(this,"timeZoneDaylightHour",2)}get timeZoneDaylightMinute(){return bV(this,QU).timeZoneDaylightMinute??UU(this,pF,OF).call(this,"timeZoneDaylightMinute",0)}get timeZoneDaylightMonth(){return bV(this,QU).timeZoneDaylightMonth??UU(this,pF,OF).call(this,"timeZoneDaylightMonth",3)}get timeZoneDaylightSecond(){return bV(this,QU).timeZoneDaylightSecond??UU(this,pF,OF).call(this,"timeZoneDaylightSecond",0)}get timeZoneDaylightYear(){return bV(this,QU).timeZoneDaylightYear??UU(this,pF,OF).call(this,"timeZoneDaylightYear",0)}get timeZoneStandardBias(){return bV(this,QU).timeZoneStandardBias??UU(this,pF,OF).call(this,"timeZoneStandardBias",0)}get timeZoneStandardDay(){return bV(this,QU).timeZoneStandardDay??UU(this,pF,OF).call(this,"timeZoneStandardDay",5)}get timeZoneStandardDayOfWeek(){return bV(this,QU).timeZoneStandardDayOfWeek??UU(this,pF,OF).call(this,"timeZoneStandardDayOfWeek",0)}get timeZoneStandardHour(){return bV(this,QU).timeZoneStandardHour??UU(this,pF,OF).call(this,"timeZoneStandardMinute",3)}get timeZoneStandardMinute(){return bV(this,QU).timeZoneStandardMinute??UU(this,pF,OF).call(this,"timeZoneStandardMinute",0)}get timeZoneStandardMonth(){return bV(this,QU).timeZoneStandardMonth??UU(this,pF,OF).call(this,"timeZoneStandardMonth",10)}get timeZoneStandardSecond(){return bV(this,QU).timeZoneStandardSecond??UU(this,pF,OF).call(this,"timeZoneStandardSecond",0)}get timeZoneStandardYear(){return bV(this,QU).timeZoneStandardYear??UU(this,pF,OF).call(this,"timeZoneStandardYear",0)}get utcToCrmTimeOffset(){return this.timeZoneBias+this.timeZoneDaylightBias}get pagingLimit(){return bV(this,QU).pagingLimit??UU(this,pF,OF).call(this,"pagingLimit",50)}get workdayStartTime(){return bV(this,QU).workdayStartTime??UU(this,pF,OF).call(this,"workdayStartTime","08:00")}get workdayStopTime(){return bV(this,QU).workdayStopTime??UU(this,pF,OF).call(this,"workdayStopTime","17:00")}get userId(){return eV(bV(this,QU).userId)?bV(this,JU).userId??AV.emptyString:new AV(bV(this,QU).userId).toString("D")}get userName(){return bV(this,QU).userName??bV(this,JU).userId??""}get securityRoles(){const{roles:e}=bV(this,QU);return null==e?bV(this,JU).securityRoles??[]:"function"==typeof e?.get?e.get().map((e=>e.id)):Object.keys(e)}get OrganizationSettings(){return bV(this,YU)}calculateCutoverDates(e){if(Object.hasOwn(FU,e))return FU[e];const t=(t,r,n,i,a,o,s)=>{if(n<1||n>5)return null;let u=new Date(e,t-1,1,12);const l=u.getDay();l>r?u=VF.add(u,7-l+r,fU.Days):l<r&&(u=VF.add(u,r-l,fU.Days));let c=new Date(u.valueOf());for(let e=1;e<n&&(u=VF.add(u,7,fU.Days),u.getMonth()===c.getMonth());e++)c=new Date(u.valueOf());const d=60*i*60+60*a+o-60*s;return VF.add(VF.deleteTime(c),d,fU.Seconds)},{timeZoneStandardDay:r,timeZoneStandardDayOfWeek:n,timeZoneStandardMonth:i,timeZoneStandardHour:a,timeZoneStandardMinute:o,timeZoneStandardSecond:s,timeZoneStandardBias:u,timeZoneDaylightDay:l,timeZoneDaylightDayOfWeek:c,timeZoneDaylightMonth:d,timeZoneDaylightHour:f,timeZoneDaylightMinute:p,timeZoneDaylightSecond:m,timeZoneDaylightBias:h}=this;return FU[e]=Object.create(null,{daylightEnd:{value:t(i,n,r,a,o,s,u)},daylightStart:{value:t(d,c,l,f,p,m,h)}}),FU[e]}_testSettings(e){vV(this,QU,{...bV(this,QU),...e})}}(RF),IF=PF.OrganizationSettings;function NF(){if(!0===AF)return RF;let e="function"==typeof window.GetGlobalContext?window.GetGlobalContext():null;if(null===e){const t=JV.extract("Xrm.Utility",window,{});e="function"==typeof t.getGlobalContext?t.getGlobalContext():null}if(null===e){const t=JV.extract("Xrm.Utility",parent,{});e="function"==typeof t.getGlobalContext?t.getGlobalContext():null}return null===e&&(e=JV.extract("Xrm.Page.context",window,null)),Object.isNullOrUndefined(e)?(!0!==window.ALLOW_NO_GLOBAL_CONTEXT&&XV("Context.Xrm","Context of Xrm is not available. Please add ClientGlobalContext.aspx to an HTML webresource. @see https://docs.microsoft.com/en-us/dynamics365/customer-engagement/developer/clientapi/reference/getglobalcontext-clientglobalcontext.js.aspx"),null):(AF=!0,e)}function TF(e=window.location.search){if(String.isNullOrEmpty(e))return null;return(e.indexOf("?")>-1?e.substr(1):e).split("&").reduce(((e,t,r,n)=>{const[i,a]=t.split("=");if(String.isNullOrEmpty(a)&&1===n.length)return i;const o=decodeURIComponent(a).split("&");return e[i]=o.reduce(((e,t,r,n)=>{const[i,a]=t.split("=");return void 0===a&&1===n.length?i:(e[i]=a||null,e)}),Object.create(null)),e}),Object.create(null))}var xF={Enums:EF,UserSettings:PF,OrganizationSettings:IF,Xrm:RF,getIsAvailable:function(){return AF},getQueryStringParameters:function(){return TF()},parseQueryStringParameters:TF,reset:function(){return AF=!1,RF=NF(),PF.load(!0)},isUci:function(){return!0!==window.ORBIS_FORCE_RUI&&(window.Xrm&&window.Xrm.Internal&&"function"==typeof window.Xrm.Internal.isUci?Xrm.Internal.isUci():!parent.Xrm||!parent.Xrm.Internal||"function"!=typeof parent.Xrm.Internal.isUci||parent.Xrm.Internal.isUci())},isOffline:function(){return NF()?.client?.isOffline()??!1}};const kF="ORBIS/Core/Utils/DateHelper.Class",MF=mU.UserTime,$F=6e4,DF={[hU.ISO8601]:{pattern:/^(\d{4})-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]|)(?:[T ]([01]\d|2[0-3]):([0-5]\d)?:([0-5]\d)(?:[.,](\d{1,3}))?(?:([+-])([0]\d|1[0-4]):?([0-5]\d)|(Z))?)?/,parse(e){let t=null;if(null!=(t=this.pattern.exec(e))){t.index===this.pattern.lastIndex&&this.pattern.lastIndex++;const[,r=null,n=null,i=null,a=0,o=0,s=0,u=0,l="+",c=0,d=0]=t;if(!r||!n||!i)return null;const f="Z"===t[11];return{year:parseInt(r,10),month:parseInt(n,10),date:parseInt(i,10),hours:parseInt(a,10),minutes:parseInt(o,10),seconds:parseInt(s,10),milliseconds:parseInt(u,10),tzDirection:l,tzHours:parseInt(c,10),tzMinutes:parseInt(d,10),isZuluTime:f,dateString:e}}return null},getDateFromObject:e=>e?new Date(e.year,e.month-1,e.date,e.hours,e.minutes,e.seconds,e.milliseconds):null,getDateFromString(e){const t=this.parse(e);return this.getDateFromObject(t)}},[hU.JSON]:{pattern:/\/Date\((\d+)\)\//,parse(e){let t=null;return null!=(t=this.pattern.exec(e))?(t.index===this.pattern.lastIndex&&this.pattern.lastIndex++,t[1]?{epochTime:parseInt(t[1],10),dateString:e}:null):null},getDateFromObject:e=>e?new Date(e.epochTime):null,getDateFromString(e){const t=this.parse(e);return this.getDateFromObject(t)}}};function LF(e=!0){let t=-this._date.getTimezoneOffset();if(!e){if(!xF.getIsAvailable())return void WV(`${kF}/DateHelper.adjustTimeZoneOffset`,"Context is not available");const{daylightStart:e,daylightEnd:r}=xF.UserSettings.calculateCutoverDates(this._date.getFullYear()),n=this._date.valueOf();t+=xF.UserSettings.timeZoneBias,n>=e&&n<=r&&(t+=xF.UserSettings.timeZoneDaylightBias)}this.addMinutes(t)}class jF{constructor(e=!0,...t){if(qF(t[0]))this._date=jF.clone(t[0]);else{const[e,r,n,i,a,o,s]=t;this._date=new Date(e,r||0,n||1,i||0,a||0,o||0,s||0)}LF.call(this,e)}getAsDate(e=MF){return new Date(this.valueOf(e))}get_setElementInZone(e,t,r,...n){switch(r){case mU.UTC:return this._date[`${e}UTC${t}`](...n);case mU.UserTime:return this[`${e}ElementInUserTime`](t,...n)}return this._date[`${e}${t}`](...n)}getElementInUserTime(e){return this.getAsDate(mU.UserTime)[`get${e}`]()}getTimezoneOffset(e=MF){const t=()=>{if(!xF.getIsAvailable())return WV("DateHelper",`Context is not available in ${kF}/DateHelper.getUserTimeZoneOffset`),0;let e=xF.UserSettings.timeZoneBias;const t=this.valueOf(mU.UTC)-e*$F,r=1970+Math.floor(t/31536e6),{daylightStart:n,daylightEnd:i}=xF.UserSettings.calculateCutoverDates(r);return t>=n&&t<=i&&(e+=xF.UserSettings.timeZoneDaylightBias),e};switch(e){case mU.UTC:return 0;case mU.UserTime:return t()}return this._date.getTimezoneOffset()}valueOf(e=MF){switch(e){case mU.UTC:return this._date.valueOf()+this.getTimezoneOffset(mU.ClientTime)*$F;case mU.UserTime:return this._date.valueOf()+this.getTimezoneOffset(mU.ClientTime)*$F-this.getTimezoneOffset(mU.UserTime)*$F}return this._date.valueOf()}setElementInUserTime(e,...t){const r=this.getAsDate(mU.UserTime);r[`set${e}`](...t),this._date=r,LF.call(this,!1)}toString(e,t=MF){const r=()=>{const e=this.getTimezoneOffset(t),r=Math.abs(e),n=e<0?"+":"-",i=Math.floor(r/60),a=r%60;return{isZuluTime:0===e,sign:n,hours:i,minutes:a,offsetStringA:`${n}${i.padLeft()}${a.padLeft()}`,offsetStringB:`${n}${i.padLeft()}:${a.padLeft()}`}},n={d:()=>this.getDate(t),dd:()=>this.getDate(t).padLeft(),M:()=>this.getMonth(t)+1,MM:()=>(this.getMonth(t)+1).padLeft(),yy:()=>String(this.getFullYear(t)).substr(2),yyyy:()=>this.getFullYear(t),h:()=>this.getHours(t)%12||12,hh:()=>(this.getHours(t)%12||12).padLeft(),H:()=>this.getHours(t),HH:()=>this.getHours(t).padLeft(),m:()=>this.getMinutes(t),mm:()=>this.getMinutes(t).padLeft(),s:()=>this.getSeconds(t),ss:()=>this.getSeconds(t).padLeft(),f:()=>Math.round(this.getMilliseconds(t)/100),ff:()=>Math.round(this.getMilliseconds(t)/10).padLeft(),fff:()=>this.getMilliseconds(t).padLeft(3),K:()=>{const e=r();return e.isZuluTime?"Z":e.offsetStringB},z:()=>{const e=r();return`${e.sign}${e.hours}`},zz:()=>{const e=r();return`${e.sign}${e.hours.padLeft()}`},zzz:()=>r().offsetStringB,t:()=>this.getHours(t)<12?"A":"P",tt:()=>this.getHours(t)<12?"AM":"PM"},i=[];return e=(e=(e=gU[e]||e||gU[hU.ISO8601]).replace(/\[([^]*?)\]/gm,((e,t)=>(i.push(t),"??")))).replace(/([dmMhHs])\1?|yy(?:yy)?|f{1,3}|[t]{1,2}|K|z{1,3}/g,(e=>e in n?n[e].call(this):"")),e.replace(/\?\?/g,(()=>i.shift()))}static clone(e){return qF(e)?new Date(e.valueOf()):null}static from(e,{sourceFormat:t=hU.ISO8601,isSourceUTC:r=!0}={}){const n=DF[t];if(!n)return null;const i=n.parse(e),a=n.getDateFromObject(i);return a?new jF(r,a):null}static getFirstOfYear(e){return new jF(!0,new Date(e,0,1))}}function _F(e){const t=new jF(!0,e||new Date);t.setDate(mU.UTC,t.getDate(mU.UTC)+4-(t.getDay(mU.UTC)||7));const r=t.getFullYear(mU.UTC),n=(t.valueOf(mU.UTC)-jF.getFirstOfYear(r).valueOf(mU.UTC))/864e5;return 100*r+Math.ceil((n+1)/7)}function qF(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())}!function(){const e=Object.keys(pU);Object.keys(mU).forEach((t=>{e.forEach((e=>{jF.prototype[`get${e}`]=function(t=MF){return this.get_setElementInZone("get",e,t)},jF.prototype[`set${e}`]=function(t=MF,...r){return this.get_setElementInZone("set",e,t,...r)},jF.prototype[`get${e}In${t}`]=function(){return this.get_setElementInZone("get",e,t)},jF.prototype[`set${e}In${t}`]=function(...r){return this.get_setElementInZone("set",e,t,...r)}}))}))}(),function(){const e=Object.keys(fU),t=function(e){let t=e;switch(e){case"Days":t="Date";break;case"Years":t="FullYear";break;case"Months":t="Month"}return t};e.forEach((e=>{jF.prototype[`add${e}`]=function(r){return this[`set${t(e)}InUTC`](this[`get${t(e)}InUTC`]()+r),this.getAsDate(mU.UTC)}}))}();var VF={Enums:yU,add:function(e,t=0,r=fU.Days){return new jF(!0,e)[`add${r=r||fU.Days}`](parseInt(t,10))},deleteTime:function(e){const t=jF.clone(e)||new Date;return t.setHours(0,0,0,0),t},format:function(e,{isSourceUTC:t=!1,targetFormat:r=hU.ISO8601,targetDateZone:n=MF}={}){return new jF(t,e).toString(r,n)},getWeek:function(e){return _F(e||new Date)%100},getSortableWeek:_F,isValidDate:qF,isValidISODateString:function(e){return/^\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\d|3[01])(?:[T ](?:[01]\d|2[0-3]):(?:[0-5]\d)?:(?:[0-5]\d)(?:[.,](?:\d{1,3}))?(?:(?:[+-])(?:[0]\d|1[0-4]):?(?:[0-5]\d)|(?:Z))?)?/.test(e)},parse:function(e,{sourceFormat:t=hU.ISO8601,isSourceUTC:r=!0,targetDateZone:n=MF}={}){const i=jF.from(e,{sourceFormat:t,isSourceUTC:r});return null!=i?i.getAsDate(n):null}};const UF="Metadata-Bootstrap",FF="Metadata-CurrentTimestamp",BF="Metadata-Entity",zF={applyLanguage:!1,rootName:"ORBIS.Core"};let KF=DU.get(FF,zF),WF=null,XF=!1,ZF=null,GF=null;function HF(){if(null!==ZF)return ZF;if(xF.isOffline())return Promise.resolve(null);const e=(null!=WF||(WF=LU.get(FF,zF),XF=null!=WF),WF);return ZF=null!=e?Promise.resolve(e):JH.execute(new jG).then((e=>(WF=e.data,XF=WF===KF,LU.set(FF,WF,zF),WF))).catch(console.error).then(((e=!1)=>{if(!1===XF||!0===e)return DU.getKeys(new RegExp("Metadata","i"),zF).forEach((e=>{DU.remove(e,zF)})),DU.set(FF,WF,zF),DU.set("Metadata-CurrentTimestamp-Date",VF.format(new Date,{targetDateZone:VF.Enums.DateZone.UTC}),zF),KF=WF,XF=!0,WF})),ZF}function JF(e){return DU.getJSON(`Metadata-Entity-${e}`,zF)}var YF={getBootstrap:function(){return null!=GF||(GF=HF().then((()=>!1===XF?null:DU.getJSON(UF,zF)))),GF},setBootstrap:function(e){DU.setJSON(UF,e,zF)},getCached:JF,getEntity:function(e){return HF().then((()=>JF(e)))},setEntity:function(e,t){t._TIMESTAMP=VF.format(new Date,{targetDateZone:VF.Enums.DateZone.UserTime});const r=JF(e),n=null==r?t:{...t,IsGranular:r.IsGranular&&t.IsGranular,Attributes:{...r.Attributes,...t.Attributes}};return DU.setJSON(`Metadata-Entity-${e}`,n,zF),n},deleteEntity:function(e){return DU.remove(`Metadata-Entity-${e}`,zF)},clear:function(){if(xF.isOffline())return;DU.getKeys(new RegExp(BF),zF).forEach((e=>DU.remove(e,zF)))}};function QF(e,t="LogicalName"){if(null==e||0===e.length)return null;const r=[];var n;return r.push(`Microsoft.Dynamics.CRM.In(PropertyName='${t}',PropertyValues=[${n=e,n.map((e=>`'${e}'`)).join(",")}])`),r.join("")}function eB(e,t,r,n,i,a=""){if(Array.isArray(t)&&0===t.length)return Promise.resolve([]);const o=[`EntityDefinitions(LogicalName='${e}')/Attributes`,null!=r?`/${r}`:"","?",[null!=i?`$select=${i}`:null,(n||null!=t?"$filter=":"")+[n,QF(t,"LogicalName")].filter(Boolean).join(" and "),a].filter(Boolean).join("&")];return JH.execute(new iG({webAPI:{url:o.join("")}})).then((e=>e.data.value))}function tB(e){return JH.execute(new iG({logicalName:"",params:["$select=LogicalName,EntitySetName,LogicalCollectionName,IsIntersect,IsActivity,PrimaryIdAttribute,ObjectTypeCode",e?`$filter=LogicalName eq '${e}'`:null].filter(Boolean).join("&")})).then((e=>JV.extract("data.value",e)))}function rB(e,t,r={},n){return Array.isArray(t)&&0===t.length?Promise.resolve(r):function(e,t){const r=QF(t,"ReferencingAttribute");return JH.execute(new AG({type:hV.OneToMany,params:[`$filter=ReferencingEntity eq '${e}'`+(""!==r?` and ${r}`:""),"&$select=ReferencingEntityNavigationPropertyName,ReferencingAttribute,ReferencedEntity"].join("")})).then((e=>e.data.value))}(e,t).then((e=>e.reduce(((e,t)=>{const{ReferencedEntity:r,ReferencingAttribute:i,ReferencingEntityNavigationPropertyName:a}=t;return JV.define([i,n].filter(Boolean).join("."),e)[r]=a,e}),r))).catch(console.error)}function nB(e,t=null){return Array.isArray(t)&&0===t.length?[]:eB(e,t,"Microsoft.Dynamics.CRM.PicklistAttributeMetadata",null,"LogicalName,OptionSet,DefaultFormValue","$expand=OptionSet($select=Options)")}function iB(e,t=null){return Array.isArray(t)&&0===t.length?[]:eB(e,t,"Microsoft.Dynamics.CRM.MultiSelectPicklistAttributeMetadata",null,"LogicalName,OptionSet,DefaultFormValue","$expand=OptionSet($select=Options)")}function aB(e,t=null){return Array.isArray(t)&&0===t.length?[]:eB(e,t,"Microsoft.Dynamics.CRM.StateAttributeMetadata",null,"LogicalName,OptionSet,DefaultFormValue","$expand=OptionSet($select=Options)")}function oB(e,t=null){return Array.isArray(t)&&0===t.length?[]:eB(e,t,"Microsoft.Dynamics.CRM.StatusAttributeMetadata",null,"LogicalName,OptionSet,DefaultFormValue","$expand=OptionSet($select=Options)")}function sB(e,t=null){return Array.isArray(t)&&0===t.length?[]:eB(e,t,"Microsoft.Dynamics.CRM.BooleanAttributeMetadata",null,"LogicalName,OptionSet,DefaultValue","$expand=OptionSet").then((e=>e.map((e=>({LogicalName:e.LogicalName,DefaultFormValue:e.DefaultValue,OptionSet:{Options:[e.OptionSet.TrueOption,e.OptionSet.FalseOption]}})))))}function uB(e,t,r,n,i,a){return Promise.all([t,r,n,i,a]).then((([t,r,n,i,a])=>([...t,...r,...n,...i,...a].reduce(((e,t)=>{const{LogicalName:r,OptionSet:n,DefaultFormValue:i}=t,a=n.Options.map((e=>{const{Value:t,Color:r,Label:n}=e;return{value:t,color:r,text:JV.extract("UserLocalizedLabel.Label",n)}}));return e[r]={...e[r],Options:a,DefaultValue:i},e}),e.Attributes),e)))}function lB(e,t,r){return e?e.filter((e=>r.includes(t.Attributes[e]?.AttributeType))):e}var cB={getBootstrap:function(){return xF.isOffline()?Promise.resolve():tB().catch(console.error)},getBase:(e,t)=>{const r=tB(e),n=eB(e,t,null,"AttributeType ne 'Virtual'","LogicalName,AttributeType",null).then((e=>e.reduce(((e,t)=>{const{LogicalName:r,AttributeType:n}=t;return e[r]={AttributeType:n},e}),{}))).catch(console.error);return Promise.all([r,n]).then((([e,t])=>{const r=null!=e?e[0]:{};return r.Attributes=t,r})).then((r=>{const n=eB(e,lB(t,r,[IV.DateTime]),"/Microsoft.Dynamics.CRM.DateTimeAttributeMetadata/",null,"LogicalName,DateTimeBehavior",null).then((e=>e.reduce(((e,t)=>{const{DateTimeBehavior:r,LogicalName:n}=t;return e[n]={...e[n],Behavior:JV.extract("Value",r)},e}),r.Attributes))).catch(console.error),i=eB(e,lB(t,r,[IV.MultiSelectPicklist]),"/Microsoft.Dynamics.CRM.MultiSelectPicklistAttributeMetadata/",null,"LogicalName",null).then((e=>e.reduce(((e,t)=>{const{LogicalName:r}=t;return e[r]={AttributeType:IV.MultiSelectPicklist},e}),r.Attributes))),a=rB(e,lB(t,r,jV),r.Attributes,"NavigationPropertyNames");return Promise.all([n,a,i]).then((()=>r))}))},getAttributeNames:async function(e){const[t,r]=await Promise.all([eB(e,null,null,"&$filter=AttributeType ne 'Virtual'","LogicalName"),eB(e,null,"Microsoft.Dynamics.CRM.MultiSelectPicklistAttributeMetadata",null,"LogicalName",null)]);return t.concat(r).map((e=>e.LogicalName)).sort()},get:async function(e,t){const r=JH.execute(new iG({logicalName:e,params:"$select=LogicalName,EntitySetName,LogicalCollectionName,IsIntersect,IsActivity,PrimaryIdAttribute,DisplayName,DisplayCollectionName,IconLargeName,IconMediumName,IconSmallName,EntityColor,SchemaName,ObjectTypeCode,PrimaryIdAttribute,PrimaryNameAttribute,IsActivityParty,IsCustomEntity"})).then((t=>{const r=t.data;if(null==r)throw new Error(`No metadata retrieved in EntityDefinitions.get for entity ${e}`);const{DisplayName:n,DisplayCollectionName:i}=r;return r.DisplayName=JV.extract("UserLocalizedLabel.Label",n),r.DisplayCollectionName=JV.extract("UserLocalizedLabel.Label",i),r.IsOptionsetResolved=!1,r})),n=eB(e,t,null,null,null,null).then((e=>e.reduce(((e,t)=>{const{DisplayName:r,EntityLogicalName:n,LogicalName:i,RequiredLevel:a,Format:o,MaxLength:s,MinValue:u,MaxValue:l,Precision:c,PrecisionSource:d,DateTimeBehavior:f,Direction:p}=t,m=JV.extract("AttributeTypeName.Value",t).replace("Type","");return!0===(m===IV.Virtual)||(e[i]={AttributeType:m,Behavior:JV.extract("Value",f),DisplayName:JV.extract("UserLocalizedLabel.Label",r),LogicalName:i,EntityLogicalName:n,RequiredLevel:JV.extract("Value",a),Format:o,MaxLength:s,MinValue:u,MaxValue:l,Precision:c,PrecisionSource:d,Direction:p}),e}),{}))),[i,a]=await Promise.all([r,n]);return i.Attributes=a,await Promise.all([uB(i,nB(e,lB(t,i,[IV.Picklist])),iB(e,lB(t,i,[IV.MultiSelectPicklist])),aB(e,lB(t,i,[IV.State])),oB(e,lB(t,i,[IV.Status])),sB(e,lB(t,i,[IV.Boolean]))),rB(e,lB(t,i,jV),i.Attributes,"NavigationPropertyNames")]),i}};const dB={entitydataprovider:{O:78},opportunitycompetitors:{E:"opportunitycompetitorscollection",I:!0,P:"opportunitycompetitorid",O:25},principalobjectaccess:{E:"principalobjectaccessset",O:11},topicmodel:{O:9944},bookableresourcecharacteristic:{O:1148},appmoduleroles:{E:"appmodulerolescollection",I:!0,P:"appmoduleroleid",O:9009},mailbox:{E:"mailboxes",O:9606},customerrelationship:{O:4502},convertrule:{O:9300},entityanalyticsconfig:{O:430},usermapping:{O:2016},sdkmessagerequestfield:{O:4614},languageprovisioningstate:{O:9875},appmodulemetadatadependency:{E:"appmodulemetadatadependencycollection",O:8701},documenttemplate:{O:9940},pricelevel:{O:1022},msdyn_aitemplate:{O:400},postrole:{O:8001},account:{O:1},connectionroleassociation:{I:!0,O:3232},bulkoperation:{A:!0,P:"activityid",O:4406},fileattachment:{O:55},activitypointer:{P:"activityid",O:4200},team:{O:9},offlinecommanddefinition:{P:"commanddefinitionid",O:9870},socialinsightsconfiguration:{O:1300},campaignactivity:{E:"campaignactivities",A:!0,P:"activityid",O:4402},entity:{E:"entities",O:9800},sharepointdocumentlocation:{O:9508},imagedescriptor:{O:1007},stringmap:{O:1043},quotedetail:{O:1085},fieldpermission:{O:1201},attribute:{O:9808},activityparty:{E:"activityparties",O:135},queuemembercount:{O:2024},fieldsecurityprofile:{O:1200},role:{O:1036},connection:{O:3234},msdyn_aimodel:{O:401},invaliddependency:{E:"invaliddependencies",O:7107},salesorderdetail:{O:1089},integrationstatus:{E:"integrationstatuses",P:"integrationentryid",O:3e3},mobileofflineprofileitem:{O:9867},queueitemcount:{O:2023},usersettings:{E:"usersettingscollection",P:"systemuserid",O:150},organization:{O:1019},workflowlog:{O:4706},kbarticle:{O:127},routingruleitem:{O:8199},postlike:{O:8006},connectionroleobjecttypecode:{O:3233},importdata:{E:"importdataset",O:4413},globalsearchconfiguration:{O:54},importlog:{O:4423},customcontrolresource:{O:9754},importentitymapping:{O:4428},mailboxtrackingfolder:{O:9608},interprocesslock:{O:4011},uomschedule:{O:1056},picklistmapping:{O:4418},roleprivileges:{E:"roleprivilegescollection",I:!0,P:"roleprivilegeid",O:12},callbackregistration:{O:301},mobileofflineprofileitemassociation:{O:9868},ribbonmetadatatoprocess:{E:"RibbonMetadataSetToProcess",P:"ribbonmetadatarowid",O:9880},appmodulemetadata:{E:"appmodulemetadatacollection",O:8700},template:{O:2010},ratingvalue:{O:1142},plugintype:{O:4602},leadaddress:{E:"leadaddresses",O:1017},sla:{O:9750},rollupfield:{O:9604},fixedmonthlyfiscalcalendar:{P:"userfiscalcalendarid",O:2004},subscription:{O:29},entitlementcontacts:{E:"entitlementcontactscollection",I:!0,P:"entitlementcontactid",O:7272},servicecontractcontacts:{E:"servicecontractcontactscollection",I:!0,P:"servicecontractcontactid",O:20},phonetocaseprocess:{E:"phonetocaseprocesses",P:"businessprocessflowinstanceid",O:952},unresolvedaddress:{E:"unresolvedaddresses",O:2012},activitymimeattachment:{O:1001},teammembership:{I:!0,O:23},topichistory:{E:"topichistories",O:9946},listmember:{I:!0,O:4301},appmodulemetadataoperationlog:{E:"appmodulemetadataoperationlogcollection",O:8702},childincidentcount:{O:113},quote:{O:1084},lookupmapping:{O:4419},systemusermanagermap:{O:51},solutioncomponentdefinition:{O:7104},processsession:{O:4710},organizationui:{P:"formid",O:1021},attributemap:{O:4601},bookableresourcecategory:{E:"bookableresourcecategories",O:1147},localconfigstore:{P:"id",O:9201},kbarticletemplate:{O:1016},dynamicpropertyinstance:{O:1333},actioncard:{O:9962},sdkmessageprocessingstepimage:{O:4615},tracelog:{O:8050},publisheraddress:{E:"publisheraddresses",O:7102},attachment:{O:1002},site:{O:4009},bookableresourcecategoryassn:{O:1149},duplicaterulecondition:{O:4416},businessunit:{O:10},advancedsimilarityrule:{O:9949},newprocess:{E:"newprocesses",P:"businessprocessflowinstanceid",O:950},subscriptionstatisticsoutlook:{E:"subscriptionstatisticsoutlookset",P:"subscriptionid",O:46},competitorproduct:{I:!0,O:1006},topicmodelconfiguration:{O:9942},email:{A:!0,P:"activityid",O:4202},traceregarding:{O:8052},recurringappointmentmaster:{A:!0,P:"activityid",O:4251},ribbonclientmetadata:{E:"ribbonclientmetadata",P:"ribbonid",O:4579},userqueryvisualization:{O:1112},transformationparametermapping:{O:4427},orderclose:{A:!0,P:"activityid",O:4209},partnerapplication:{O:1095},duplicaterecord:{P:"duplicateid",O:4415},systemuserprincipals:{E:"systemuserprincipalsset",P:"systemuserprincipalid",O:14},savedorginsightsconfiguration:{O:1309},subscriptionsyncinfo:{O:33},entitlement:{O:9700},importmap:{O:4411},incident:{O:112},systemuser:{O:8},customcontrol:{O:9753},systemuserprofiles:{E:"systemuserprofilescollection",I:!0,P:"systemuserprofileid",O:1202},dynamicproperty:{E:"dynamicproperties",O:1048},officegraphdocument:{O:9950},reportcategory:{E:"reportcategories",O:9102},officedocument:{O:4490},emailserverprofile:{O:9605},goalrollupquery:{E:"goalrollupqueries",O:9602},ribbonrule:{O:1117},calendarrule:{O:4004},convertruleitem:{O:9301},salesliteratureitem:{O:1070},bookingstatus:{E:"bookingstatuses",O:1152},mailmergetemplate:{O:9106},hierarchysecurityconfiguration:{P:"hierarchysecuritymodelingsettingid",O:9919},territory:{E:"territories",O:2013},competitoraddress:{E:"competitoraddresses",O:1004},azureserviceconnection:{O:9936},transactioncurrency:{E:"transactioncurrencies",O:9105},campaignactivityitem:{I:!0,O:4404},ribbondiff:{O:1130},postfollow:{O:8003},channelaccessprofileentityaccesslevel:{I:!0,O:9404},campaignitem:{I:!0,O:4403},accountleads:{E:"accountleadscollection",I:!0,P:"accountleadid",O:16},topic:{O:9948},solution:{O:7100},principalattributeaccessmap:{O:43},competitorsalesliterature:{I:!0,O:26},postcomment:{O:8005},userentityuisettings:{E:"userentityuisettingsset",O:2500},report:{O:9100},mailboxstatistics:{E:"mailboxstatistics",O:9607},opportunityproduct:{O:1083},customeropportunityrole:{O:4503},resource:{O:4002},systemapplicationmetadata:{E:"systemapplicationmetadatacollection",O:7e3},sdkmessagepair:{O:4613},leadproduct:{I:!0,O:27},contractdetail:{O:1011},recordcountsnapshot:{O:91},resourcespec:{O:4006},entitlemententityallocationtypemapping:{O:9704},sdkmessageresponsefield:{O:4611},productassociation:{O:1025},savedquery:{E:"savedqueries",O:1039},uom:{O:1055},opportunity:{E:"opportunities",O:3},channelaccessprofilerule:{O:9400},appconfig:{O:9012},sharepointdocument:{O:9507},teamprofiles:{E:"teamprofilescollection",I:!0,P:"teamprofileid",O:1203},resourcegroup:{O:4005},orginsightsmetric:{O:9699},goal:{O:9600},constraintbasedgroup:{O:4007},incidentresolution:{A:!0,P:"activityid",O:4206},ratingmodel:{O:1144},campaignresponse:{A:!0,P:"activityid",O:4401},principalentitymap:{I:!0,O:41},equipment:{O:4e3},semiannualfiscalcalendar:{P:"userfiscalcalendarid",O:2001},webresource:{E:"webresourceset",O:9333},opportunitysalesprocess:{E:"opportunitysalesprocesses",P:"businessprocessflowinstanceid",O:953},principalsyncattributemap:{O:1404},wizardaccessprivilege:{O:4803},service:{O:4001},isvconfig:{O:4705},principalobjectaccessreadsnapshot:{O:90},metric:{O:9603},hierarchyrule:{O:8840},fax:{E:"faxes",A:!0,P:"activityid",O:4204},displaystringmap:{O:4101},sharedobjectsforread:{E:"sharedobjectsforread",O:39},subscriptionsyncentryoffline:{E:"subscriptionsyncentriesoffline",P:"subscriptionid",O:47},serviceendpoint:{O:4618},position:{O:50},channelaccessprofile:{O:3005},knowledgearticleviews:{E:"knowledgearticleviews",O:9955},businessunitmap:{O:6},opportunityclose:{A:!0,P:"activityid",O:4208},subscriptionclients:{E:"subscriptionclientsset",P:"subscriptionclientid",O:1072},appconfiginstance:{O:9013},savedqueryvisualization:{O:1111},dependencyfeature:{O:7108},audit:{O:4567},systemform:{P:"formid",O:1030},lead:{O:4},bookableresourcegroup:{O:1151},systemusersyncmappingprofiles:{E:"systemusersyncmappingprofilescollection",I:!0,P:"systemusersyncmappingprofileid",O:1402},serviceappointment:{A:!0,P:"activityid",O:4214},timezonerule:{O:4811},rollupproperties:{E:"rolluppropertiescollection",O:9510},bookableresource:{O:1150},multientitysearchentities:{E:"multientitysearchentitiescollection",P:"multientitysearchentityid",O:9911},letter:{A:!0,P:"activityid",O:4207},aciviewmapper:{O:8040},businessunitnewsarticle:{O:132},rollupjob:{O:9511},knowledgearticle:{O:9953},appmodule:{O:9006},contactinvoices:{E:"contactinvoicescollection",I:!0,P:"contactinvoiceid",O:17},leadtoopportunitysalesprocess:{E:"leadtoopportunitysalesprocesses",P:"businessprocessflowinstanceid",O:954},characteristic:{O:1141},calendar:{O:4003},userapplicationmetadata:{E:"userapplicationmetadatacollection",O:7001},sdkmessage:{O:4606},productsubstitute:{O:1028},statusmap:{O:1075},bulkoperationlog:{I:!0,O:4405},optionset:{O:9809},reportentity:{E:"reportentities",O:9101},contact:{O:2},campaign:{O:4400},queue:{O:2020},replicationbacklog:{O:1140},quarterlyfiscalcalendar:{P:"userfiscalcalendarid",O:2002},teamtemplate:{O:92},ribbontabtocommandmap:{O:1113},applicationfile:{P:"fileid",O:4707},contactleads:{E:"contactleadscollection",I:!0,P:"contactleadid",O:22},asyncoperation:{O:4700},salesliterature:{O:1038},syncattributemapping:{O:1401},filtertemplate:{O:30},sdkmessagefilter:{O:4607},displaystring:{O:4102},userform:{O:1031},interactionforemail:{O:9986},privilegeobjecttypecodes:{E:"privilegeobjecttypecodesset",P:"privilegeobjecttypecodeid",O:31},product:{O:1024},annualfiscalcalendar:{P:"userfiscalcalendarid",O:2e3},relationshiprolemap:{O:4501},usersearchfacet:{O:52},bulkdeletefailure:{O:4425},expiredprocess:{E:"expiredprocesses",P:"businessprocessflowinstanceid",O:955},ownermapping:{O:4420},actioncardusersettings:{E:"actioncardusersettingsset",O:9973},translationprocess:{E:"translationprocesses",P:"businessprocessflowinstanceid",O:951},importjob:{O:9107},appmodulecomponent:{O:9007},sitemap:{O:4709},principalobjectattributeaccess:{E:"principalobjectattributeaccessset",O:44},teamroles:{E:"teamrolescollection",I:!0,P:"teamroleid",O:40},dynamicpropertyoptionsetitem:{P:"dynamicpropertyoptionsetvalueid",O:1049},subscriptionsyncentryoutlook:{E:"subscriptionsyncentriesoutlook",P:"subscriptionid",O:48},systemuserlicenses:{E:"systemuserlicensescollection",I:!0,P:"systemuserlicenseid",O:13},cardtype:{E:"cardtype",O:9983},task:{A:!0,P:"activityid",O:4212},ribboncontextgroup:{O:1115},systemuserroles:{E:"systemuserrolescollection",I:!0,P:"systemuserroleid",O:15},importfile:{O:4412},solutionhistorydata:{E:"solutionhistories",O:9890},workflow:{O:4703},roletemplateprivileges:{E:"roletemplateprivilegescollection",I:!0,P:"roletemplateprivilegeid",O:28},knowledgebaserecord:{O:9930},businessdatalocalizedlabel:{O:4232},appconfigmaster:{O:9011},postregarding:{O:8002},notification:{O:4110},mailboxtrackingcategory:{E:"mailboxtrackingcategories",O:9609},topicmodelexecutionhistory:{E:"topicmodelexecutionhistories",O:9943},entitydatasource:{O:85},sdkmessageprocessingstepsecureconfig:{O:4616},entitlementtemplate:{O:9702},reportvisibility:{E:"reportvisibilities",O:9103},owner:{O:7},customeraddress:{E:"customeraddresses",O:1071},kbarticlecomment:{O:1082},canvasapp:{O:300},theme:{O:2015},channelaccessprofileruleitem:{O:9401},columnmapping:{O:4417},exchangesyncidmapping:{O:4120},subscriptiontrackingdeletedobject:{P:"timestamp",O:35},incidentknowledgebaserecord:{I:!0,O:9931},navigationsetting:{O:9900},entitlementproducts:{E:"entitlementproductscollection",I:!0,P:"entitlementproductid",O:6363},userquery:{E:"userqueries",O:4230},emailsearch:{E:"emailsearches",O:4299},transformationmapping:{O:4426},orginsightsnotification:{O:9690},routingrule:{O:8181},actioncarduserstate:{O:9968},sdkmessageresponse:{O:4610},import:{O:4410},monthlyfiscalcalendar:{P:"userfiscalcalendarid",O:2003},metadatadifference:{O:4231},externalpartyitem:{O:9987},dependencynode:{O:7106},sharepointdata:{E:"sharepointdatacollection",O:9509},emailhash:{E:"emailhashes",O:4023},slaitem:{O:9751},runtimedependency:{E:"runtimedependencies",P:"dependencyid",O:7200},pluginassembly:{E:"pluginassemblies",O:4605},userfiscalcalendar:{O:1086},slakpiinstance:{O:9752},category:{E:"categories",O:9959},appointment:{A:!0,P:"activityid",O:4201},multientitysearch:{E:"multientitysearches",O:9910},holidaywrapper:{O:9996},emailsignature:{O:9997},connectionrole:{O:3231},msdyn_aiconfiguration:{O:402},annotation:{O:5},externalparty:{E:"externalparties",O:3008},channelproperty:{E:"channelproperties",O:1236},entitlementchannel:{O:9701},delveactionhub:{O:9961},post:{O:8e3},queueitem:{O:2029},sqlencryptionaudit:{P:"createdon",O:9613},competitor:{O:123},recurrencerule:{P:"ruleid",O:4250},bookableresourcebookingheader:{O:1146},userentityinstancedata:{E:"userentityinstancedataset",O:2501},timezonedefinition:{O:4810},socialactivity:{E:"socialactivities",A:!0,P:"activityid",O:4216},syncattributemappingprofile:{O:1400},knowledgesearchmodel:{O:9947},businessprocessflowinstance:{O:4725},untrackedemail:{A:!0,P:"activityid",O:4220},discounttype:{O:1080},msdyn_connector:{O:371},timezonelocalizedname:{O:4812},timestampdatemapping:{O:9932},entitlementtemplatechannel:{O:9703},wizardpage:{O:4802},processtrigger:{O:4712},multiselectattributeoptionvalues:{E:"multiselectattributeoptionvaluescollection",P:"multiselectfulltextidkey",O:9912},list:{O:4300},bookableresourcebooking:{O:1145},contracttemplate:{O:2011},similarityrule:{O:9951},plugintracelog:{O:4619},organizationstatistic:{O:4708},invoice:{O:1090},personaldocumenttemplate:{O:9941},dynamicpropertyassociation:{O:1235},relationshiprole:{O:4500},plugintypestatistic:{O:4603},productpricelevel:{O:1026},solutioncomponent:{O:7103},syncerror:{O:9869},workflowdependency:{E:"workflowdependencies",O:4704},sdkmessageprocessingstep:{O:4608},knowledgearticleincident:{O:9954},dataperformance:{O:4450},salesorder:{O:1088},bulkdeleteoperation:{O:4424},publisher:{O:7101},ribboncustomization:{O:1120},subscriptionmanuallytrackedobject:{I:!0,O:37},mobileofflineprofile:{O:9866},commitment:{O:4215},expanderevent:{O:4711},documentindex:{E:"documentindexes",O:126},sdkmessagerequest:{O:4609},license:{O:2027},discount:{O:1013},entitlementtemplateproducts:{E:"entitlementtemplateproductscollection",I:!0,P:"entitlementtemplateproductid",O:4545},customcontroldefaultconfig:{O:9755},webwizard:{O:4800},queuemembership:{I:!0,O:1213},feedback:{E:"feedback",O:9958},systemuserbusinessunitentitymap:{O:42},internaladdress:{E:"internaladdresses",O:1003},resourcegroupexpansion:{O:4010},socialprofile:{O:99},traceassociation:{O:8051},teamsyncattributemappingprofiles:{E:"teamsyncattributemappingprofilescollection",I:!0,P:"teamsyncattributemappingprofileid",O:1403},roletemplate:{O:1037},salesprocessinstance:{O:32},ribboncommand:{O:1116},invoicedetail:{O:1091},subject:{O:129},authorizationserver:{O:1094},duplicaterule:{O:4414},bookableresourcebookingexchangesyncidmapping:{O:4421},dependency:{E:"dependencies",O:7105},privilege:{O:1023},complexcontrol:{O:9650},reportlink:{O:9104},connector:{O:372},processstage:{O:4724},workflowwaitsubscription:{O:4702},contactorders:{E:"contactorderscollection",I:!0,P:"contactorderid",O:19},entitymap:{O:4600},sharepointsite:{O:9502},suggestioncardtemplate:{O:1190},contactquotes:{E:"contactquotescollection",I:!0,P:"contactquoteid",O:18},clientupdate:{O:36},quoteclose:{A:!0,P:"activityid",O:4211},leadcompetitors:{E:"leadcompetitorscollection",I:!0,P:"leadcompetitorid",O:24},knowledgearticlescategories:{E:"KnowledgeArticleCategories",I:!0,P:"knowledgearticlecategoryid",O:9960},subscriptionstatisticsoffline:{E:"subscriptionstatisticsofflineset",P:"subscriptionid",O:45},recommendeddocument:{O:1189},textanalyticsentitymapping:{O:9945},phonecall:{A:!0,P:"activityid",O:4210},contract:{O:1010},channelpropertygroup:{O:1234},productsalesliterature:{I:!0,O:21},languagelocale:{E:"languagelocale",O:9957}};let fB=null;const pB={EntitySetName:{shrink:(e,t)=>["E",e.EntitySetName!==`${t}s`?e.EntitySetName:void 0],expand:(e,t)=>["EntitySetName",e.E??`${t}s`]},IsIntersect:{shrink:e=>["I",!0===e.IsIntersect||void 0],expand:(e,t)=>["IsIntersect",e.I??!1]},IsActivity:{shrink:e=>["A",!0===e.IsActivity||void 0],expand:(e,t)=>["IsActivity",e.A??!1]},PrimaryIdAttribute:{shrink:(e,t)=>["P",e.PrimaryIdAttribute!==`${t}id`?e.PrimaryIdAttribute:void 0],expand:(e,t)=>["PrimaryIdAttribute",e.P??`${t}id`]},ObjectTypeCode:{shrink:e=>["O",e.ObjectTypeCode],expand:e=>["ObjectTypeCode",e.O]}};function mB(e,t,r){return null==t?null:Object.fromEntries(Object.values(pB).map((n=>n[r](t,e))))}let hB=null;function gB(){return fB||(null==hB&&(hB=yB(dB)),hB)||{}}function yB(e){return Object.fromEntries(Object.entries(e).map((([e,t])=>[e,mB(e,t,"expand")])))}const bB=dU((()=>YF.getBootstrap().then((e=>null==e?null:yB(e))).then((e=>(fB=e,e)))),{timeout:3e4}),vB=dU((()=>cB.getBootstrap().then((e=>function(e){if(null==e)return null;const t=e.reduce(((e,t)=>{const{LogicalName:r}=t;return t.EntitySetName=t.EntitySetName||t.LogicalCollectionName,delete t.LogicalCollectionName,e.shrinked[r]=mB(r,t,"shrink"),e.expanded[r]=t,e}),{expanded:{},shrinked:{}});return YF.setBootstrap(t.shrinked),fB=t.expanded,fB}(e))).catch((e=>(console.error(`Error in Bootstrap.retrieve: ${e.message}, the fallback will be used`),fB=yB(dB),fB)))),{timeout:3e4});function wB(){return null!=fB?Promise.resolve(fB):bB().then((e=>null==e?vB():e))}function OB(e){const t=JV.extract((e||"").toLowerCase(),gB());if(null!=t)return JV.extract("EntitySetName",t,`${e}s`);throw new Error(`Entity ${e} could not be found in metadata.`)}function SB(e){return null==e?(console.error("LogicalName was null in Bootstrap._getCachedObjectTypeCode"),null):JV.extract(`${e}.ObjectTypeCode`,gB(),null)}function CB(e){return null==e?(console.error("LogicalName was null in Bootstrap._getCachedObjectTypeCode"),null):JV.extract(`${e}.PrimaryIdAttribute`,gB(),null)}var EB={get:wB,getCached:gB,getEntitySeed:function(e){return xF.isOffline()?null:wB().then((()=>{const t=JV.extract(e,gB());if(null!=t)return t;throw new Error(`The entity ${e} could not be found in bootstrap`)}))},getEntitySeedCached:function(e){return JV.extract(e,gB())},getLogicalCollectionName:function(e){return xF.isOffline()?null:wB().then((()=>OB(e)))},getLogicalCollectionNameCached:function(e){return OB(e)},getEntityNameByCollectionName:function(e){return xF.isOffline()?null:wB().then((()=>{let[t=null]=Object.entries(gB()).find((([,t])=>t.EntitySetName===e))||[];return eV(t)&&(t=e.slice(0,-1)),t}))},getObjectTypeCode:function(e){return xF.isOffline()?null:wB().then((()=>SB(e)))},getObjectTypeCodeCached:function(e){return SB(e)},getPrimaryIdAttribute:function(e){return xF.isOffline()?null:wB().then((()=>CB(e)))},getPrimaryIdAttributeCached:function(e){return CB(e)}};function AB(e,t,r){RB(e,t),t.set(e,r)}function RB(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PB(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}var IB=new WeakMap,NB=new WeakMap,TB=new WeakMap,xB=new WeakSet;class kB{constructor(e,t,r){var n,i;RB(n=this,i=xB),i.add(n),AB(this,IB,{writable:!0,value:null}),AB(this,NB,{writable:!0,value:null}),AB(this,TB,{writable:!0,value:!1}),vV(this,NB,t),this.rawAttributeMetadata=r,vV(this,IB,e.logicalName),vV(this,TB,e.isActivity),!1===r.IsValid&&WV(`AttributeBase(entityMetadata, ${t}, rawAttributeMetadata)`,`The attribute '${t}' was not found in the entity '${e.logicalName}'. Working with default type String.`)}get entityLogicalName(){return bV(this,IB)}get logicalName(){return bV(this,NB)}get attributeType(){return this.rawAttributeMetadata.AttributeType}get type(){return this.attributeType}get behavior(){return this.rawAttributeMetadata.Behavior}get navigationPropertyNames(){return this.rawAttributeMetadata.NavigationPropertyNames}get isEntityReference(){return $B(jV,this.type)}get isPartyList(){return $B(_V,this.type)}get isOptionSet(){return $B(qV,this.type)}get isNumber(){return $B(VV,this.type)}get isCustomer(){return $B(UV,this.type)}get isValid(){return this.rawAttributeMetadata.IsValid??!0}get targets(){return null!=this.navigationPropertyNames?Object.keys(this.navigationPropertyNames):null}get participationTypeMask(){return LV[this.logicalName]||null}get isActivity(){return bV(this,TB)}getNavigationPropertyName(e){if(String.isNullOrWhiteSpace(e)){const e=Object.values(this.navigationPropertyNames||{});return e.length>0?e[0]:null}return this.navigationPropertyNames[e]}getTarget(e){let[t=null]=this.targets||[];return eV(e)||(t=PB(this,xB,MB).call(this,e),null==t&&this.isActivity&&(t=PB(this,xB,MB).call(this,`${e}_${this.entityLogicalName}`))),t}}function MB(e){const[t=null]=Object.entries(this.navigationPropertyNames||{}).find((([,t])=>t===e))||[];return t}function $B(e=[],t){return e.some((e=>e===t))}const DB=dU(((e,t,r)=>(window.Xrm||parent.Xrm).Utility.getEntityMetadata(e,t).then((t=>{if(xF.isOffline()&&null==t?.LogicalName)throw new Error(`Error in getClientMetadata from entity ${e}. Error forced.`);return null==r?t:function(e,t,r,n){if(null==r)throw new Error(`No metadata retrieved in ClientMetadata.get for entity ${e}`);const{EntitySetName:i,LogicalCollectionName:a,IsActivity:o,PrimaryIdAttribute:s,ObjectTypeCode:u,DisplayName:l,DisplayCollectionName:c,EntityColor:d,PrimaryNameAttribute:f,IsActivityParty:p,IsCustomEntity:m,PrimaryImageAttribute:h}=r,g=(r&&null!=r.Attributes?r.Attributes.get():[]).reduce(((e,t)=>{const{DisplayName:i,EntityLogicalName:a,LogicalName:o}=t,s=function(e){const{attributeDescriptor:{Type:t}}=e;if(t&&IV[t])return IV[t];try{const{AttributeType:r}=e;return NV[r]??(t||r)}catch(e){XV("ClientMetadata.parseAttributeType(attribute)",`Error in parseAttributeType: ${e.message}`)}return t}(t),u=jV.includes(s)?(r.ManyToOneRelationships?.get().filter((e=>e.ReferencingAttribute===o))||[]).reduce(((e,t)=>(e[t.ReferencedEntity]=t.ReferencingEntityNavigationPropertyName,e)),{}):void 0,{Behavior:l,RequiredLevel:c,Format:d,MaxLength:f,MinValue:p,MaxValue:m,Precision:h,PrecisionSource:g,DefaultValue:y}=t.attributeDescriptor,b={AttributeType:s,Behavior:kV[l],NavigationPropertyNames:u,LogicalName:o,EntityLogicalName:a},v=!0===n?null:{DisplayName:i,RequiredLevel:null!=c?PV[c]:RV.None,Format:LB(d,s),MaxLength:f,MinValue:p,MaxValue:m,Precision:h,PrecisionSource:g,Options:jB(t),DefaultValue:y};return e[o]={...b,...v},e}),{}),y=(r.ManyToManyRelationships?.getAll()||[]).find((t=>t.IntersectEntityName===e)),b=null!=y;if(null!=y){const e=g[y.Entity1IntersectAttribute];null!=e&&(e.NavigationPropertyNames={...e.NavigationPropertyNames,[y.Entity1LogicalName]:y.Entity1NavigationPropertyName});const t=g[y.Entity2IntersectAttribute];null!=t&&(t.NavigationPropertyNames={...t.NavigationPropertyNames,[y.Entity2LogicalName]:y.Entity2NavigationPropertyName})}return{EntitySetName:i||a,IsIntersect:b,IsActivity:o,PrimaryIdAttribute:s,ObjectTypeCode:u,...!0===n?null:{DisplayName:l,DisplayCollectionName:c,EntityColor:d,PrimaryNameAttribute:f,IsActivityParty:p,IsCustomEntity:m,PrimaryImageAttribute:h},Attributes:g}}(e,0,t,r)})).catch((t=>{throw console.error(`Error in getClientMetadata for entity ${e}`,t),t}))),{timeout:3e4});function LB(e,t){if("datetime"===e)return"DateAndTime";if("date"===e)return"DateOnly";if(null==e||isNaN(e))return e;const r=Number.parseInt(e,10);if(0===r)return TV.None;if(t===IV.Integer||t===IV.Int32||t===IV.BigInt){return{0:TV.None,1:TV.Duration,2:TV.TimeZone,3:TV.Language}[r]}return t===IV.Memo&&2===r?"TextArea":e}function jB(e){const t=JV.extract("attributeDescriptor.OptionSet",e);if(null!=t)return t.map((e=>({text:e.Label,value:e.Value,color:e.Color})));const r=JV.extract("OptionSet",e);return r?Object.values(r):null}var _B={getAttributeNames:async function(e){return((await DB(e,[],null))?._entityDescriptor?.AttributeNames||[]).sort()},get:function(e,t){return null==t&&WV(`ClientMetadata.get(${e}, attributeNames)`,`EntityMetadata cannot retrieve all attributes; you have to specify which attributes should be retrieved. Only the entity will be retrieved for ${e}`),DB(e,t||[],!1)},getBase:function(e,t){return null==t&&WV(`ClientMetadata.get(${e}, attributeNames)`,`EntityMetadata cannot retrieve all attributes; you have to specify which attributes should be retrieved. Only the entity will be retrieved for ${e}`),DB(e,t||[],!0)}};const qB=dU((async(e,t)=>{const r=xF.isUci(),n=null==t&&!0===r?!0===xF.isOffline()?await _B.getAttributeNames(e):await _B.getAttributeNames(e)||await cB.getAttributeNames(e):t;if(null==n&&!0===xF.isOffline())throw new Error(`Could not detect all-attributes for entity ${e} in offline mode`);const i=!0===r&&null!=n||!0===xF.isOffline()?await _B.getBase(e,n):await cB.getBase(e,n);return i.IsGranular=function(e){return null!=e}(t),null!=n&&n.length>0&&n.forEach((e=>{null==i.Attributes[e]&&(i.Attributes[e]={AttributeType:"String",IsValid:!1})})),i}),{timeout:3e4}),VB=async(e,t)=>{if(!1===xF.isUci())return null;const r=null!=t?t:!0===xF.isOffline()?await _B.getAttributeNames(e):await _B.getAttributeNames(e)||await cB.getAttributeNames(e);if(null!=r){const n=await _B.get(e,r);return n&&(n.IsGranular=null!=t),n}return null};var UB={getBase:qB,get:async(e,t)=>{if(!0===xF.isOffline()){return await VB(e,t)}return await VB(e,t)||((e,t)=>cB.get(e,t).then((e=>(e.IsGranular=null!=t,e))))(e,t)}};class FB{constructor(e,t,r,n){this.entityName=e,this.attributeNames=t?.map((e=>e?.toLowerCase()??e)),this.isBase=r,this.cached={entity:n,isComplete:!1,missingAttributes:null},this.storage={entity:null,isComplete:!1,missingAttributes:null},this.rawMetadata=null,this.isGranularSearch=null!=t}inspectCache(){const e=this.cached.entity?.rawMetadata;if(null!=e)if(!1!==e.IsGranular){if(null!=this.attributeNames&&Array.isArray(this.attributeNames)){if(0===this.attributeNames.length)return this.cached.missingAttributes=[],void(this.cached.isComplete=!0);if((!1===this.isBase||xF.isOffline())&&this.attributeNames.length>0){const t=Object.keys(e.Attributes||{});this.cached.missingAttributes=this.attributeNames.filter((e=>!t.includes(e))).sort(),0===this.cached.missingAttributes.length&&(this.cached.isComplete=!0)}}}else this.cached.isComplete=!0;else this.cached.missingAttributes=this.attributeNames?.sort()}inspectStorage(){const e=this.storage.entity;if(null!=e)if(!1!==e.IsGranular){if(null!=this.attributeNames&&Array.isArray(this.attributeNames)){if(0===this.attributeNames.length)return this.storage.missingAttributes=[],void(this.storage.isComplete=!0);if(this.attributeNames.length>0){const t=Object.keys(e.Attributes||{});this.storage.missingAttributes=this.attributeNames.filter((e=>!t.includes(e))).sort(),0===this.storage.missingAttributes.length&&(this.storage.isComplete=!0)}}}else this.storage.isComplete=!0;else this.storage.missingAttributes=this.attributeNames?.sort()}async checkTheStorage(){this.storage.entity=await YF.getEntity(this.entityName),this.inspectMissingAttributes(this.storage.entity,this.storage,!1)}async search(){if(this.inspectCache(),!0===this.cached.isComplete)return{cached:this.cached.entity,raw:null};if(!xF.isOffline()&&(!0===this.isBase||null==this.attributeNames&&!0===xF.isUci()))if(this.storage.entity=await YF.getEntity(this.entityName),null==this.attributeNames&&!0===xF.isUci()&&!1===this.storage.entity?.IsGranular)this.cached.missingAttributes=Object.keys(this.storage.entity.Attributes).sort();else if(!0===this.isBase&&(this.inspectStorage(),!0===this.storage.isComplete))return{cached:null,raw:this.storage.entity};const e=!0===this.isBase?await UB.getBase(this.entityName,xF.isOffline()?this.cached.missingAttributes:this.storage.missingAttributes):await UB.get(this.entityName,this.cached.missingAttributes);if(null==e)throw new Error(`Could not find metadata for entity ${this.entityName}`);return!1===this.isBase||xF.isOffline()?this.rawMetadata=this.mergeRawContent(this.cached.entity?.rawMetadata,e):(this.rawMetadata=e,xF.isOffline()||!1===this.storage.isComplete&&(this.rawMetadata=YF.setEntity(this.entityName,e))),{cached:null,raw:this.rawMetadata}}mergeRawContent(e,t){return null==e?t:{...e,...t,IsGranular:this.isGranularSearch,Attributes:{...e.Attributes,...t.Attributes}}}}function BB(e,t,r){zB(e,t),t.set(e,r)}function zB(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KB(e,t,r,n){return ZB(e,t),XB(r,"set"),function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,r,n),n}function WB(e,t,r){return ZB(e,t),XB(r,"get"),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,r)}function XB(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function ZB(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}let GB=!1;function HB(e){GB||(WV(`EntityBase.${e}`,"Metadata cached functions are deprecated","Consider using async methods instead."),GB=!0)}var JB=new WeakMap,YB=new WeakMap,QB=new WeakSet;class ez{constructor(e,t){var r,n;zB(r=this,n=QB),n.add(r),BB(this,JB,{writable:!0,value:{}}),BB(this,YB,{writable:!0,value:null}),vV(this,YB,null!=e?e.toLowerCase():""),this.rawMetadata=t}static getCached(e){return WB(ez,ez,rz)[(e||"").toLowerCase()]}static clearCache(){KB(ez,ez,rz,{})}static clearStorage(){YF.clear()}get logicalName(){return bV(this,YB)}get entitySetName(){return this.rawMetadata.EntitySetName||`${this.logicalName}s`}get logicalCollectionName(){return this.entitySetName}get isIntersect(){return null!=this.rawMetadata.IsIntersect&&this.rawMetadata.IsIntersect}get isActivity(){return null!=this.rawMetadata.IsActivity&&this.rawMetadata.IsActivity}get primaryIdAttribute(){return this.rawMetadata.PrimaryIdAttribute||`${this.logicalName}id`}get isGranular(){return this.rawMetadata.IsGranular}hasAttribute(e){return null!=this.rawMetadata.Attributes[e]}getAttribute(e){return function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}(this,QB,tz).call(this,e,this.rawMetadata.Attributes[e])}getAttributes(e){return Array.isArray(e)?e.map((e=>this.getAttribute(e))):Object.keys(this.rawMetadata.Attributes).map((e=>this.getAttribute(e)))}static async get(e,t=null){const r=new FB(e,t,!0,ez.getCached(e)),n=await r.search();if(null!=n.cached)return n.cached;if(null==n.raw)throw new Error(`Error in get EntityBase for ${e}`);const i=new ez(e,n.raw);return WB(ez,ez,rz)[e]=i,i}static getMultiple(...e){return Promise.all(e.map((e=>ez.get(e))))}static async getAttribute(e,t,r=!1){const n=t?.toLowerCase()??t,i=WB(ez,ez,rz)[e];if(i&&i.hasAttribute(n))return i.getAttribute(n);const a=await ez.getAttributes(e,[n],r);return null==a||a.length<=0?null:a[0]}static async getAttributes(e,t,r=!1){if(null==t||0===t.length)throw new Error("No attributes passed to static EntityBase.getAttributes");const n=await ez.get(e,t,r),i=t.map((e=>n.getAttribute(e)));if(null==i||0===i.length){if(!0===r)throw new Error(zV(`EntityBase.getAttributes(${e}, ${t}, [${r}])`,`No metadata found for attribute "${t}" on entity "${e}".`,"Please check attribute spelling or if attributes exists."));return null}return i}getLogicalCollectionNameCached(e){HB("EntityBase.getLogicalCollectionNameCached");const t=e?e.toLowerCase():"",r=EB.getLogicalCollectionNameCached(t);if(!String.isNullOrEmpty(r))return r;return ez.getCached(t)?.rawMetadata?.LogicalCollectionName??null}static async getLogicalCollectionName(e){if(eV(e))throw new Error(zV(`EntityBase.getLogicalCollectionName(${e})`,"You must provide an entityName to get the collectionName."));const t=e?.toLowerCase()??"",r=await EB.getLogicalCollectionName(t);if(!String.isNullOrEmpty(r))return r;return(await ez.get(t,[])).entitySetName}static getLogicalCollectionNames(...e){return Promise.all(e.map((e=>ez.getLogicalCollectionName(e))))}static getEntityNameByCollectionName(e){return EB.getEntityNameByCollectionName(e)}static async getNavigationPropertyName(e,t,r){const n=await ez.get(e);if(null==n)return WV(`EntityBase.getNavigationPropertyName(${t}, ${e}, ${r})`,`No metadata found for entity "${e}".`,"Trying an educated guess."),nz(t,e,r);const i=n.getAttribute(t);if(null==i)return WV(`EntityBase.getNavigationPropertyName(${t}, ${e}, ${r})`,`No metadata found for attribute "${t}" on entity "${e}".`,"Trying an educated guess."),nz(t,e,r,n.isActivity);const a=i.getNavigationPropertyName(r);return eV(a)?(WV(`EntityBase.getNavigationPropertyName(${t}, ${e}, ${r})`,`No NavigationPropertyName found on attribute "${t}" on entity "${e}".`,"Trying an educated guess."),nz(e,t,r,n.isActivity,i.isCustomer)):a}static async getTargetLogicalCollectionName(e,t,r=null){if(!eV(r)){if(!xF.isOffline())return EB.getLogicalCollectionName(r);const e=await ez.get(r);if(e)return e.logicalCollectionName}const n=await ez.get(e);if(null==n)throw new Error(zV(`EntityBase.getTargetLogicalCollectionName(${e}, ${t}, ${r})`,`No metadata found for entity "${e}."`,"Please check spelling or that this entity exists."));const i=n.getAttribute(t);if(null==i)throw new Error(zV(`EntityBase.getTargetLogicalCollectionName(${e}, ${t}, ${r})`,`No metadata found for attribute "${t}" on entity "${e}."`,"Please check spelling or that this attribute exists."));const a=i.targets||[];if(0===a.length)throw new Error(zV(`EntityBase.getTargetLogicalCollectionName(${e}, ${t}, ${r})`,`Lookup "${t}" on entity "${e}" has no targets.`));if(a.length>1)throw new Error(zV(`EntityBase.getTargetLogicalCollectionName(${e}, ${t}, ${r})`,`Lookup "${t}" on entity "${e}" is a multi target lookup.`,"Please specify a logicalName for this lookup."));return ez.getLogicalCollectionName(a[0])}static async getPrimaryIdAttribute(e){const t=e?.toLowerCase()??"",r=await EB.getPrimaryIdAttribute(t);if(!String.isNullOrEmpty(r))return r;try{return(await ez.get(t,[])).primaryIdAttribute||`${t}id`}catch(e){return WV(`EntityBase.getPrimaryIdAttribute(${t})`,`There was an error in Metadata.getPrimaryIdAttribute for entity ${t}. The fallback "id" will be returned`),`${t}id`}}static getPrimaryIdAttributeCached(e){const t=e?.toLowerCase()??"",r=EB.getPrimaryIdAttributeCached(t);if(!String.isNullOrEmpty(r))return r;const n=ez.getCached(t,[]);return null==n?(WV(`EntityBase.getPrimaryIdAttributeCached(${t})`,`There was an error in Metadata.getPrimaryIdAttributeCached for entity ${t}. No entity was found. The fallback "id" will be returned`),`${t}id`):n.primaryIdAttribute||`${t}id`}static async getObjectTypeCode(e){const t=e?.toLowerCase()??"";if(!xF.isOffline()){const e=await EB.getObjectTypeCode(t);if(null!=e&&!Number.isNaN(e))return e}const r=await ez.get(t,[]);if(null==r)throw new Error(`Could not find metadata for entity ${t} (getObjectTypeCode)`);return r.rawMetadata?.ObjectTypeCode}static getObjectTypeCodeCached(e){const t=e?e.toLowerCase():"",r=EB.getObjectTypeCodeCached(t);if(null!=r&&!Number.isNaN(r))return r;const n=ez.getCached(t);return null==n||null==n.rawMetadata?null:n.rawMetadata.ObjectTypeCode}}function tz(e,t){return void 0===bV(this,JB)[e]&&(bV(this,JB)[e]=null!=t?new kB(this,e,t):null),bV(this,JB)[e]}var rz={writable:!0,value:{}};function nz(e,t,r,n=!1,i=!1){if(!0===n){return!0===t.startsWith("regardingobjectid")?(iz(t,e,r),`${t}_${r}_${e}`):!0===i?(iz(t,e,r),`${t}_${e}_${r}`):`${t}_${e}`}return!0===i?(iz(t,e,r),`${t}_${r}`):t}function iz(e,t,r){if(eV(r))throw new Error(zV(`EntityBase/assertNoEmptyTarget(${e}, ${t}, ${r})`,`Cannot generate NavigationPropertyName name for lookup "${e} on entity ${t}".`))}class az{constructor(e,t,r,n){this._resolve=e,this._callback=t,this._context=r,this._args=n}get callback(){return this._callback}get context(){return this._context}get resolve(){return this._resolve}get args(){return this._args}}function oz(e,t,r){if(cz.call(this)){const n=new Promise((n=>n(e.apply(t,r))));return n.then((()=>sz.call(this)),(()=>sz.call(this))),n}return new Promise((n=>{lz.call(this,new az(n,e,t,r))}))}function sz(){let e;dz.call(this),null!==(e=uz.call(this))&&e.resolve(oz.apply(this,[e.callback,e.context,e.args]))}function uz(){return this._queue.length<=0?null:this._queue.shift()}function lz(e){null!==e&&this._queue.push(e)}function cz(){return!!this.hasSlots&&(this._slotsAvailable--,!0)}function dz(){return++this._slotsAvailable}class fz{constructor(e=10){let t;try{t=parseInt(e,10),isNaN(t)&&(t=10)}catch(e){t=10}this._maxConcurrent=t,this._slotsAvailable=t,this._queue=[],this._isCanceled=!1}cancel(e=!0){this._isCanceled=e}addFunction(e,t,...r){return oz.apply(this,[e,t||this,r])}get hasSlots(){return this._slotsAvailable>0}get slotsAvailable(){return this._slotsAvailable}get isCanceled(){return this._isCanceled}}const pz=/^(#?[\w-]+|\.[\w-.]+|\w:[\w-]+)$/,mz=/\./g,{slice:hz}=[];function gz(e,t=document,r=null){if(pz.test(e))switch(e[0]){case"#":return[document.getElementById(e.substr(1))];case".":return hz.call(t.getElementsByClassName(e.substr(1).replace(mz," ")));default:return hz.call(function(e,t,r){return String.isNullOrWhiteSpace(r)?e.getElementsByTagName(t):e.getElementsByTagNameNS(r,t)}(t,e,r))}return hz.call(t.querySelectorAll(e))}function yz(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}const bz=999;var vz=new WeakMap,wz=new WeakMap,Oz=new WeakMap,Sz=new WeakMap,Cz=new WeakMap;class Ez{constructor(e={}){yz(this,vz,{writable:!0,value:void 0}),yz(this,wz,{writable:!0,value:void 0}),yz(this,Oz,{writable:!0,value:void 0}),yz(this,Sz,{writable:!0,value:void 0}),yz(this,Cz,{writable:!0,value:void 0});const{status:t=bz,statusText:r="",responseText:n="",responseXML:i=null,headers:a={}}=e;vV(this,vz,t),vV(this,wz,r),vV(this,Oz,n),vV(this,Sz,i),vV(this,Cz,a)}getResponseHeader(e){return bV(this,Cz)[e]||null}setResponseHeader(e,t){bV(this,Cz)[e]=t}getResponseHeaders(){return bV(this,Cz)}setResponseHeaders(e={}){vV(this,Cz,{...bV(this,Cz),...e})}get status(){return bV(this,vz)||bz}set status(e){vV(this,vz,e)}get statusText(){return bV(this,wz)||""}set statusText(e){vV(this,wz,e)}get responseText(){return bV(this,Oz)||""}set responseText(e){vV(this,Oz,e)}get responseXML(){return bV(this,Sz)||null}set responseXML(e){vV(this,Sz,e)}}const Az="ORBIS.Core.Utils.Async",Rz=[];function Pz(e,...t){return new Promise(((r,n)=>{Object.isNullOrUndefined(e)&&Iz(r),"function"==typeof e?Iz((()=>{const n=e(...t);return r(n)})):n(new Error(`asyncPromise(fn) can only be called with a callback, null or undefined. Got ${typeof e} instead.`))}))}function Iz(e){"function"==typeof e?(Rz.push(e),window.postMessage(Az,"*")):console.error(`async(fn) can only be called with a callback. Got ${typeof e} instead.`)}window.addEventListener("message",(e=>{e.source===window&&e.data===Az&&Rz.length>0&&Rz.shift()()}),!0);const Nz="load",Tz="timeout",xz="abort",kz="error",Mz={body:void 0,method:nV.GET,headers:Object.create(null),withCredentials:!1,responseType:null,parser:()=>Promise.resolve(),errorParser:()=>Promise.resolve()};function $z(e,t=null,r=!0){return Object.assign(Object.create(null),{data:t,xhr:e,isSuccess:e?e.status<aV.BadRequest:r,toString:()=>GV("message",t,"")})}class Dz{constructor(e={}){this._options=Object.assign(Object.create(null),Mz,e)}execute(e={}){return new Promise(((t,r)=>{const n=new XMLHttpRequest,i=Object.assign(Object.create(null),this._options,e);i.headers=Object.assign(Object.create(null),this._options.headers,e.headers),i.params=Object.assign(Object.create(null),this._options.params,e.params),n.withCredentials=i.withCredentials,null!=i.responseType&&(n.responseType=i.responseType),n.open(i.method,i.url,!0),function(e,t){const r=t.headers||Object.create(null);Object.entries(r).forEach((([t,r])=>{e.setRequestHeader(t,r)}))}(n,i),n.addEventListener(Nz,(()=>{n.status>=aV.OK&&n.status<aV.BadRequest||0===n.status?i.parser(n).then((e=>t($z(n,e))),(e=>r($z(n,e,!1)))):i.errorParser(n).then((e=>r($z(n,e,!1))),(e=>r($z(n,e,!1))))})),n.addEventListener(xz,(()=>r($z(n,null,!1)))),n.addEventListener(kz,(()=>r($z(n,null,!1)))),n.addEventListener(Tz,(()=>r($z(n,null,!1))));i.body&&"string"==typeof i.body?n.send(i.body):n.send()}))}static get(e,t={}){return new Dz(t).execute({url:e})}static head(e,t={}){return new Dz(t).execute({url:e,method:nV.HEAD})}static post(e,t=null,r={}){return new Dz(r).execute({url:e,body:t,method:nV.POST})}static del(e,t={}){return new Dz(t).execute({url:e,method:nV.DELETE})}static put(e,t=null,r={}){return new Dz(r).execute({url:e,body:t,method:nV.PUT})}static patch(e,t=null,r={}){return new Dz(r).execute({url:e,body:t,method:nV.PATCH})}static options(e,t={}){return new Dz(t).execute({url:e,method:nV.OPTIONS})}}function Lz(e){return{pagingCookie:_z(e["@Microsoft.Dynamics.CRM.fetchxmlpagingcookie"],!0)||void 0,nextLink:e["@odata.nextLink"]??void 0,count:e["@odata.count"]??void 0,totalRecordCount:e["@Microsoft.Dynamics.CRM.totalrecordcount"]??void 0,totalRecordCountLimitExceeded:e["@Microsoft.Dynamics.CRM.totalrecordcountlimitexceeded"]??void 0}}function jz(e={}){const{values:t=[],pagingCookie:r=null,nextLink:n=null,count:i=null,totalRecordCount:a=-1,totalRecordCountLimitExceeded:o=!1}=e;return{values:t,pagingCookie:r,nextLink:n,count:i,totalRecordCount:a,totalRecordCountLimitExceeded:o}}function _z(e,t=!1){if(eV(e))return e;let r=e;if(t){const[,t]=/pagingcookie="(.*?)"/gi.exec(e);r=decodeURIComponent(decodeURIComponent(t))}return r.escapeXML().replace(/&amp;/g,"&amp;amp;")}function qz(e,t,r={},n={}){const{pageCallback:i}=r;null==i||"function"!=typeof i||t.length<=0||Iz((()=>{try{const{pagingCookie:r,nextLink:a,count:o,totalRecordCount:s,totalRecordCountLimitExceeded:u}=n;i($z(e,jz({values:t,pagingCookie:r,nextLink:a,count:o,totalRecordCount:s,totalRecordCountLimitExceeded:u}),!0))}catch(e){console.error(e)}}))}const Vz=new fz(500),Uz="boolean",Fz="dateTime",Bz="decimal",zz="EntityCollection",Kz="EntityReference",Wz="double",Xz="guid",Zz="int",Gz="Money",Hz="OptionSetValue",Jz="string",Yz="AliasedValue",Qz=/^(.+?Exception)/i,eK=/^(.*?at [\s\S]*)/im;function tK(e,t){return function(e){const{pages:t,pageCallback:r,_pageCount:n,_hasMoreRecords:i}=e,a=!Object.isNullOrUndefined(t),o=!Object.isNullOrUndefined(r);return i&&("all"===t||!a&&o||"number"==typeof t&&n<t)}(t)?(t._pageCount=t._pageCount||1,t._pageCount++,JH.fetch(t.fetchXML,t).then((t=>[...e,...t.data.values]))):e}function rK(e,t,r){const{pageCallback:n}=r;return!(!Object.isNullOrUndefined(n)&&"function"==typeof n)||t.length<=0?Promise.resolve():Pz((()=>{try{n($z(e,jz({values:t,totalRecordCount:r._totalRecordCount,totalRecordCountLimitExceeded:r._totalRecordCountLimitExceeded}),!0))}catch(e){console.error(e)}}))}function nK(e){return({success:t})=>Vz.addFunction(t,null,e)}function iK(e){return({error:t})=>Vz.addFunction(t,null,e)}async function aK(e,t=!1){const r=uK(uK(e.childNodes,"a:Attributes")[0].childNodes,"a:KeyValuePairOfstringanyType"),n=uK(uK(e.childNodes,"a:FormattedValues")[0].childNodes,"a:KeyValuePairOfstringstring"),[i]=uK(e.childNodes,"a:LogicalName"),[a,o]=await Promise.all([Promise.all(r.map((e=>oK(e,i.textContent)))),Promise.all(n.map((e=>oK(e))))]);if(t&&"activityparty"===i.textContent){return a.find((e=>"partyid"===e.key)).value}const s=Object.assign(Object.create(null),{"@meta":Object.create(null,{logicalName:{value:i.textContent,enumerable:!0,writable:!0,configurable:!0},primaryIdAttribute:{value:await lK(i.textContent),enumerable:!0,writable:!0,configurable:!0},formattedValues:{value:Object.create(null),enumerable:!0,writable:!0,configurable:!0},etag:{value:"",enumerable:!0,writable:!0,configurable:!0}})});return a.forEach((e=>{s[e.key]=e.value})),o.forEach((e=>{s["@meta"].formattedValues[e.key]=e.value})),s}function oK(e,t){const[r,n]=gz(":scope > key, :scope > value",e);return Promise.props({key:r.textContent,value:sK(n,r.textContent,t)})}async function sK(e,t,r){const n=function(e){const t=e.attributes.getNamedItem("i:type");let r;if(t&&null!==(r=/[a-z0-9]{1,2}:([a-z0-9]+?)$/i.exec(t.textContent))&&r.length>1)return r[1];return Jz}(e);let i=null;switch(n){case Uz:i="true"===e.textContent;break;case Fz:case Xz:case Jz:i=e.textContent;break;case Zz:i=parseInt(e.textContent,10);break;case Bz:case Wz:i=parseFloat(e.textContent);break;case Gz:i=function(e){const[t]=gz("*|Value",e);return parseFloat(t.textContent)}(e);break;case Hz:i=function(e){const[t]=gz("*|Value",e);return parseInt(t.textContent,10)}(e);break;case Kz:i=function(e){const[t,r,n]=gz("Id, LogicalName, Name",e);return Object.create(null,{id:{value:t.textContent,enumerable:!0,writable:!0},logicalName:{value:r.textContent||null,enumerable:!0,writable:!0,configurable:!0},entityType:{value:r.textContent||null,enumerable:!0,writable:!0,configurable:!0},name:{value:n.textContent||null,enumerable:!0,writable:!0,configurable:!0},toString:{value:()=>n.textContent||"(empty name)",enumerable:!1,writable:!1}})}(e);break;case zz:i=function(e){if(!Array.isArray(e))return[];return Promise.all(e.map((e=>aK(e,!0))))}(gz("Entities > Entity",e));break;case Yz:return function(e){const[t,r,n]=gz("AttributeLogicalName, EntityLogicalName, Value",e,"http://schemas.microsoft.com/xrm/2011/Contracts");return sK(n,t.textContent,r.textContent)}(e)}if(n===Fz){const e=await ez.getAttribute(r,t);if(null==e)return WV(`SOAP/Parser/valueParser(xml, ${t}, ${r})`,`No metadata found for attribute "${t}" on entity "${r}"`),i;const n=!0;let a=mU.UserTime;switch(e.behavior){case xV.DateOnly:case xV.TimeZoneIndependent:a=mU.UTC}i=VF.parse(i,{isSourceUTC:n,targetDateZone:a})}return i}function uK(e,t){if(!e)return null;if(eV(t))return null;const r=[];for(let n=0,i=e.length;n<i;n++){const i=e[n];i.tagName===t&&r.push(i)}return r}async function lK(e){const t=await ez.get(e);return t?t.primaryIdAttribute:(WV(`SOAP/Parser/getPrimaryIdAttribute(${e})`,`No metadata found for entity ${e}.`,"Cannot retrieve primary ID attribute."),null)}var cK={createResponseParser:function(e){return Pz((()=>{const t=gz("*|CreateResult, Results > KeyValuePairOfstringanyType > value",e.responseXML);if(t.length<=0)throw new Error("No GUID in CreateResult found.");return t[0].textContent}))},errorResponseParser:function(e){return Pz((()=>{const t={code:"Unknown",message:"Unable to parse error message. Please debug XHR object."};try{gz(`${"Fault > detail > OrganizationServiceFault > ErrorCode, Fault > faultstring"}, ${"Fault > Message, Fault > ErrorCode"}, ${"OrganizationServiceFault > ErrorDetails key"}`,e.responseXML).forEach((e=>{const{tagName:r,textContent:n}=e;if("ErrorCode"===r||"a:ErrorCode"===r){const e=parseInt(n,10);t.code=`0x${(e<0?e+4294967296:e).toString(16)}`}else if("faultstring"===r||"a:Message"===r)t.message=n;else if(n.includes("ApiOriginalExceptionKey")||n.includes("CallStack")){const r=GV("nextSibling.textContent",e,""),[,n=""]=r.match(Qz)||[];t.type=n;const[,i=""]=r.match(eK)||[];t.stack=i}}))}catch(r){t.code=e.status,t.message=`Error ${e.status}:  ${e.statusText} while executing ${e.responseURL}`}return t}))},retrieveResponseParser:function(e){return Pz((()=>{const[t]=gz("RetrieveResponse > RetrieveResult, Results > KeyValuePairOfstringanyType > value",e.responseXML);return aK(t)}))},retrieveMultipleResponseParser:function(e,t){return Pz((()=>{const r=e.responseXML,n=gz("MoreRecords",r,"http://schemas.microsoft.com/xrm/2011/Contracts"),i=!(n.length<=0)&&"true"===n[0].textContent,a=gz("PagingCookie",r,"http://schemas.microsoft.com/xrm/2011/Contracts"),o=a.length<=0?null:a[0].textContent,s=gz("TotalRecordCount",r,"http://schemas.microsoft.com/xrm/2011/Contracts"),u=s.length<=0?-1:parseInt(s[0].textContent,10),l=gz("TotalRecordCount",r,"http://schemas.microsoft.com/xrm/2011/Contracts"),c=!(l.length<=0)&&"true"===l[0].textContent,d=gz("RetrieveMultipleResult > Entities > Entity, Results > KeyValuePairOfstringanyType > value > Entities > Entity",r);return d.length<=0?jz({values:[],pagingCookie:o,totalRecordCount:u,totalRecordCountLimitExceeded:c}):Promise.all(d.map((e=>Vz.addFunction(aK,null,e)))).then((r=>(t._pagingCookie=o,t._hasMoreRecords=i,Promise.all([tK(r,t),rK(e,r,t)])))).then((([e])=>jz({values:e,pagingCookie:o,totalRecordCount:u,totalRecordCountLimitExceeded:c})))}))},executeMultipleResponseParser:function(e,t){return Pz((()=>{const[,r]=gz("ExecuteResult > Results > KeyValuePairOfstringanyType",e.responseXML),n=gz("ExecuteMultipleResponseItem",r,"http://schemas.microsoft.com/xrm/2012/Contracts"),i=[];for(let e=0,r=n.length;e<r;e++){const r=t[e].soapAPIParsers,a=gz('Fault:not([*|nil="true"])',n[e]);if(a.length<=0||eV(a.textContent)){const[t]=gz("Response",n[e],"http://schemas.microsoft.com/xrm/2012/Contracts"),a=new Ez({responseXML:t});i.push(r.then(nK(a)).then((e=>$z(null,e)),(e=>Promise.reject($z(null,e,!1)))))}else{const e=new Ez({responseXML:a[0]});i.push(r.then(iK(e)).then((e=>$z(null,e,!1)),(e=>Promise.reject($z(null,e,!1)))))}}return Promise.all(i)}))},executeTransactionResponseParser:function(e,t){return Pz((()=>{const r=gz("Results > KeyValuePairOfstringanyType > value > OrganizationResponse",e.responseXML),n=[];for(let e=0,i=r.length;e<i;e++){const i=t[e].soapAPIParsers,a=new Ez({responseXML:r[e]});n.push(i.then(nK(a)).then((e=>$z(null,e)),(e=>Promise.reject($z(null,e,!1)))))}return Promise.all(n)}))},whoAmIResponseParser:function(e){return Pz((()=>{const t=gz("ExecuteResult > Results > *, Response > Results > *",e.responseXML);return Array.from(t).reduce((async(e,t)=>{const[r,n]=await Promise.all([e,oK(t)]);return{...r,[n.key]:n.value}}),{})}))}};const dK="DisplayName",fK="DisplayCollectionName",pK="EntityColor",mK="ObjectTypeCode",hK="PrimaryNameAttribute",gK="IsActivityParty",yK="IsCustomEntity",bK="IconLargeName",vK="IconMediumName",wK="IconSmallName",OK="PrimaryIdAttribute",SK="DisplayName",CK="DefaultValue",EK="Options",AK="RequiredLevel",RK="Format",PK="MaxLength",IK="MinValue",NK="MaxValue",TK="Precision",xK="PrecisionSource",kK="Direction";function MK(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}var $K=new WeakMap,DK=new WeakSet;class LK extends kB{constructor(e,t,r){var n,i;super(e,t,r),MK(n=this,i=DK),i.add(n),function(e,t,r){MK(e,t),t.set(e,r)}(this,$K,{writable:!0,value:null}),this.rawAttributeMetadata=r}get displayName(){return this.rawAttributeMetadata[SK]}get name(){return this.logicalName}get schemaName(){throw new Error("The AttributeMetadata-property schemaName was removed")}get requiredLevel(){return this.rawAttributeMetadata[AK]}get format(){return this.rawAttributeMetadata[RK]}get maxLength(){return this.rawAttributeMetadata[PK]}get maxValue(){return this.rawAttributeMetadata[NK]}get minValue(){return this.rawAttributeMetadata[IK]}get precision(){return this.rawAttributeMetadata[TK]}get precisionSource(){return this.rawAttributeMetadata[xK]}get direction(){return this.rawAttributeMetadata[kK]}get defaultValue(){return this.rawAttributeMetadata[CK]}getOptions(){return Array.from(this.rawAttributeMetadata[EK]||[])}getOption(e){return function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}(this,DK,jK).call(this)[e]}getOptionText(e,t="???"){const r=this.getOption(e)||{};return r&&r.text||t}}function jK(){return null!=this.optionsIndexer?this.optionsIndexer:null==this.rawAttributeMetadata[EK]?{}:(this.optionsIndexer=this.rawAttributeMetadata[EK].reduce(((e,t)=>{const{value:r}=t;return e[r]=t,e}),{}),this.optionsIndexer)}function _K(e,t,r){!function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,t),t.set(e,r)}function qK(e,t,r,n){return FK(e,t),UK(r,"set"),function(e,t,r){if(t.set)t.set.call(e,r);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=r}}(e,r,n),n}function VK(e,t,r){return FK(e,t),UK(r,"get"),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,r)}function UK(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}function FK(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}var BK=new WeakMap;class zK extends ez{constructor(e,t){super(e,t),_K(this,BK,{writable:!0,value:{}}),this.rawMetadata=t}static getCached(e){return VK(zK,zK,KK)[(e||"").toLowerCase()]}static clearCache(){qK(zK,zK,KK,{})}get displayName(){return this.rawMetadata[dK]||""}get displayCollectionName(){return this.rawMetadata[fK]||""}get iconLargeUrl(){let e=this.rawMetadata[bK];return String.isNullOrEmpty(e)||(e=tX.getWebResourceUrl(e)),e}get iconMediumUrl(){let e=this.rawMetadata[vK];return String.isNullOrEmpty(e)||(e=tX.getWebResourceUrl(e)),e}get iconSmallUrl(){let e=this.rawMetadata[wK];return e=String.isNullOrEmpty(e)?WK(this.objectTypeCode):tX.getWebResourceUrl(e),e}get entityColor(){return this.rawMetadata[pK]}get objectTypeCode(){const e=this.rawMetadata[mK];return null!=e?parseInt(e,10):null}get primaryIdAttribute(){return this.rawMetadata[OK]||`${this.logicalName}id`}get primaryNameAttribute(){return this.rawMetadata[hK]}get schemaName(){throw new Error("The EntityMetadata property schemaName was removed")}get isActivityParty(){return this.rawMetadata[gK]||!1}get isCustomEntity(){return this.rawMetadata[yK]||!1}_parseAttribute(e,t){const r=e?.toLowerCase()??e;return void 0===bV(this,BK)[r]&&(bV(this,BK)[r]=null!=t?new LK(this,r,t):null),bV(this,BK)[r]}get attributes(){return Object.keys(bV(this,BK)).length!==Object.keys(this.rawMetadata.Attributes)&&Object.entries(this.rawMetadata.Attributes).forEach((([e,t])=>this._parseAttribute(e,t))),{...bV(this,BK)}}getAttribute(e){const t=e?.toLowerCase()??e;return this._parseAttribute(t,this.rawMetadata.Attributes[t])}getOptions(e){const t=this.getAttribute(e);return t?t.getOptions():[]}static async get(e,t=null){const r=new FB(e,t,!1,zK.getCached(e)),n=await r.search();if(null!=n.cached)return n.cached;if(null==n.raw)throw new Error(`Error in get Entity for ${e}`);const i=new zK(e,n.raw);return VK(zK,zK,KK)[e]=i,i}static async getAttribute(e,t,r=!1){const n=await zK.getAttributes(e,[t],r);return null==n||n.length<=0?null:n[0]}static async getAttributes(e,t,r=!1){if(null==t||0===t.length)throw new Error("No attributes passed to static EntityBase.getAttributes");const n=await zK.get(e,t,r),i=t.map((e=>n.getAttribute(e)));if(null==i||0===i.length){if(!0===r)throw new Error(zV(`EntityBase.getAttributes(${e}, ${t}, [${r}])`,`No metadata found for attribute "${t}" on entity "${e}".`,"Please check attribute spelling or if attributes exists."));return null}return i}static getOptionsCached(e,t){return zK.getCached(e)?.getOptions(t)??[]}static getOptions(e,t){const r=zK.getOptionsCached(e,t);return null!=r&&r.length>0?Promise.resolve(r):zK.get(e,[t]).then((r=>{if(null==r||null==r.getAttribute(t))throw new Error(`Metadata could not be found for entity ${e}, attribute ${t}`);return r.getOptions(t)}))}static getIconSmallUrlCached(e){const t=XK(e);return null!=t?t:WK(zK.getObjectTypeCodeCached(e))}static getIconSmallUrl(e){const t=XK(e);return null!=t?Promise.resolve(t):zK.get(e).then((e=>null!=e?e.iconSmallUrl:""))}}var KK={writable:!0,value:{}};function WK(e){let t="";return null!=e&&(t=parseInt(e,10)<1e4?`/_imgs/ico_16_${e}.gif`:tX.getCRMUrl(`/_Common/icon.aspx?cache=1&iconType=GridIcon&objectTypeCode=${e}`)),t}function XK(e){return zK.getCached(e)?.iconSmallUrl??null}function ZK(e){return HB("getEntityCached"),zK.getCached(e)}var GK={EntityMetadata:zK,EntityBase:ez,StorageManager:YF,Enums:FV,getPrimaryIdAttribute:function(e){return zK.getPrimaryIdAttribute(e)},getPrimaryIdAttributeCached:function(e){return HB("getPrimaryIdAttributeCached"),ez.getPrimaryIdAttributeCached(e)},getEntity:function(e,t){return zK.get(e,t)},getEntityCached:ZK,getEntities:function(...e){return Promise.all(e.map((e=>zK.get(e))))},isEntityLoaded:function(e){return null!=zK.getCached(e)},getAttribute:function(e,t){return zK.getAttribute(e,t)},getAttributeCached:function(e,t){HB("getAttributeCached");const r=ZK(e);return null!=r?r.getAttribute(t):null},getObjectTypeCode:function(e){return ez.getObjectTypeCode(e)},getObjectTypeCodeCached:function(e){return HB("getObjectTypeCodeCached"),ez.getObjectTypeCodeCached(e)},getOptionsCached:function(e,t){return HB("getOptionsCached"),zK.getOptionsCached(e,t)},getOptions:function(e,t){return zK.getOptions(e,t)},getIconSmallUrlCached:function(e){return HB("getIconSmallUrlCached"),zK.getIconSmallUrlCached(e)},getIconSmallUrl:function(e){return zK.getIconSmallUrl(e)},getLogicalCollectionName:function(e){return ez.getLogicalCollectionName(e)},importEntity:()=>{},importLogicalCollectionNames:()=>{}};function HK(e,t){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e.style[r]=t[r])}class JK{constructor(e,{dialogContainer:t=window.parent.document,width:r=600,height:n=400,mode:i="modal",hasCloseButton:a=!0,backgroundColor:o="white",zIndex:s=null}={},u=null,l){this._dialogContainer=t,this._url=e;const c=this._dialogContainer;this._size={height:Number.isInt(n)?`${Math.min(n,c.documentElement.clientHeight)}px`:n,width:Number.isInt(r)?`${Math.min(r,c.documentElement.clientWidth)}px`:r},this._isReady=!1,this._mode=i,this._resolve=null,this._reject=null,this._openPromise=null,this._showPromise=null,this._hasCloseButton=a,this._initFunctionName=u,this._returnFunction=l,this._backgroundColor=o,this._isClosed=!1;const d="26px";this._divBackground=c.createElement("DIV");const f={position:"absolute",width:"100%",height:"100%",top:"0px",opacity:"modeless"===i?.1:.5,backgroundColor:"modeless"!==i?"grey":"",display:"none"};null!=s&&(f.zIndex=s),"modeless"===i&&this._divBackground.addEventListener("click",(()=>{this.closeDialog()}),!1),HK(this._divBackground,f),this._divInlineDialog=c.createElement("DIV");const p={position:"absolute",top:0,left:0,height:"100%",width:"100%",display:"none",alignItems:"center",flexDirection:"column",justifyContent:"center"};null!=s&&(p.zIndex=s),HK(this._divInlineDialog,p);const m="progress"!==this._mode?"1px solid #EEE":"0";this._divCloseContainer=c.createElement("DIV"),HK(this._divCloseContainer,{width:this._size.width,height:d,margin:0,padding:0,backgroundColor:"white",textAlign:"right",display:this._hasCloseButton?"block":"none",boxShadow:"rgba(0, 0, 0, 0.2) 3px 4px 4px -1px",borderTop:m,borderLeft:m,borderRight:m}),this._divInlineDialog.appendChild(this._divCloseContainer),this._divCloseInnerContainer=c.createElement("DIV"),this._divCloseContainer.appendChild(this._divCloseInnerContainer),this._aInlineDialogCloseLink=c.createElement("A"),this._imgX=c.createElement("IMG"),this._imgX.src="/_imgs/CloseDialog.png",this._imgX.alt="Close",HK(this._imgX,{marginTop:"4px",marginRight:"4px",width:"19px",height:"19px",cursor:"pointer"}),this._aInlineDialogCloseLink.appendChild(this._imgX),this._aInlineDialogCloseLink.addEventListener("click",(()=>{this.closeDialog()}),!1),this._divCloseContainer.appendChild(this._aInlineDialogCloseLink),this._inlineDialogIFrame=c.createElement("IFRAME"),HK(this._inlineDialogIFrame,{height:this._hasCloseButton?`calc(${this._size.height} - 26px)`:this._size.height,width:this._size.width,border:0,backgroundColor:o,display:"none",boxShadow:"transparent"!==o?"rgba(0, 0, 0, 0.2) 3px 3px 5px -1px":"inherit",borderLeft:m,borderRight:m,borderBottom:m,borderTop:this._hasCloseButton?0:m}),this._divInlineDialog.appendChild(this._inlineDialogIFrame),c.body.appendChild(this._divBackground),c.body.appendChild(this._divInlineDialog)}proceedClosing({returnValue:e=null}={}){if(this._isClosed=!0,this._divInlineDialog.style.display="none",this._dialogContainer.body.removeChild(this._divInlineDialog),this._divBackground.style.display="none",this._dialogContainer.body.removeChild(this._divBackground),null!=this._returnFunction){const n=(t={returnValue:e},r=this._returnFunction,function(){r(t.returnValue)});window.setTimeout(n,1)}var t,r;this._resolve&&this._resolve({returnValue:e})}closeDialog({returnValue:e=null}={}){const t=JV.define("ORBIS.Core.Utils.Dialogs.Frame",this._inlineDialogIFrame.contentWindow);if(t._getAllOnClose){const r=t._getAllOnClose().map((t=>t({returnValue:e})));Promise.all(r).then((()=>this.proceedClosing({returnValue:e}))).catch((e=>console.warn(`The Dialog Closing was canceled by a promise ${e}`)))}else this.proceedClosing({returnValue:e})}show(e){return this.showPromise=new Promise((t=>{this._inlineDialogIFrame.src=this._url,"transparent"!==this._backgroundColor&&(this._divBackground.style.display="block",this._divInlineDialog.style.display="flex",this._inlineDialogIFrame.style.display="block"),this._inlineDialogIFrame.addEventListener("load",(()=>{!1===this._isClosed&&(this._divBackground.style.display="block",this._divInlineDialog.style.display="flex",this._inlineDialogIFrame.style.display="block"),this._isReady=!0,this._inlineDialogIFrame.contentWindow.dialogArguments=e,this._inlineDialogIFrame.contentWindow.inlineDialogArguments=e,this._inlineDialogIFrame.contentWindow.passedArguments=e;const r=JV.define("ORBIS.Core.Utils.Dialogs.Frame",this._inlineDialogIFrame.contentWindow);if(r._setOpener&&r._setOpener(this,e,wW()),this._inlineDialogIFrame.contentWindow.closeWindow=()=>{this.closeDialog({returnValue:this._inlineDialogIFrame.contentWindow.returnValue})},null!=this._initFunctionName){const t=JV.extract(this._initFunctionName,this._inlineDialogIFrame.contentWindow,null);"function"==typeof t&&t(e)}t()}),!1)})),null==this._resolve?(this._openPromise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})),this._openPromise):(console.log("Dialog.show() promise was not empty. The command will be ignored"),this._openPromise)}sendMessage(e){this.showPromise.then((()=>{this._inlineDialogIFrame&&this._inlineDialogIFrame.contentWindow&&this._inlineDialogIFrame.contentWindow.postMessage(e,"*")}))}}let YK=null,QK=[],eW=[],tW=null;var rW={_setOpener:function(e,t,r){if(YK=e,tW=t,SW(r),QK.length>0)for(const e of QK)e(t)},_getAllOnClose:function(){return eW},closeDialog:function({returnValue:e=null}={}){null!=YK?YK.closeDialog({returnValue:e}):(console.log("dialog cannot be closed, because the opener is missing. Trying with window.close"),window.close())},addOnClose:function(e){eW.push(e)},removeOnClose:function(e){eW=eW.filter((t=>t!==e))},addOnReady:function(e){QK.push(e)},removeOnReady:function(e){QK=QK.filter((t=>t!==e))},getDialogArguments:function(){return null!=tW?tW:window.dialogArguments}};const nW={LookupStyle:"LookupStyle",ShowNewButton:"ShowNewButton",Browse:"browse",ObjectTypes:"objecttypes",DefaultType:"DefaultType",DefaultViewId:"DefaultViewId",DisableQuickFind:"DisableQuickFind",AllowFilterOff:"AllowFilterOff",DisableViewPicker:"DisableViewPicker",RDependAttr:"rDependAttr",RId:"rId",RType:"rType",RelationshipId:"relationshipid",IsInlineMultiLookup:"IsInlineMultiLookup",CurrentObjectType:"CurrentObjectType",CurrentId:"CurrentId",Search:"search",SuppressFetch:"suppressfetch"},iW={Single:"single",Multi:"multi"},aW={True:"1",False:"0"},oW={True:"0",False:"1"},sW={True:"1",False:"0"},uW={True:"1",False:"0"},lW={True:"1",False:"0"};const cW=function({lookupStyle:e=iW.Single,objectTypeCodes:t=[],defaultObjectTypeCode:r=null,showNewButton:n=aW.True,isInlineMultiLookup:i=sW.True,defaultViewId:a=null,disableViewPicker:o=uW.False,search:s=null,suppressfetch:u=lW.False,lookupOptions:l={},currentid:c=null,currentObjectType:d=null}={}){const f={};f[nW.LookupStyle]=e,f[nW.ShowNewButton]=n,f[nW.Browse]=oW.True,f[nW.IsInlineMultiLookup]=i,f[nW.ObjectTypes]=t.join(","),f[nW.DefaultType]=r||(t.length>0?t[0]:""),c&&(f.currentid=c),d&&(f.currentObjectType=d),u===lW.True&&(f[nW.SuppressFetch]=u),null!=a&&(f[nW.DefaultViewId]=a),null!=s&&(f[nW.Search]=s),o===uW.True&&(f[nW.DisableViewPicker]=o);const p=Object.assign(f,l);return tX.getCRMUrl([xF.Xrm.getClientUrl(),"/_controls/lookup/lookupinfo.aspx"],p)};function dW(e,t,r,n){return this.customViews=e,this.availableViews=t,this.additionalFetchFilter=encodeURIComponent(r),this.additionalFetchFilterTypes=n,this.items=[],this}var fW={Enums:Object.freeze({__proto__:null,Options:nW,LookupStyle:iW,ShowNewButton:aW,Browse:oW,IsInlineMultiLookup:sW,DisableViewPicker:uW,SuppressFetch:lW}),getUrl:cW,openDialog:function({lookupStyle:e=iW.Single,objectTypeCodes:t=[],defaultObjectTypeCode:r=null,showNewButton:n=aW.True,isInlineMultiLookup:i=sW.True,defaultViewId:a=null,disableViewPicker:o=uW.False,search:s=null,suppressfetch:u=lW.False,lookupOptions:l={},currentid:c=null,currentObjectType:d=null}={},{width:f=600,height:p=600}={},{customViews:m=null,additionalFetchFilter:h=null,additionalFetchFilterTypes:g=null,viewsIds:y=null}={},b=null){const v=cW({lookupStyle:e,objectTypeCodes:t,defaultObjectTypeCode:r,showNewButton:n,isInlineMultiLookup:i,defaultViewId:a,disableViewPicker:o,search:s,suppressfetch:u,lookupOptions:l,currentid:c,currentObjectType:d}),w=new dW(m,y,h,g),O=wW()||"undefined"!=typeof Xrm?Xrm:null;if(null!=O)O.Utility.openDialog(v,{width:f,height:p,openInNewWindow:!1},w,null,(e=>{null!=b&&window.setTimeout((()=>b(e)),1)}));else{new JK(v,{width:f,height:p,mode:"modal",hasCloseButton:!0},null,b).show()}},open:function(e){null==(e=e||{}).allowMultiSelect&&(e.allowMultiSelect=!1);const t=wW();return t&&t.Utility&&t.Utility.lookupObjects?new Promise(((r,n)=>t.Utility.lookupObjects(e).then((e=>{e&&e.map((e=>{if(null==e.entityType||isNaN(e.entityType)){if(null!=e.type&&isNaN(e.type))return e.entityType=e.type,e;null!=e.typename&&isNaN(e.typename)&&(e.entityType=e.typename)}return e})),r(e||[])}),(e=>{String.isNullOrEmpty(e)?r([]):n(new Error(e))})))):Promise.reject(new Error("parentXrm could not be found for lookupObjects"))},createCustomView:function(e,t,r,n,i,a,o=1){return{id:e,entityName:t,name:r,fetchXml:n,layoutXml:i,isDefaultView:a,recordType:o}}};const pW=function(e,t={},r=null){if(null==r)return;const{message:n}=t;String.isNullOrEmpty(e)&&(e="orb_/ORBIS/Core/Utils/Dialogs/Progress.html");const i=tX.getWebResourceUrl(e),a=new JK(i,Object.assign({width:320,height:240,mode:"progress",hasCloseButton:!1,backgroundColor:"transparent",message:n},t));return a.show(),a.sendMessage(n),r.then((()=>a.closeDialog())).catch((()=>a.closeDialog())),{sendMessage(e){a.sendMessage(e)}}};var mW={openModalDialog:function(e,t={},r=null,n=null,i=null){const a=tX.getWebResourceUrl(e);new JK(a,Object.assign({width:600,height:400,mode:"modal",hasCloseButton:!0},t),n,i).show(r)},openModelessDialog:function(e,t={},r=null,n=null,i=null){const a=tX.getWebResourceUrl(e);new JK(a,Object.assign({width:600,height:400,mode:"modeless",hasCloseButton:!1},t),n,i).show(r)},openProgressDialog:pW,openProgressIndicator:function(e,t=null){return pW(null,{message:e},t)},openConfirmDialog:function(e,t){return new Promise(((r,n)=>{const i=wW();null!=i&&i.Navigation&&i.Navigation.openConfirmDialog?i.Navigation.openConfirmDialog(e,t).then(r,n):n(new Error("No parent.Xrm.Navigation.openConfirmDialog could be found in the current context"))}))},openAlertDialog:function(e,t){return new Promise(((r,n)=>{const i=wW();null!=i&&i.Navigation&&i.Navigation.openAlertDialog?i.Navigation.openAlertDialog(e,t).then(r,n):n(new Error("No parent.Xrm.Navigation.openAlertDialog could be found in the current context"))}))},openErrorDialog:function(e){return new Promise(((t,r)=>{const n=wW()||Xrm;null!=n&&n.Navigation&&n.Navigation.openErrorDialog?n.Navigation.openErrorDialog(e).then(t,r):r(new Error("No parent.Xrm.Navigation.openErrorDialog could be found in the current context"))}))},Lookup:fW,Frame:rW};let hW=null,gW=null;function yW(e,t=!1){if(null==gW&&null!=e||!0===t){const t=null!=e&&"function"==typeof e.getFormContext;gW=t?e.getFormContext():e}}function bW(){if(gW)return gW;if("undefined"!=typeof Xrm&&null!=Xrm&&null!=Xrm.Page&&null!=Xrm.Page.data)return Xrm.Page;if(null!=parent.Xrm&&null!=parent.Xrm.Page&&null!=parent.Xrm.Page.data)return parent.Xrm.Page;return"undefined"!=typeof Xrm&&null!=Xrm&&null!=Xrm.Page?Xrm.Page:null}function vW(){return window.Xrm||parent.Xrm}function wW(){if(null==hW){const e=window.parent.Xrm&&window.parent.Xrm.Page&&window.parent.Xrm.Page.data;hW=e?parent.Xrm:vW()}return hW}function OW(){return null!=window.parent.Xrm&&null!=window.parent.Xrm.Page&&null!=window.parent.Xrm.Page.data?window.parent:window}function SW(e){hW=e}function CW(e,t){!0===t?mW.openAlertDialog({text:e}):WV(`CoreXrm/alertMessage(message, ${t})`,e)}const EW={Save:1,SaveAndClose:2,SaveAndNew:59,AutoSave:70,SaveAsCompleted:58,Deactivate:5,Reactivate:6,Assign:47,Send:7,Qualify:16,Disqualify:15},AW={None:"none",Required:"required",Recommended:"recommended"},RW={Always:"always",Never:"never",Dirty:"dirty"},PW={Boolean:"boolean",DateTime:"datetime",Decimal:"decimal",Double:"double",Integer:"integer",Lookup:"lookup",Memo:"memo",Money:"money",MultiSelectOptionSet:"multiselectoptionset",OptionSet:"optionset",String:"string"},IW={Expanded:"expanded",Collapsed:"collapsed"},NW={Undefined:0,Create:1,Update:2,ReadOnly:3,Disabled:4,BulkEdit:6},TW={Recommendation:"RECOMMENDATION",Error:"ERROR"};var xW=Object.freeze({__proto__:null,FormSaveMode:EW,AttributeRequiredLevel:AW,AttributeSubmitMode:RW,ControlType:{Standard:"standard",Iframe:"iframe",KBSearch:"kbsearch",Lookup:"lookup",MultiSelectOptionSet:"multiselectoptionset",Notes:"notes",OptionSet:"optionset",QuickForm:"quickform",Subgrid:"subgrid",TimerControl:"timercontrol",TimelineWall:"timelinewall",WebResource:"webresource",CustomControl:"customcontrol:",CustomSubgrid:"customsubgrid:"},AttributeType:PW,AttributeFormat:{Date:"date",DateTime:"datetime",Duration:"duration",Email:"email",Language:"language",None:"none",Phone:"phone",Text:"text",Textarea:"textarea",TickerSymbol:"tickersymbol",Timezone:"timezone",Url:"url"},ClientState:{Online:"Online",Offline:"Offline"},Client:{Web:"Web",Outlook:"Outlook",Mobile:"Mobile"},FormFactor:{Unknown:0,Desktop:1,Tablet:2,Phone:3},TabState:IW,ProcessCallbackAnswerForSetActiveStage:{CrossEntity:"crossEntity",Invalid:"invalid",Unreachable:"unreachable",DirtyForm:"dirtyForm"},ProcessCallbackAnswerForSetActiveProcess:{Success:"success",Invalid:"invalid"},ProcessCallbackAnswerForSetActiveProcessInstance:{Success:"success",Invalid:"invalid"},ProcessCallbackAnswerForMoveNext:{Success:"success",CrossEntity:"crossEntity",End:"end",Invalid:"invalid",DirtyForm:"dirtyForm"},ProcessCallbackAnswerForMovePrevious:{Success:"success",CrossEntity:"crossEntity",End:"end",Invalid:"invalid",DirtyForm:"dirtyForm"},FormType:NW,ControlNotificationLevel:TW,FormNotificationLevel:{Info:"INFO",Warning:"WARNING",Error:"ERROR"}});const kW=new Map,MW=[];let $W=null,DW=!1;function LW(e,t,r){null!=e?.setSharedVariable?(e.setSharedVariable("orbis_isSaveSuppressed",t),e.setSharedVariable("orbis_isSaveResolved",r)):WV("addOnSaveAsync","could not set internal save state.")}function jW(e){DW=!1,e?.setSharedVariable("orbis_isSaveStarted",!0)}function _W(e){console.info("[ORBIS.Core] Blocking save event intentionally in order to make an asynchronous request.");const t="function"!=typeof e?.getEventArgs,r="function"!=typeof e?.getEventArgs()?.preventDefault;t&&r||WV("addOnSaveAsync","Blocking save event failed because context ist missing."),e?.getEventArgs()?.preventDefault()}function qW(e=!1){const t=bW();return"function"!=typeof t?.data?.save?(WV("Save","Cannot perform save."),Promise.resolve()):(DW=!0,new Promise(((r,n)=>{const i=function(e){const t=e=>{console.debug("[ORBIS.Core] Xrm.Page.data.save() returned null or an object without a catch or fail method to attach to."),"function"==typeof e&&e()};if(null==e)return t;if("function"==typeof e.catch)return e.catch.bind(e);if("function"==typeof e.fail)return e.fail.bind(e);return t}(t.data.save().then(((...n)=>{!0===e&&"function"==typeof t?.ui?.close&&window.setTimeout((()=>{t?.ui?.close()}),0),r(...n)}),n));i(n)})))}function VW(e){return LW(e,!1,null),!1}function UW(e){if(0===MW.length)return[];const t=[];return kW.forEach(((r,n)=>{try{null!=r&&!0!==r(e)||t.push(n)}catch(e){console.error("[ORBIS.Core] Error in addOnSaveAsync execution condition. The callback won't be executed",e)}})),t}function FW(e,t){if(null==bW())return null;const r=e||UW(t);return Promise.all(r.reduce(((e,r)=>null==r||"function"!=typeof r?e:[...e,r(t)]),[]))}function BW(e){if(function(e){return!0===DW?(jW(e),!0):e?.getSharedVariable("orbis_isSaveStarted")??!1}(e))return;jW(e);const t=UW(e);0!==t.length&&(function(e){return e?.getSharedVariable("orbis_isSaveSuppressed")??!1}(e)?_W(e):function(e){return e?.getSharedVariable("orbis_isSaveResolved")??!1}(e)||(function(e){LW(e,!0,!1),_W(e)}(e),function(e,t){const r=e?.getEventArgs()?.getSaveMode()??EW.Save;(r!==EW.SaveAndClose?zW:KW)(e,t)}(e,t)))}async function zW(e,t){if(null==$W)return qW();try{return await FW(t,e),function(e){return LW(e,!1,!0),qW()}(e)}catch{return Promise.reject(VW(e))}}async function KW(e,t){if(null==$W)return qW(!0);try{return await FW(t,e),function(e){return LW(e,!1,!0),qW(!0)}(e)}catch{return Promise.reject(VW(e))}}function WW(e,t){const r=bW();"function"==typeof r?.data?.entity?.addOnSave?(MW.push(e),kW.set(e,t),null==$W&&($W=BW,r.data.entity.addOnSave($W))):WV("addOnSaveAsync","addOnSaveAsync couldn't be attached. Xrm.Page.data.entity was null.")}function XW(e){const t=bW();if("function"!=typeof t?.data?.entity?.removeOnSave)return;const r=MW.indexOf(e);r>=0&&(MW.splice(r,1),kW.delete(e)),0===MW.length&&(t.data.entity.removeOnSave($W),$W=null)}const ZW=/^https?:\/\//i,GW=/\/?\$webresource:\/?/i,HW={clientUrl:null};function JW(){return JV.extract("clientUrl",HW,xF.Xrm.getClientUrl())}const YW=e=>{const t=Object.assign({},e);return Object.entries(t).reduce(((e,[t,r])=>{let n=[];if(Object.isNullOrUndefined(r))return e;const i=encodeURIComponent(t);return n=Array.isArray(r)?r.map((e=>`${t}=${encodeURIComponent(e)}`)):"object"==typeof r?[`${i}=${encodeURIComponent(YW(r))}`]:[`${i}=${encodeURIComponent(r)}`],[...e,...n]}),[]).join("&")},QW=(e,t)=>{const r=Object.isNullOrUndefined(e),n=String.isString(e),i=String.isNullOrWhiteSpace(e),a=Array.isArray(e);if(r||n&&i||!n&&!a)return"";const o=n?[e]:e.slice(),s=o.splice(0,1)[0],u=[...ZW.test(s)||"."===s[0]?[]:[JW()],s,...o],l=u.length-1,c=u.map(((e,t)=>(e=e.replace(GW,`${JV.extract("WEB_RESOURCE_ORG_VERSION_NUMBER",window,!1)||JV.extract("WEB_RESOURCE_ORG_VERSION_NUMBER",OW(),!1)||ORBIS.Namespace.extract("Xrm.Internal._context.ClientApiManager._store.getState.organization.organizationSettings.webResourceHash",window,!1,{autoExecute:!0})||ORBIS.Namespace.extract("Xrm.Internal._context.ClientApiManager._store.getState.organization.organizationSettings.webResourceHash",OW(),"",{autoExecute:!0})}/webresources/`),t>0&&e.startsWith("/")&&(e=e.slice(1)),t<l&&!e.endsWith("/")?e=`${e}/`:t===l&&e.endsWith("/")&&(e=e.slice(0,-1)),e))).join(""),d=YW(t),f=c.indexOf("?")>=0;return String.isNullOrWhiteSpace(d)?c:f?`${c}&${d}`:`${c}?${d}`},eX=(e,t,r,n)=>{const i=!String.isNullOrWhiteSpace(e),a=!Object.isNullOrUndefined(n)&&Number.isInteger(n),o=xF.Xrm.client.getClient()===xF.Enums.Client.Outlook;if(!i)return WV("Url.getENtityRecordUrlCached","Error in ORBIS.Core.Utils.Url.getEntityRecordUrl. An entityLogicalName must be provided."),null;if(!a&&o&&(n=GK.getObjectTypeCodeCached(e),Object.isNullOrUndefined(n)))return WV("Url.getEntityRecordUrlCached",`Error in ORBIS.Core.Utils.Url.getEntityRecordUrl. Metadata for entity ${e} was not found in cache.`),null;const s={};return!0===a&&(s.etc=n),QW("/main.aspx?pagetype=entityrecord",Object.assign({etn:e,newWindow:"true",id:t,extraqs:r},s))};var tX={_defaults:HW,getCRMUrl:QW,getWebResourceUrl:(e,t)=>{const r=/^(?:https?:\/\/|\.\/|\.\.\/)|(\$?webresource[:/])/i.test(e);return QW(r?e:["$webresource:",e],t)},getEntityRecordUrlCached:eX,getEntityRecordUrl:(e,t,r)=>xF.Xrm.client.getClient()===xF.Enums.Client.Outlook?GK.getObjectTypeCode(e).then((n=>eX(e,t,r,n))):Promise.resolve(eX(e,t,r)),generateGetParams:YW,getWebAPIUrl:()=>`${JW()}/api/data/v${function(){let e=JV.extract("ORBIS.WEB_API_VERSION",window,!1);if(!1!==e)return e;if(e=xF.Xrm.getVersion(),!String.isNullOrWhiteSpace(e)){const[t,r]=e.split(".");return`${t}.${r}`}return"9.1"}()}`,getSoapUrl:()=>JW()+"/XRMServices/2011/Organization.svc/web",getEntityListUrl:(e,t)=>{let r=YW(t);return String.isNullOrWhiteSpace(r)||(r=`&${r}`),QW(`/main.aspx?etn=${e}&pagetype=entitylist${r}`)}};function rX(e,t){iX(e,t),t.add(e)}function nX(e,t,r){iX(e,t),t.set(e,r)}function iX(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aX(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}const oX={body:void 0,headers:{Accept:iV.JSON,"OData-MaxVersion":"4.0","OData-Version":"4.0"},method:nV.GET,parser:kX,errorParser:MX,url:void 0,valid:!0},sX={method:void 0,params:void 0,parser:kX,errorParser:MX,valid:!1},uX={body:void 0,headers:{Accept:iV.XML,"Content-Type":`${iV.XML}; charset=utf-8`,SoapAction:dV.Execute},method:nV.POST,parser:()=>Promise.resolve(),errorParser:cK.errorResponseParser,url:void 0,valid:!1},lX={api:sV.WebAPI,impersonateAs:null,displayError:!1},cX={[sV.Offline]:()=>sX,[sV.SOAP]:()=>uX,[sV.WebAPI]:()=>oX};var dX=new WeakMap,fX=new WeakMap,pX=new WeakMap,mX=new WeakMap,hX=new WeakMap,gX=new WeakMap,yX=new WeakMap,bX=new WeakMap,vX=new WeakSet,wX=new WeakMap,OX=new WeakMap,SX=new WeakSet,CX=new WeakSet,EX=new WeakSet;class AX{constructor(e,t,r){rX(this,EX),rX(this,CX),rX(this,SX),rX(this,vX),nX(this,dX,{writable:!0,value:{}}),nX(this,fX,{writable:!0,value:cX}),nX(this,pX,{writable:!0,value:"Request"}),nX(this,mX,{writable:!0,value:sV.WebAPI}),nX(this,hX,{writable:!0,value:null}),nX(this,gX,{writable:!0,value:null}),nX(this,yX,{writable:!0,value:null}),nX(this,bX,{writable:!0,value:dU((async()=>{const{[sV.WebAPI]:e}=bV(this,fX),{[sV.WebAPI]:t}=bV(this,dX);return"function"!=typeof e?Gq(Object.create(null),oX,{valid:!1}):(vV(this,hX,Gq(Object.create(null),oX,await TX(e(bV(this,dX))),xX(bV(this,dX)),t)),bV(this,hX))}))}),nX(this,wX,{writable:!0,value:dU((async()=>{const{[sV.Offline]:e}=bV(this,fX),{[sV.Offline]:t}=bV(this,dX);return"function"!=typeof e?Gq(Object.create(null),sX,{valid:!1}):(vV(this,gX,Gq(Object.create(null),sX,await TX(e(bV(this,dX))),xX(bV(this,dX)),t)),bV(this,gX))}))}),nX(this,OX,{writable:!0,value:dU((async()=>{const{[sV.SOAP]:e}=bV(this,fX),{[sV.SOAP]:t}=bV(this,dX);return"function"!=typeof e?Gq(Object.create(null),uX,{valid:!1}):(vV(this,yX,Gq(Object.create(null),uX,await TX(e(bV(this,dX))),t)),bV(this,yX))}))}),vV(this,dX,e??bV(this,dX)),vV(this,fX,t??bV(this,fX)),vV(this,pX,r??bV(this,pX)),vV(this,mX,bV(this,dX).api??bV(this,mX))}get name(){return bV(this,pX)}get API(){return bV(this,mX)}set API(e){vV(this,mX,e)}get requestData(){return Gq(Object.create(null),lX,bV(this,dX))}get isValidWebAPI(){return aX(this,EX,NX).call(this,this.webAPIOptions)}get webAPIOptions(){return null!=bV(this,hX)?Promise.resolve(bV(this,hX)):bV(this,bX).call(this)}get webAPIBatch(){return aX(this,vX,RX).call(this)}get webAPIParsers(){return aX(this,CX,IX).call(this,this.webAPIOptions)}get isValidOfflineAPI(){return aX(this,EX,NX).call(this,this.offlineAPIOptions)}get offlineAPIOptions(){return null!=bV(this,gX)?Promise.resolve(bV(this,gX)):bV(this,wX).call(this)}get offlineAPIParsers(){return aX(this,CX,IX).call(this,bV(this,gX))}get isValidSoapAPI(){return null!=bV(this,yX)?Promise.resolve(bV(this,yX)):aX(this,EX,NX).call(this,this.soapAPIOptions)}get soapAPIOptions(){return bV(this,OX).call(this)}get soapOrganizationRequest(){return aX(this,SX,PX).call(this)}get soapAPIParsers(){return aX(this,CX,IX).call(this,this.soapAPIOptions)}static generateGetParams(e,t,r=!1){let n=e??Object.create(null);const i=t??Object.create(null);n=tV(n)&&!eV(n)?{_:n,...i}:{...n,...i};const a=Object.entries(n).map((([e,t])=>"_"===e?t:Array.isArray(t)?t.map((t=>`${e}=${r?t:encodeURIComponent(t)}`)):`${e}=${r?t:encodeURIComponent(t)}`)).join("&");return eV(a)?"?":`?${a}`}}async function RX(){const e=await this.webAPIOptions,t=eV(e.body)?"":`${e.body}\n`,{method:r,url:n,headers:i}=e;return[`${r} ${tX.getWebAPIUrl()}/${n} HTTP/1.1\n`,`${_X(i)}\n\n`,`${t}`].join("")}async function PX(){const{organizationRequest:e}=await this.soapAPIOptions;return e}async function IX(e){const{parser:t,errorParser:r}=await e;return{success:t,error:r}}async function NX(e){const{valid:t}=await e;return t??!1}function TX(e){return null==e||"function"!=typeof e.then?Promise.resolve(e):e}function xX(e){const t=new AV(GV("impersonateAs",e,null));return t.isValid?{headers:{MSCRMCallerID:t.toString()}}:null}function kX(e){if(!!(null==e||eV(e.responseText)))return Promise.resolve();try{return Promise.resolve(JSON.parse(e.responseText))}catch(e){throw XV("Request/defaultResponseParser(xhr)","Error parsing JSON response."),e}}function MX(e){const t={code:"Unknown",message:"Unable to parse error message. Please debug XHR object."};if(null==e||eV(e.responseText))return Promise.resolve(t);try{const r=JSON.parse(e.responseText);t.message=GV("Message",r,GV("error.message",r,t.message)),t.code=GV("ErrorCode",r,GV("error.code",r,t.code)),t.stack=GV("StackTrace",r,GV("error.stacktrace",r,GV("error.innererror.stacktrace",r,null))),t.type=GV("Type",r,GV("error.type",r,GV("error.innererror.type",r,null)))}catch(r){t.code=e.status,t.message=`Error ${e.status}:  ${e.statusText} while executing ${e.responseURL}`}return Promise.resolve(t)}async function $X(e,t){const r=e||[];if(r.length<=0)return{};const n=await ez.get(t,e),i=r.reduce(((e,r)=>{if(eV(r))return e;const i=n.getAttribute(r);if(null==i)throw new Error(zV(`Request/generateSelectParams(Array, ${t})`,`Entity "${t}" does not contain attribute "${r}".`,"Please check spelling or if the attribute exists."));return i.isPartyList?(WV(`Request/generateSelectParams(Array, ${t})`,`Attribute "${r}" in "${t}" is of type PartyList and cannot be added to $select".`),e):(e.push(i.isEntityReference?`_${r}_value`:r),e)}),[]);return i.length<=0?{}:{$select:i.join(",")}}function DX({id:e=null}={}){return"string"==typeof e?new AV(e).toString():e.constructor===AV?e.toString():Object.entries(e).reduce(((e,[t,r])=>{const n="number"==typeof r||function(e){if(!tV(e)||eV(e))return!1;return e.startsWith("_")&&e.endsWith("_value")}(t)?r:`'${r}'`;return e.push(`${t}=${n}`),e}),[]).join(",")}function LX(e,t="If-Match"){let r=GV("etag",e,!1);const n=GV("entity.@meta.etag",e,null);return!1===r||!0===r&&(r=n,Object.isNullOrUndefined(r))?null:{[t]:r||n}}function jX(e,t,r=!1){if(null==e||Array.isArray(e))throw new Error(zV(`Request/sanitizeId(${e}, ${t})`,`Invalid "id" in "${t}" with value "${e}"`,'Expected "id" to be of type string or object but got null, undefined or array instead.'));const n=tV(e),i=e.constructor===AV,a=Qq(e);if(n||i){const r=n?new AV(e):e;if(!r.isValid)throw new Error(zV(`Request/sanitizeId(${e}, ${t})`,`Invalid id in "${t}" with value "${e}"`,"The id was of type string or ORBIS.Core.Utils.GUID but the content is not a valid guid."));return r.toString()}if(a&&!1===r)throw new Error(zV(`Request/sanitizeId(object, ${t})`,'Alternate keys are not supported for this request."'));if(!a)throw new Error(zV(`Request/sanitizeId(${e}, ${t})`,`Invalid id in "${t}" with value "${e}"`,"The id is not of type string, ORBIS.Core.Utils.GUID or object (alternate keys)."));return e}function _X(e){return Object.entries(e||Object.create(null)).map((([e,t])=>`${e}: ${t}`)).join("\n")}function qX(...e){const[t,r,n]=e;return{...null!=t?{[sV.WebAPI]:t}:null,...null!=n?{[sV.Offline]:n}:null,...null!=r?{[sV.SOAP]:r}:null}}function VX(e){if(null==e)return{};if(!tV(e))return e;if(eV(e))return{};return(e.startsWith("?")?e.slice(1):e).split("&").reduce(((e,t)=>{if(eV(t))return e;const[r,n]=t.split("=");return{...e,[r]:n?.trim()}}),{})}const UX={};function FX(e,t){if(!t.type)return e;if(t.type===IV.DateTime){let r=!1;const n=mU.UTC;let i=hU.ISO8601;if(t)switch(t.behavior){case xV.DateOnly:i=hU.ISO8601DateOnly;case xV.TimeZoneIndependent:r=!0}e=VF.format(e,{isSourceUTC:r,targetDateZone:n,targetFormat:i})}switch(t.type){case IV.Money:case IV.Picklist:case IV.State:case IV.Status:return`<a:Value>${e}</a:Value>`;case IV.Owner:case IV.Lookup:case IV.Customer:return`<a:Id>${e.id}</a:Id><a:LogicalName>${e.entityType||e.logicalName}</a:LogicalName>`;case IV.PartyList:return`<a:Entities>${function(e,t){if(!Array.isArray(e))throw new Error(`Activityparty attributes must be of type Array. AttributeLogicalName: ${t.name}.`);let r="";return e.forEach((e=>{r+=["<a:Entity>","<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>partyid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${e.id}</a:Id>`,`<a:LogicalName>${e.logicalName}</a:LogicalName>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>","<a:LogicalName>activityparty</a:LogicalName>","</a:Entity>"].join("")})),r}(e,t)}</a:Entities>`;default:return e}}Object.keys(fV).forEach((e=>{UX[fV[e]]=e}));var BX={generateAttributeXML:async function e(t={},r){const n=await ez.get(r);if(null==n)throw new Error(zV(`SOAPHelper/generateAttributeXML(object, ${r})`,`No metadata found for entity "${r}".`,"Please check spelling or that the entity exists."));return(await Promise.all(Object.entries(t).reduce(((i,[a,o])=>{if(a.startsWith("@"))return i;if(a.includes("activity_parties")){const t={};return[...i,...o.map((n=>{const i=function(e,t){const r=UX[e].toLowerCase();let n;switch(r){case"requiredattendee":case"optionalattendee":case"resource":case"customer":case"partner":n=`${r}s`;break;case"regarding":n="regardingobjectid";break;default:n=r}"campaignresponse"===t&&(n=r);return n}(n.participationtypemask);return t[i]=t[i]||[],t[i].push(n.partyid),e(t,r)}))]}const s=n.getAttribute(a);if(!s)throw new Error(zV(`SOAP/Helper/generateAttributeXML(object, ${r})`,`No metadata found for attribute "${a}" on entity "${r}".`,"Please check spelling or that the attribute exists."));const[u,l]=function(e){const t=' xmlns:c="http://www.w3.org/2001/XMLSchema"';switch(e){case IV.Uniqueidentifier:return["c:guid",' xmlns:c="http://schemas.microsoft.com/2003/10/Serialization/"'];case IV.Boolean:return["c:boolean",t];case IV.DateTime:return["c:dateTime",t];case IV.Decimal:return["c:decimal",t];case IV.Double:return["c:double",t];case IV.Integer:return["c:int",t];case IV.Money:return["a:Money",""];case IV.Picklist:case IV.State:case IV.Status:return["a:OptionSetValue",""];case IV.Owner:case IV.Lookup:case IV.Customer:return["a:EntityReference",""];case IV.PartyList:return["a:EntityCollection",""];case IV.String:case IV.Memo:return["c:string",t];default:return[null,t]}}(s.type);if(null==u)return WV(`SOAP/Helper/generateAttributeXML(object, ${r})`,`Could not determine type of attribute "${a}" on entity "${r}".`,"Attribute will be skipped."),i;const c=null==o;return i.push(["<a:KeyValuePairOfstringanyType>",`<b:key>${a}</b:key>`,c?'<b:value i:nil="true"/>':`<b:value i:type="${u}"${l}>${FX(t[a],s)}</b:value>`,"</a:KeyValuePairOfstringanyType>"].join("")),i}),[]))).join("")}};const zX=/\/api\/data\/v[0-9]{1,2}\.[0-9]{1,2}\/(?:\$metadata#)?([a-z0-9_.]+)(?:.+)?$/i;async function KX(e){let t;if(null!=(t=e.match(/^offline:([a-z0-9_]+)\??/i)))return t[1];const r=await ez.getEntityNameByCollectionName(function(e){if(eV(e))return WV(`Request/contextToCollectionName(${e})`,"Request context is empty so no metadata can be retrieved."),null;const[,t]=e.match(zX);return eV(t)?(WV(`Request/contextToCollectionName(${e})`,"Collection name could not be extracted from context."),null):t}(e));return eV(r)?null:r}const WX=new fz(50);function XX(e,t,r=!1,n=null){return Object.entries(e||{}).reduce((async(e,[i,a])=>{if(i.startsWith("@"))return e;const[o,s]=await Promise.all([e,ZX(t,i,a,e,r,n)]);return{...o,...s}}),Promise.resolve({}))}function ZX(e,t,r,n,i,a){return void 0===r?{[t]:r}:null===r?async function(e,t,r,n){const i=await async function(e,t,r,n){if((await ez.getAttribute(e,t,!0)).isEntityReference)return!0!==r?(WV(`Entity/handlePossibleNullEntityReference(${e}, ${t}, ${r}, ${n})`,"Setting NULL-values for lookups is not supported by the Dynamics WebAPI.",`Use ORBIS.Core.Service.clearLookup("${e}", "${t}"); instead.`),null):(new AV(n).isValid||WV(`Entity/handlePossibleNullEntityReference(${e}, ${t}, ${r}, ${n})`,"Setting NULL-values for lookups via implicit clearLookup is only supported for valid record IDs."),await JH.clearLookup(e,n,t),null);return t}(e,t,r,n);return null!=i?{[i]:null}:{}}(e,t,i,a):Array.isArray(r)?async function(e,t,r,n){const i=await ez.get(e);if(!i.isActivity)throw new Error(zV(`Request/handlePartylistAttribute(${e}, ${t}, array)`,`Entity "${e}" is not an activity.`,`Partylist syntax as used for attrbute ${t} is only valid for partylists on activities.`));const a=i.getAttribute(t);if(null==a)throw new Error(zV(`Request/handlePartylistAttribute(${e}, ${t}, array)`,`No metadata found for attribute "${t}" on entity "${e}".`,"Please check attribute spelling or if attribute exists."));const o=`${e}_activity_parties`;return Promise.props({[o]:Promise.all([...(await n)[o]||[],...r.map((async e=>{if(tV(e)&&function(e){return[MV.Sender,MV.ToRecipient,MV.CCRecipient,MV.BccRecipient].includes(e.participationTypeMask)}(a))return{participationtypemask:a.participationTypeMask,addressused:e};const t=GX(e),r=await ez.getLogicalCollectionName(t),n=new AV(e.id).toString();return{participationtypemask:a.participationTypeMask,[`partyid_${t}@odata.bind`]:`/${r}(${n})`}}))])})}(e,t,r,n):VF.isValidDate(r)?async function(e,t,r){const n=await ez.getAttribute(e,t,!0);let i=!1;const a=mU.UTC;let o=hU.ISO8601;switch(n.behavior){case xV.DateOnly:o=hU.ISO8601DateOnly;case xV.TimeZoneIndependent:i=!0}return{[t]:VF.format(r,{isSourceUTC:i,targetFormat:o,targetDateZone:a})}}(e,t,r):eV(r.id)?{[t]:r}:async function(e,t,r){const n=GX(r),i=new AV(GV("id",r));if(!i.isValid)throw new Error(zV(`Request/handleLookupAttribute(${e}, ${t}, object)`,`Lookup attribute "${t}" on entity "${e}" does not contain a property called 'id' or the given id is not a valid GUID.`));const[a,o]=await Promise.all([ez.getNavigationPropertyName(e,t,n),ez.getTargetLogicalCollectionName(e,t,n)]);return{[`${a}@odata.bind`]:`/${o}(${i.toString()})`}}(e,t,r)}function GX(e){return GV("logicalName",e,GV("entityType",e))}const HX={autoExpand:!1,fetchAliasMapping:{},isRelated:!1};async function JX(e,t=null,r){const n=null==t?await async function(e){const t=await KX(e),r=await ez.get(t,[]);return null==r?(WV(`Request/contextToMetadata(${e})`,`No metadata found for entity "${t}".`),null):r}(e["@odata.context"]):await ez.get(t,[]),{logicalName:i,primaryIdAttribute:a}=n,o={...HX,...r};return Object.entries(e).reduce((async(t,[r,i])=>{if(!function(e,t){if(/@odata|@microsoft|^campaignactivity_activityparties/i.test(e))return!1;if(null==t)return!1;if(null!=t.ManagedPropertyLogicalName)return!1;return!0}(r,i))return t;const a=function(e){return e.replace("_x002e_",".").replace(/^_(.+?)_value/g,"$1")}(r),[s,u]=await Promise.all([t,YX({key:r,attributeName:a,value:i,json:e,metadata:n,...o})]);return s["@meta"].formattedValues={...s["@meta"].formattedValues,...QX(a,r,e)},null!=u["@related"]?{...s,"@related":{...s["@related"],...u["@related"]}}:{...s,...u}}),function(e,t,r){return Object.assign(Object.create(null),{"@meta":Object.create(null,{logicalName:{value:e,enumerable:!0,writable:!0,configurable:!0},primaryIdAttribute:{value:t,enumerable:!0,writable:!0,configurable:!0},formattedValues:{value:Object.create(null),enumerable:!0,writable:!0,configurable:!0},etag:{value:r,enumerable:!0,writable:!0,configurable:!0}})})}(i,a,e["@odata.etag"]))}async function YX(e={}){const{attributeName:t,autoExpand:r=!1,isRelated:n,json:i,key:a,value:o}=e,s=i[`${a}@odata.nextLink`];if(null!=s)return xF.isOffline()?function(e,t,r=!1){if(null==t)return{[e]:t};const n=t.API.split("}.{")[1].replace("}","");if("retrieveRecord"!==n&&!1===r)return{[e]:t};const{entityType:i,id:a,option:o}=t;return async function(e,t,r,n,i){const a=VX(i);if("retrieveRecord"===t){return{"@related":(await WX.addFunction(JH.retrieve,JH,r,n,void 0,{params:a,isRelated:!0,api:sV.Offline})).data["@related"]}}const o=await WX.addFunction(JH.retrieveMultiple,JH,r,a,{api:sV.Offline});return{[e]:GV("data.values",o,[])}}(e,n,i,a,o)}(a,s,r):async function(e,t,r=!1){if(!1===r)return{[e]:t};const n=await WX.addFunction(JH.retrieveNextLink,JH,t);return{[e]:GV("data.values",n,[])}}(a,s,r);const u=await async function(e={}){const{key:t,attributeName:r,json:n,fetchAliasMapping:i={},metadata:a}=e;try{if(null!=n?.[r]?.IsReferencedQueryCall)return null;const{entityName:e=a.logicalName,attributeName:o}=function(e,t){if(/[a-zA-Z0-9]+?_activity_parties$/i.test(e))return{entityName:"activityparty_collection"};if(!e.includes(".")){const r=GV(`@attributes.${e}`,t,{});return{entityName:r.entityName,attributeName:r.attributeName||e}}const[r,n]=e.split(".");let i=t[r];null==i&&(i=Array.from(t["@list"]).find((e=>!!r.startsWith(e)&&(t[r]=e,!0))));return{entityName:i,attributeName:n}}(r,i);if("activityparty_collection"===e)return{type:IV.PartyList};const s=await ez.getAttribute(e,o,!0);if(t===r&&null!=n[r]&&n[r].constructor==={}.constructor){const e=s.getTarget(r)??i?.[r]??async function(e){if(eV(e))return null;try{const t=e.split(".").slice(-1);return await ez.get(t),t}catch{}return null}(n[r]?.["@odata.type"])??null;return null==e?null:{entityLogicalName:e,type:IV.EntityCollection}}return s}catch{WV(`Request/getAttributeMetadata(${t})`,`Could not retrieve or generate metadata during parsing for attribute with name "${t}"`)}return null}(e);if(null!=u){if(u.type===IV.PartyList)return function(e,t){if(!Array.isArray(t)||t.length<=0)return{};const r=e.startsWith("campaignresponse")?DV:$V;return t.reduce((async(e,t)=>{const n=r[t.participationtypemask];if(eV(n))return e;const[i,a]=await Promise.all([e,JX(t,"activityparty")]);return{...i,[n]:[...i[n]||[],{...a.partyid,"@activitypartyid":a.activitypartyid}]}}),{})}(a,o);if(u.isEntityReference)return n?tZ(a,o,u):function(e){const{key:t,attributeName:r,value:n,json:i,attributeMetadata:a}=e,o=/^_(.+?)_value$/.test(r)?a.name:r;let s=i[`${t}@Microsoft.Dynamics.CRM.lookuplogicalname`]||a.getTarget(r)||null;null==s&&(WV("Entity/parseLookup(object)","Could not get target from lookup. Using first target in metadata as fallback."),[s]=a.targets||[]);const u=i[`${t}@OData.Community.Display.V1.FormattedValue`];return{[o]:Object.create(null,{id:{value:n,enumerable:!0,writable:!0},logicalName:{value:s,enumerable:!0,writable:!0,configurable:!0},entityType:{value:s,enumerable:!0,writable:!0,configurable:!0},name:{value:u||null,enumerable:!0,writable:!0,configurable:!0},toString:{value:()=>u||"(empty name)",enumerable:!1,writable:!1}})}}({...e,attributeMetadata:u});if(u.type===IV.DateTime)return eZ(t,o,u);if(u.type===IV.EntityCollection)return tZ(t,o,u);if(u.isOptionSet)return function(e,t){if(null==t||-1===t)return{};return{[e]:t}}(t,o)}return{[t]:o}}function QX(e,t,r){const n=r[`${t}@OData.Community.Display.V1.FormattedValue`];return eV(n)?{}:{[e]:n}}function eZ(e,t,r){const{behavior:n}=r,i=n===xV.TimeZoneIndependent||n===xV.DateOnly?mU.UTC:mU.UserTime;return{[e]:VF.parse(t,{isSourceUTC:!0,targetDateZone:i})}}function tZ(e,t,r){return Promise.props({"@related":Promise.props({[e]:JX(t,r.getTarget?.(e)??r.entityLogicalName)})})}function rZ(e){return!function(e){return vW().WebApi.offline.isAvailableOffline(e)}(e)}const nZ="RetrieveRequest",iZ={logicalName:"",id:null,columns:[],params:Object.create(null),disableActivityParties:!1,etag:!1};class aZ extends AX{constructor(e){const t={...iZ,...e},{id:r,logicalName:n,columns:i}=t;if(eV(n))throw new Error(zV("RetrieveRequest/generateDefaults(object)","The property logicalName is required to execute the request."));if(t.id=jX(r,nZ,!0),null!=i&&!Array.isArray(i))throw new Error(zV("RetrieveRequest/generateDefaults(object)","The columns property must be of type array."));super(t,qX(oZ,uZ,sZ),nZ)}}async function oZ(e){const{logicalName:t,columns:r,disableActivityParties:n}=e,i={...e.params},a=await ez.get(t,[]);if(a.isActivity&&!n){const e=eV(i.$expand)?"":`${i.$expand},`;e.includes("_activity_parties")||(i.$expand=`${e}${t}_activity_parties($select=_partyid_value,participationtypemask)`)}const o=AX.generateGetParams(i,await $X(r,t));return{url:`${a.logicalCollectionName}(${DX(e)})${o}`,headers:{Prefer:'odata.include-annotations="*"',...LX(e,"If-None-Match")},parser:cZ}}async function sZ(e){const{columns:t,id:r,isRelated:n,logicalName:i,params:a}=e;let o=!0;rZ(i)&&(console.error(zV("Requests/RetrieveRequest",`Entity '${i}' is not available offline.`)),o=!1);const s=AX.generateGetParams(a,await $X(t,i),!0);return Promise.props({method:"retrieveRecord",params:Promise.all([i,r,s]),parser:e=>function(e,t,r){null==e&&Promise.resolve();return JX(e,t,{isRelated:r})}(e,i,n),valid:o})}function uZ(e){const{logicalName:t,columns:r,id:n}=e,i=['<Retrieve xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',`<entityName>${t}</entityName>`,`<id>${n}</id>`,lZ(r),"</Retrieve>"].join(""),a=['<c:OrganizationRequest i:type="a:RetrieveRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>ColumnSet</b:key>",lZ(r,!0),"</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Retrieve</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:i,headers:{SoapAction:dV.Retrieve},parser:cK.retrieveResponseParser,organizationRequest:a,valid:!0}}function lZ(e=[],t=!1){const r=e||[],n=0===r.length,i=!0===n?'<a:Columns xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays"/>':['<a:Columns xmlns:b="http://schemas.microsoft.com/2003/10/Serialization/Arrays">',r.map((e=>`<b:string>${e}</b:string>`)).join(""),"</a:Columns>"].join("");return!1===t?['<columnSet xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">',`<a:AllColumns>${n.toString()}</a:AllColumns>`,i,"</columnSet>"].join(""):['<b:value i:type="a:ColumnSet">',`<a:AllColumns>${n.toString()}</a:AllColumns>`,i,"</b:value>"].join("")}async function cZ(e){return null==e||eV(e.responseText)?Promise.resolve():JX(JSON.parse(e.responseText))}function dZ(e,t){return Object.entries(e||{}).reduce((async(e,[r,n])=>{if(r.startsWith("@"))return e;const[i,a]=await Promise.all([e,fZ(t,r,n)]);return{...i,...a}}),Promise.resolve({}))}function fZ(e,t,r){return null==r?{[t]:r}:eV(r.id)?{[t]:r}:function(e,t,r){const n=GX(r),i=new AV(GV("id",r));if(!i.isValid)throw new Error(zV(`Request/handleLookupAttribute(${e}, ${t}, object)`,`Lookup attribute "${t}" on entity "${e}" does not contain a property called 'id' or the given id is not a valid GUID.`));return{[t]:{logicalname:n,id:i.toString()}}}(e,t,r)}const pZ="CreateRequest",mZ={logicalName:"",entity:Object.create(null),returnEntity:!1,returnAttributes:[],disableActivityParties:!0};class hZ extends AX{constructor(e){super({...mZ,...e},qX(gZ,bZ,yZ),pZ)}}async function gZ(e){const{logicalName:t,entity:r,returnEntity:n,returnAttributes:i,disableActivityParties:a}=e,[o,s,u]=await Promise.all([ez.getLogicalCollectionName(t),$X(i,t),XX(r,t)]),l={};(await ez.get(t,[])).isActivity&&!a&&(l.$expand=`${t}_activity_parties($select=_partyid_value,participationtypemask)`);return{url:`${o}${AX.generateGetParams({...!0===n?s:null,...!0===n?l:null})}`,method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`,...n?{Prefer:'return=representation, odata.include-annotations="*"'}:null},body:JSON.stringify(u),parser:vZ}}function yZ(e){const{logicalName:t,entity:r}=e;let n=!0;return rZ(t)&&(console.error(zV("Requests/CreateRequest",`Entity '${t}' is not available offline.`)),n=!1),Promise.props({method:"createRecord",params:Promise.all([t,dZ(r)]),parser:wZ,valid:n})}async function bZ(e){const{logicalName:t,entity:r}=e,n=await BX.generateAttributeXML(r,t),i=['<Create xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<entity xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">','<a:Attributes xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',n,"</a:Attributes>",`<a:LogicalName>${t}</a:LogicalName>`,"</entity>","</Create>"].join(""),a=['<c:OrganizationRequest i:type="a:CreateRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>",n,"</a:Attributes>",`<a:LogicalName>${t}</a:LogicalName>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>","<a:RequestName>Create</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:i,headers:{SoapAction:dV.Create},parser:cK.createResponseParser,organizationRequest:a,valid:!0}}function vZ(e){if(null==e)return Promise.resolve();const t=e.getResponseHeader("OData-EntityId");return null==t||this?.method===nV.PATCH?cZ(e):Promise.resolve(function(e){let t,r=AV.emptyString;null!==(t=/\(([a-f0-9-]+?)\)/i.exec(e))&&t.length>1&&([,r]=t);return new AV(r).toString()}(t))}function wZ(e){return Promise.resolve(new AV(e?.id??AV.emptyString).toString())}const OZ="UpsertRequest",SZ={logicalName:"",id:null,entity:Object.create(null),returnEntity:!1,returnAttributes:[],etag:!1,clearLookups:!1,prevent:pV.None};class CZ extends AX{constructor(e,t={},r=OZ){super({...SZ,...e,id:jX(e.id,OZ,!0)},{...qX(EZ),...t},r)}}async function EZ(e){const{logicalName:t,entity:r,returnEntity:n,returnAttributes:i,prevent:a,clearLookups:o}=e,s=DX(e),[u,l,c]=await Promise.all([$X(i||[],t),ez.getLogicalCollectionName(t),XX(r,t,o,s)]);return{url:`${l}(${s})${AX.generateGetParams({...!0===n?u:null})}`,method:nV.PATCH,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`,...!0===n?{Prefer:'return=representation, odata.include-annotations="*"'}:null,...a===pV.Update?{"If-None-Match":"*"}:null,...a===pV.Create?{"If-Match":"*"}:null,...a===pV.None||a===pV.Create?LX(e):null},body:JSON.stringify(c),parser:!0===n?cZ:vZ}}const AZ="UpdateRequest",RZ={logicalName:"",id:null,entity:Object.create(null),returnEntity:!1,returnAttributes:[],etag:!1,prevent:pV.Create,clearLookups:!0};class PZ extends CZ{constructor(e){super({...RZ,...e,id:jX(e.id,AZ,!0)},qX(void 0,NZ,IZ),AZ)}}function IZ(e){const{logicalName:t,id:r,entity:n}=e;let i=!0;return rZ(t)&&(console.error(zV("Requests/UpdateRequest",`Entity '${t}' is not available offline.`)),i=!1),Promise.props({method:"updateRecord",params:Promise.all([t,r,dZ(n)]),parser:cZ,valid:i})}async function NZ(e){const{id:t,logicalName:r,entity:n}=e,i=await BX.generateAttributeXML(n,r),a=['<Update xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<entity xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">','<a:Attributes xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',i,"</a:Attributes>",`<a:Id>${t}</a:Id>`,`<a:LogicalName>${r}</a:LogicalName>`,"</entity>","</Update>"].join(""),o=['<c:OrganizationRequest i:type="a:UpdateRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>",i,"</a:Attributes>",`<a:Id>${t}</a:Id>`,`<a:LogicalName>${r}</a:LogicalName>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>","<a:RequestName>Update</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:a,headers:{SoapAction:dV.Update},organizationRequest:o,valid:!0}}const TZ="AssignRequest";class xZ extends AX{constructor(e){e.targetId=jX(e.targetId,TZ),e.ownerId=jX(e.ownerId,TZ),super(e,qX(kZ,$Z,MZ),TZ)}}async function kZ(e){const{targetLogicalName:t,targetId:r,ownerLogicalName:n,ownerId:i}=e,[a,o]=await ez.getLogicalCollectionNames(t,n);return{url:`${a}(${r})`,method:nV.PATCH,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({"ownerid@odata.bind":`/${o}(${i})`})}}function MZ(e){const{targetLogicalName:t,targetId:r,ownerLogicalName:n,ownerId:i}=e;return IZ({...e,logicalName:t,id:r,ownerid:{logicalname:n,id:i}})}function $Z(e){const{targetLogicalName:t,targetId:r,ownerLogicalName:n,ownerId:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:AssignRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>Target</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${r}</a:Id>`,`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Assignee</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${i}</a:Id>`,`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Assign</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:AssignRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${r}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Assignee</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${i}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Assign</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const DZ="AssociateRequest";class LZ extends AX{constructor(e){e.idA=jX(e.idA,DZ),e.idB=jX(e.idB,DZ),super(e,qX(jZ,_Z),DZ)}}async function jZ(e){const{logicalNameA:t,idA:r,logicalNameB:n,idB:i,relationName:a}=e,[o,s]=await ez.getLogicalCollectionNames(t,n);return{url:`${o}(${r})/${a}/$ref`,method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({"@odata.id":`${tX.getWebAPIUrl()}/${s}(${i})`})}}function _Z(e){const{logicalNameA:t,idA:r,logicalNameB:n,idB:i,relationName:a}=e,o=t===n,s=['<Associate xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',`<entityName>${t}</entityName>`,`<entityId>${r}</entityId>`,'<relationship xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">',o?"<a:PrimaryEntityRole>Referencing</a:PrimaryEntityRole>":'<a:PrimaryEntityRole i:nil="true"/>',`<a:SchemaName>${a}</a:SchemaName>`,"</relationship>",'<relatedEntities xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">',"<a:EntityReference>",`<a:Id>${i}</a:Id>`,`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>',"</a:EntityReference>","</relatedEntities>","</Associate>"].join(""),u=['<c:OrganizationRequest i:type="a:AssociateRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${r}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Relationship</b:key>",'<b:value i:type="a:Relationship">',o?"<a:PrimaryEntityRole>Referencing</a:PrimaryEntityRole>":'<a:PrimaryEntityRole i:nil="true"/>',`<a:SchemaName>${a}</a:SchemaName>`,"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>RelatedEntities</b:key>",'<b:value i:type="a:EntityReferenceCollection">',"<a:EntityReference>",`<a:Id>${i}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</a:EntityReference>","</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Associate</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:s,headers:{SoapAction:dV.Associate},organizationRequest:u,valid:!0}}const qZ="CancelSalesOrderRequest";function VZ(e){return{url:"CancelSalesOrder",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({Status:e.statusCode,OrderClose:{"@odata.type":"Microsoft.Dynamics.CRM.orderclose",subject:e.subject,description:e.description||null,"salesorderid@odata.bind":`/salesorders(${e.id})`}})}}function UZ(e){const{subject:t,description:r,id:n,statusCode:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:CancelSalesOrderRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>OrderClose</c:key>",'<c:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<c:key>subject</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${t}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>description</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${r||""}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>salesorderid</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${n}</a: Id>`,"<a:LogicalName>salesorder</a:LogicalName>",'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>","<a:LogicalName>orderclose</a:LogicalName>","<a:RelatedEntities/>","</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CancelSalesOrder</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:CancelSalesOrderRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>OrderClose</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>subject</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${t}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>description</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${r||""}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>salesorderid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>salesorder</a:LogicalName>",'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>",'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>orderclose</a:LogicalName>","<a:RelatedEntities/>",'<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CancelSalesOrder</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const FZ="CloseIncidentRequest";function BZ(e){return{url:"CloseIncident",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({Status:e.statusCode,IncidentResolution:{subject:e.subject,description:e.description||null,timespent:e.timespent||0,"incidentid@odata.bind":`/incidents(${e.id})`}})}}function zZ(e){const{subject:t,description:r,timespent:n,id:i,statusCode:a}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:CloseIncidentRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>IncidentResolution</c:key>",'<c:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<c:key>subject</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${t}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>description</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${r||""}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>timespent</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:int">${n||0}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>incidentid</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${i}</a:Id>`,"<a:LogicalName>incident</a:LogicalName>",'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>","<a:LogicalName>incidentresolution</a:LogicalName>","<a:RelatedEntities/>","</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${a}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CloseIncident</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:CloseIncidentRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>IncidentResolution</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>subject</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${t}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>description</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${r||""}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>timespent</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:int">${n||0}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>incidentid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${i}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>incident</a:LogicalName>",'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>",'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>incidentresolution</a:LogicalName>","<a:RelatedEntities/>",'<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${a}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CloseIncident</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const KZ="CloseQuoteRequest";function WZ(e){return{url:"CloseQuote",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({Status:e.statusCode,QuoteClose:{subject:e.subject,description:e.description||null,"quoteid@odata.bind":`/quotes(${e.id})`}})}}function XZ(e){const{subject:t,description:r,id:n,statusCode:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:CloseQuoteRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>QuoteClose</c:key>",'<c:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<c:key>subject</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${t}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>description</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${r||""}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>quoteid</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,"<a:LogicalName>quote</a:LogicalName>",'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>","<a:LogicalName>quoteclose</a:LogicalName>","<a:RelatedEntities/>","</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CloseQuote</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:CloseQuoteRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>QuoteClose</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>subject</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${t}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>description</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${r||""}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>quoteid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>quote</a:LogicalName>",'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>",'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>quoteclose</a:LogicalName>","<a:RelatedEntities/>",'<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>CloseQuote</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const ZZ="DeleteRequest";class GZ extends AX{constructor(e){e.id=jX(e.id,ZZ,!0),super(e,qX(HZ,YZ,JZ),ZZ)}}async function HZ(e){const{logicalName:t}=e;return{url:`${await ez.getLogicalCollectionName(t)}(${DX(e)})`,headers:LX(e),method:nV.DELETE}}function JZ(e){const{logicalName:t,id:r}=e;let n=!0;return rZ(t)&&(console.error(zV("Requests/DeleteRequest",`Entity '${t}' is not available offline.`)),n=!1),{method:"deleteRecord",params:[t,r],valid:n}}function YZ(e){const{logicalName:t,id:r}=e,n=['<Delete xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',`<entityName>${t}</entityName>`,`<id>${r}</id>`,"</Delete>"].join(""),i=['<c:OrganizationRequest i:type="a:DeleteRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${r}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Delete</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:n,headers:{SoapAction:dV.Delete},organizationRequest:i,valid:!0}}const QZ="DisassociateRequest";class eG extends AX{constructor(e){e.idA=jX(e.idA,QZ),e.idB=jX(e.idB,QZ),super(e,qX(tG,rG),QZ)}}async function tG(e){const{logicalNameA:t,idA:r,relationName:n,idB:i}=e;return{url:`${await ez.getLogicalCollectionName(t)}(${r})/${n}(${i})/$ref`,method:nV.DELETE}}function rG(e){const{logicalNameA:t,idA:r,logicalNameB:n,idB:i,relationName:a}=e,o=['<Disassociate xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">',`<entityName>${t}</entityName>`,`<entityId>${r}</entityId>`,'<relationship xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">','<a:PrimaryEntityRole i:nil="true"/>',`<a:SchemaName>${a}</a:SchemaName>`,"</relationship>",'<relatedEntities xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts">',"<a:EntityReference>",`<a:Id>${i}</a:Id>`,`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>',"</a:EntityReference>","</relatedEntities>","</Disassociate>"].join(""),s=['<c:OrganizationRequest i:type="a:DisassociateRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Target</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${r}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${t}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Relationship</b:key>",'<b:value i:type="a:Relationship">','<a:PrimaryEntityRole i:nil="true"/>',`<a:SchemaName>${a}</a:SchemaName>`,"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>RelatedEntities</b:key>",'<b:value i:type="a:EntityReferenceCollection">',"<a:EntityReference>",`<a:Id>${i}</a:Id>`,'<a:KeyAttributes xmlns:d="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${n}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</a:EntityReference>","</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>Disassociate</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:o,headers:{SoapAction:dV.Disassociate},organizationRequest:s,valid:!0}}const nG={logicalName:null,params:Object.create(null)};class iG extends AX{constructor(e={}){super({...nG,...e,api:sV.WebAPI},qX(aG),"EntityDefinitionsRequest")}}function aG(e){const{logicalName:t,params:r}=e,n=["EntityDefinitions"];return eV(t)||n.push(`(LogicalName='${t}')`),null!=r&&n.push(AX.generateGetParams(r)),{url:n.join("")}}async function oG(e,t){const r=new Ez,n=/(?:.|[\n\r])*HTTP\/1\.\d (\d{3}) .*(?:\n|\r\n)([\s\S]*)(?=(?:\n|\r\n){2})(?:\n|\r\n)/i.exec(e);Array.isArray(n)&&n.length>0&&(r.status=parseInt(n[1],10),n[2].split("\n").forEach((e=>{const t=e.split(": "),n=t[0].trim();if(n.length>0)if(t.length>1){const e=t[1].trim();r.setResponseHeader(n,e.length>0?e:null)}else r.setResponseHeader(n,null)})),r.responseText=e.replace(n[0],"").trim());const{success:i,error:a}=await t.webAPIParsers,o=r.status<aV.BadRequest?i:a;try{const e=await o(r);return $z(r,e)}catch(e){return $z(r,e,!1)}}async function sG(e){return(await Promise.all(e.reduce(((e,t)=>t instanceof AX?[...e,t.soapOrganizationRequest||""]:e),[]))).join("")}class uG extends AX{constructor(e){if(e.api=sV.SOAP,!Array.isArray(e.requests))throw new Error(zV("ExecuteMultipleRequest.constructor(object)","Requests option must be of type array. Cannot proceed."));super(e,qX(lG,cG),"ExecuteTransactionRequest")}get webAPIBatch(){return(async()=>{const e=await this.webAPIOptions,t=eV(e.body)?"":`${e.body}\n`,{headers:r}=e;return[`${_X(r)}\n\n`,`${t}`].join("")})()}}async function lG(e){const{requests:t}=e,r=AV.newGuidString("N").toUpperCase().slice(-8);return{body:await fG(t,r),headers:{"Content-Type":`${iV.Mixed};boundary=changeset_${r}`},parser:e=>async function(e,t){if(!e||eV(e.responseText))return;try{const r=e.responseText,n=[];let i=null,a=0;const o=/--changesetresponse_[0-9a-f-]{36}([\s\S]*?)(?=--changesetresponse_[0-9a-f-]{36})/gim;for(;null!==(i=o.exec(r));)i.index===o.lastIndex&&o.lastIndex++,Array.isArray(i)&&i.length>1&&(n.push(oG(i[1],t[a])),a++);return $z(null,await Promise.all(n))}catch(e){return $z(null,e,!1)}}(e,t),valid:!1}}async function cG(e){const{returnResponses:t,requests:r}=e,n=await sG(r);return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" i:type="a:ExecuteTransactionRequest">','<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<b:key>Requests</b:key>",'<b:value xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts" i:type="c:OrganizationRequestCollection">',n,"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>ReturnResponses</b:key>",`<b:value xmlns:c="http://www.w3.org/2001/XMLSchema" i:type="c:boolean">${t||"true"}</b:value>`,"</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>ExecuteTransaction</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest i:type="a:ExecuteTransactionRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Requests</b:key>",'<b:value i:type="c:OrganizationRequestCollection">',n,"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>ReturnResponses</b:key>",`<b:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:boolean">${t||"true"}</b:value>`,"</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>ExecuteTransaction</a:RequestName>","</c:OrganizationRequest>"].join(""),parser:e=>cK.executeTransactionResponseParser(e,r),valid:!0}}const dG=[`Content-Type: ${iV.HTTP}`,"Content-Transfer-Encoding: binary"].join("\n");async function fG(e,t){return`${(await Promise.all(e.reduce(((e,r,n)=>r instanceof AX?[...e,`--changeset_${t}\n`,`${dG}\n`,`Content-ID: ${n}\n\n`,r.webAPIBatch]:e),[]))).join("")}--changeset_${t}--\n\n`}const pG={requests:[],continueOnError:!0,returnResponses:!0};class mG extends AX{constructor(e){super({...pG,...e,requests:yG(e.requests)},qX(hG,gG),"ExecuteMultipleRequest")}}async function hG(e){const{requests:t,continueOnError:r}=e,n=AV.newGuidString("N").toUpperCase().slice(-8);return{body:await vG(t,n),headers:{"Content-Type":`${iV.Mixed};boundary=batch_${n}`,"Content-Transfer-Encoding":"binary",...!0===r?{Prefer:"odata.continue-on-error"}:null},method:nV.POST,url:"$batch",parser:e=>async function(e,t){if(null==e||eV(e.responseText))return;const r=e.responseText,n=[];let i=null,a=0;const o=/--batchresponse_[0-9a-f-]{36}([\s\S]*?)(?=--batchresponse_[0-9a-f-]{36})/gim,s=/--changesetresponse_[0-9a-f-]{36}.*?/im;for(;null!==(i=o.exec(r));)if(i.index===o.lastIndex&&o.lastIndex++,Array.isArray(i)&&i.length>1){const[,r]=i;s.test(i[1])?n.push(t[a].webAPIParsers.then(wG(e,r))):n.push(oG(i[1],t[a])),a++}return Promise.all(n)}(e,t)}}async function gG(e){const{continueOnError:t,returnResponses:r,requests:n}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" i:type="a:ExecuteMultipleRequest">','<a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<b:key>Requests</b:key>",'<b:value xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts" i:type="c:OrganizationRequestCollection">',await sG(n),"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Settings</b:key>",'<b:value xmlns:c="http://schemas.microsoft.com/xrm/2012/Contracts" i:type="c:ExecuteMultipleSettings">',`<c:ContinueOnError>${t}</c:ContinueOnError>`,`<c:ReturnResponses>${r}</c:ReturnResponses>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>ExecuteMultiple</a:RequestName>","</request>","</Execute>"].join(""),parser:e=>cK.executeMultipleResponseParser(e,n),valid:!0}}function yG(e){if(!Array.isArray(e))throw new Error(zV("ExecuteMultipleRequest/generateBatches(array, guid)","Requests option must be of type array. Cannot proceed."));return e.map((e=>Array.isArray(e)?new uG({requests:e}):e))}const bG=[`Content-Type: ${iV.HTTP}`,"Content-Transfer-Encoding: binary"].join("\n");async function vG(e,t){return`${(await Promise.all(e.reduce(((e,r)=>[...e,`--batch_${t}\n`,r instanceof uG?"":`${bG}\n\n`,r.webAPIBatch]),[]))).join("")}--batch_${t}--`}function wG(e,t){return({success:r})=>r(new Ez({status:e.status,statusText:e.statusText,responseText:t}))}const OG="FulfillSalesOrderRequest";function SG(e){return{url:"salesorders/Microsoft.Dynamics.CRM.FulfillSalesOrder",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({Status:e.statusCode,OrderClose:{subject:e.subject,description:e.description||null,"salesorderid@odata.bind":`/salesorders(${e.id})`}})}}function CG(e){const{subject:t,description:r,id:n,statusCode:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:FulfillSalesOrderRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>OrderClose</c:key>",'<c:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<c:key>subject</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${t}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>description</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${r||""}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>salesorderid</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,"<a:LogicalName>salesorder</a:LogicalName>",'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>","<a:LogicalName>orderclose</a:LogicalName>","<a:RelatedEntities/>","</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>FulfillSalesOrder</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:FulfillSalesOrderRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>OrderClose</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>subject</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${t}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>description</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${r||""}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>salesorderid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>salesorder</a:LogicalName>",'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>",'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>orderclose</a:LogicalName>","<a:RelatedEntities/>",'<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>FulfillSalesOrder</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const EG={type:hV.All,params:Object.create(null)};class AG extends AX{constructor(e={}){super({...EG,...e,api:sV.WebAPI},qX(RG),"RelationshipDefinitionsRequest")}}function RG(e){const{type:t,params:r}=e,n=["RelationshipDefinitions"];return t!==hV.All&&n.push(`/${t}`),null!=r&&n.push(AX.generateGetParams(r)),{url:n.join("")}}async function PG(e,t,r){if(!Array.isArray(e)||e.length<=0)return Promise.resolve([]);const[n,...i]=e,a=await KX(t),o=await JX(n,a,r);return Promise.all([o,...i.map((e=>JX(e,a,r)))])}const IG="RetrieveMultipleRequest",NG={logicalName:null,params:Object.create(null),maxPageSize:null,autoExpand:!1,pages:null,pageCallback:null,_pageCount:1};class TG extends AX{constructor(e){super({...NG,...e,api:sV.WebAPI},qX(xG,null,kG),IG)}}async function xG(e){const{logicalName:t,retrieveParams:r}=e,n=null!=r&&!Hq(r)?AX.generateGetParams($G(e.params,r)):AX.generateGetParams(e.params);return{url:`${await ez.getLogicalCollectionName(t)}${n}`,headers:{Prefer:'odata.include-annotations="*"'+(e.maxPageSize?`, odata.maxpagesize=${e.maxPageSize}`:"")},parser:t=>async function(e,t={}){if(null==e||eV(e.responseText))return Promise.resolve(jz({values:[]}));const{autoExpand:r}=t,n=JSON.parse(e.responseText),i=Lz(n),{pagingCookie:a,nextLink:o,count:s,totalRecordCount:u,totalRecordCountLimitExceeded:l}=i;t._pagingCookie=a;let c=await PG(n.value,n["@odata.context"],{autoExpand:r});return qz(e,c,t,i),c=await async function(e,t,r={}){if(!DG(t,r))return e;r._pageCount=r._pageCount||1,r._pageCount++,delete r[sV.WebAPI];const n=await JH.retrieveNextLink(t["@odata.nextLink"],r);return[...e,...GV("data.values",n,[])]}(c,n,t),jz({values:c,pagingCookie:a,nextLink:o,count:s,totalRecordCount:u,totalRecordCountLimitExceeded:l})}(t,e)}}function kG(e){const{logicalName:t,retrieveParams:r,maxPageSize:n}=e;let i=!0;rZ(t)&&(console.error(zV(`Requests/${IG}`,`Entity '${t}' is not available offline.`)),i=!1);const a=function(e){const t=VX(e.params);eV(t?.$select)||(t.$select=MG(t.$select));eV(t?.$filter)||(t.$filter=MG(t.$filter));eV(t?.$expand)||(t.$expand=MG(t.$expand));return t}(e),o=null!=r&&!Hq(r)?AX.generateGetParams($G(a,r),void 0,!0):AX.generateGetParams(a,void 0,!0);return Promise.props({method:"retrieveMultipleRecords",params:[t,o,n],parser:t=>LG(t,e),valid:i})}function MG(e){return eV(e)?e:e.replaceAll(/\b_([a-z0-9_]+?)_value\b/gi,"$1")}function $G(e,t){return tV(e)?QV(e,t):Object.entries(e).reduce(((e,[r,n])=>({...e,[r]:QV(n,t)})),{})}function DG(e,t={}){const{pages:r,pageCallback:n,_pageCount:i}=t,a=null!=r,o=null!=n&&"function"==typeof n;return!eV(e["@odata.nextLink"])||null!=e.nextLink&&("all"===r||!a&&o||"number"==typeof r&&i<r)}async function LG(e,t={}){if(null==e)return null;const{entities:r,nextLink:n}=e,i=r?.length??0;let a=await PG(r,`offline:${t.logicalName}`,{autoExpand:!1});return qz(null,a,t,{count:i,nextLink:n}),a=async function(e,t,r={}){if(!DG(t,r))return e;r._pageCount=r._pageCount||1,r._pageCount++,delete r[sV.Offline];const n=await JH.retrieveNextLink(`offline:${r.logicalName}${t.nextLink.options}`,r);return[...e,...GV("data.values",n,[])]}(a,e,t),Promise.props(jz({values:a,nextLink:n,count:i}))}class jG extends AX{constructor(e={}){e.api=sV.WebAPI,super(e,qX(_G),"RetrieveTimestampRequest")}}function _G(){return{url:"RetrieveTimestamp",parser:qG}}async function qG(e){const{Timestamp:t=null}=await kX(e)||{};if(null==t)throw new Error(zV("RetrieveTimestampRequest/parser(object)","Response does not contain any timestamp."));return t}const VG="SetStateRequest",UG={logicalName:void 0,id:AV.empty.toString(),stateCode:void 0,statusCode:void 0};class FG extends AX{constructor(e){const t={...UG,...e},{id:r,statusCode:n,stateCode:i}=t;if(t.id=jX(r,VG),null==i)throw new Error(zV("SetStateRequest/generateDefaults(object)","Missing parameter: stateCode"));if(null==n)throw new Error(zV("SetStateRequest/generateDefaults(object)","Missing parameter: statusCode"));super(t,qX(BG,KG,zG),VG)}}async function BG(e){const{logicalName:t,id:r,stateCode:n,statusCode:i}=e;return{url:`${await ez.getLogicalCollectionName(t)}(${r})`,method:nV.PATCH,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({statecode:n,statuscode:i})}}function zG(e){const{stateCode:t,statusCode:r}=e;return IZ({...e,statecode:t,statuscode:r})}function KG(e){const{id:t,logicalName:r,stateCode:n,statusCode:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:SetStateRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>EntityMoniker</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${t}</a:Id>`,`<a:LogicalName>${r}</a:LogicalName>`,'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>State</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${n}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>SetState</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:SetStateRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>EntityMoniker</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${t}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',`<a:LogicalName>${r}</a:LogicalName>`,'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>State</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${n}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>SetState</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}function WG(){return{url:"WhoAmI"}}function XG(){return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:WhoAmIRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"/>','<a:RequestId i:nil="true"/>',"<a:RequestName>WhoAmI</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:WhoAmIRequest">',"<a:Parameters/>",'<a:RequestId i:nil="true"/>',"<a:RequestName>WhoAmI</a:RequestName>","</c:OrganizationRequest>"].join(""),parser:cK.whoAmIResponseParser,valid:!0}}const ZG="WinQuoteRequest";function GG(e){const{subject:t,description:r,id:n,statusCode:i}=e;return{url:"WinQuote",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`},body:JSON.stringify({Status:i,QuoteClose:{subject:t,description:r||null,"quoteid@odata.bind":`/quotes(${n})`}})}}function HG(e){const{subject:t,description:r,id:n,statusCode:i}=e;return{body:['<Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts" i:type="b:WinQuoteRequest">','<a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic">',"<a:KeyValuePairOfstringanyType>","<c:key>QuoteClose</c:key>",'<c:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<c:key>subject</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${t}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>description</c:key>",`<c:value xmlns:d="http://www.w3.org/2001/XMLSchema" i:type="d:string">${r||""}</c:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>quoteid</c:key>",'<c:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,"<a:LogicalName>quote</a:LogicalName>",'<a:Name i:nil="true"/>',"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>","<a:LogicalName>quoteclose</a:LogicalName>","<a:RelatedEntities/>","</c:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<c:key>Status</c:key>",'<c:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</c:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>WinQuote</a:RequestName>","</request>","</Execute>"].join(""),organizationRequest:['<c:OrganizationRequest xmlns:d="http://schemas.microsoft.com/crm/2011/Contracts" i:type="d:WinQuoteRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>QuoteClose</b:key>",'<b:value i:type="a:Entity">',"<a:Attributes>","<a:KeyValuePairOfstringanyType>","<b:key>subject</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${t}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>description</b:key>",`<b:value xmlns:e="http://www.w3.org/2001/XMLSchema" i:type="e:string">${r||""}</b:value>`,"</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>quoteid</b:key>",'<b:value i:type="a:EntityReference">',`<a:Id>${n}</a:Id>`,'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>quote</a:LogicalName>",'<a:Name i:nil="true"/>','<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Attributes>",'<a:EntityState i:nil="true"/>',"<a:FormattedValues/>","<a:Id>00000000-0000-0000-0000-000000000000</a:Id>",'<a:KeyAttributes xmlns:e="http://schemas.microsoft.com/xrm/7.1/Contracts"/>',"<a:LogicalName>quoteclose</a:LogicalName>","<a:RelatedEntities/>",'<a:RowVersion i:nil="true"/>',"</b:value>","</a:KeyValuePairOfstringanyType>","<a:KeyValuePairOfstringanyType>","<b:key>Status</b:key>",'<b:value i:type="a:OptionSetValue">',`<a:Value>${i}</a:Value>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>WinQuote</a:RequestName>","</c:OrganizationRequest>"].join(""),valid:!0}}const JG="CustomActionRequest";class YG extends AX{constructor(e={}){const t={...e,api:sV.WebAPI};eV(t.logicalName)||(t.id=jX(t.id,JG)),super(t,qX(QG),JG)}}async function QG(e){const{customActionName:t,customActionData:r,logicalName:n,id:i}=e;let a=`${t}`;const o=!eV(n),[s,u]=await Promise.all([o?ez.getLogicalCollectionName(n):null,eH(r)]);return o&&(a=`${s}(${i})/Microsoft.Dynamics.CRM.${a}`),{url:a,method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`,Prefer:'odata.include-annotations="*"'},body:JSON.stringify(u),parser:rH}}function eH(e){return null==e?{}:Object.entries(e).reduce((async(e,[t,r])=>{const[n,i]=await Promise.all([e,tH(t,r)]);return{...n,...i}}),{})}function tH(e,t){return null==t?null:Array.isArray(t)?function(e,t){if(t.length<=0)return null;let r;return Promise.props({[e]:Promise.all(t.map((async e=>{eV(r)&&(r=GV("@meta.logicalName",e,r));const t=await XX(e,r);return t["@odata.type"]=`Microsoft.Dynamics.CRM.${r}`,t})))})}(e,t):t.constructor==={}.constructor?async function(e,t){const r=GV("@meta.logicalName",t,""),n=GV("@meta.isEntityReference",t,!1);let i=null;n?(i={...t},delete i["@meta"]):i=await XX(t,r);eV(r)||(i["@odata.type"]=`Microsoft.Dynamics.CRM.${r}`);return{[e]:i}}(e,t):VF.isValidDate(t)?function(e,t){return{[e]:VF.format(t,{isSourceUTC:!0,targetDateZone:mU.UTC})}}(e,t):{[e]:t}}async function rH(e){if(null==e||eV(e.responseText))return Promise.resolve();const t=JSON.parse(e.responseText),r=t["@odata.context"];return r.endsWith("$entity")?JX(t):Array.isArray(t.value)&&t.value.length>0?PG(t.value,r):function(e){return Object.entries(e).reduce(((t,[r,n])=>/@odata|@microsoft/i.test(r)?t:(t["@meta"].formattedValues={...t["@meta"].formattedValues,...QX(r,r,e)},VF.isValidISODateString(n)?{...t,...eZ(r,n,{behavior:xV.TimeZoneIndependent})}:{...t,[r]:n})),Object.assign(Object.create(null),{"@meta":Object.create(null,{logicalName:{value:e["@odata.context"].replace(/^.+Microsoft\.Dynamics\.CRM\.(.+)$/g,"$1"),enumerable:!0,writable:!0,configurable:!0},primaryIdAttribute:{value:null,enumerable:!0,writable:!0,configurable:!0},formattedValues:{value:Object.create(null),enumerable:!0,writable:!0,configurable:!0},etag:{value:e["@odata.etag"],enumerable:!0,writable:!0,configurable:!0}})}))}(t)}const nH="ClearLookupRequest",iH={logicalName:"",id:AV.emptyString,lookupLogicalName:""};class aH extends AX{constructor(e){super({...iH,...e,id:jX(e.id,nH),api:sV.WebAPI},qX(oH),nH)}}async function oH(e){const{logicalName:t,lookupLogicalName:r,id:n}=e,[i,a]=await Promise.all([ez.getLogicalCollectionName(t),ez.getNavigationPropertyName(t,r)]);return{url:`${i}(${n})/${a}/$ref`,method:nV.DELETE}}var sH=function(){if(!navigator)return!1;const{userAgent:e}=navigator;return/Edge/.test(e)}();var uH=function(){if(!navigator)return!1;const{userAgent:e}=navigator,t=/Trident\/([0-9]{1,}[.0-9]{0,})/;let r=-1;return null!==t.exec(e)&&(r=parseFloat(t.$1)),r>-1}();const lH="FetchRequest",cH=new DOMParser,dH=new XMLSerializer,fH=5e3,pH={fetchXML:null,fetchParams:null,fetchMode:mV.Auto,maxPageSize:fH,pages:null,pageCallback:null,usePagingCookie:!1,_pageCount:1,_pagingCookie:null};class mH extends AX{constructor(e){const t=function(e){const t=function(e){const t=null!=e.pages&&"all"!==e.pages?parseInt(e.pages,10):e.pages,r=null!=e.maxPageSize?parseInt(e.maxPageSize,10):e.maxPageSize;return{...e,pages:t,maxPageSize:r}}(e);null==t.fetchParams||Hq(t.fetchParams)||(t.fetchXML=QV(t.fetchXML,t.fetchParams));const{fetchXML:r}=t;if(eV(r)||!/<entity\s+?name=['|"][a-zA-Z0-9_]+['|"]\s*?\/?>/g.test(r))return Promise.reject(new Error(zV("FetchRequest/generateDefaults(object)","FetchRequest contains an empty or invalid fetch XML",`FetchXML: ${r}`)));let n=null;try{n=cH.parseFromString(r,"application/xml");const e=n.querySelector("parsererror");if(null!=e)throw new Error(e.textContent)}catch(e){throw new Error(zV("FetchRequest/generateDefaults(object)","FetchRequest contains invalid fetch XML",`Message: ${e.message}`,`FetchXML: ${r}`))}return function(e,t){if(null==t.pages&&null==t.pageCallback)return;const r=e.querySelector("fetch");r.setAttribute("page",t._pageCount),null!=t.maxPageSize&&r.setAttribute("count",parseInt(t.maxPageSize,10));!0===t.usePagingCookie&&null!=t._pagingCookie&&r.setAttribute("paging-cookie",t._pagingCookie.unescapeXML())}(n,t),{...t,fetchXML:dH.serializeToString(n),fetchDOM:n}}({...pH,...e});super(t,qX(hH,yH,gH),lH)}}async function hH(e){const{fetchXML:t,fetchDOM:r,fetchMode:n}=e,i=bH(r),a=`${await ez.getLogicalCollectionName(Array.from(i["@list"])[0])}?fetchXml=${encodeURIComponent(t)}`,o=tX.getWebAPIUrl().length+a.length+1;return n===mV.Auto&&(o>8196||(uH||sH)&&o>2048)||n===mV.CustomAction?async function(e,t,r){return{url:"orb_ORBISCoreFetch",method:nV.POST,headers:{"Content-Type":`${iV.JSON}; charset=utf-8`,Prefer:'odata.include-annotations="*"'},body:JSON.stringify(await eH({fetchXML:e})),parser:e=>function(e,t,r={}){if(null==e||eV(e.responseText))return Promise.resolve(jz({values:[]}));const n=JSON.parse(e.responseText);if(n.value.length<=0)return Promise.resolve(jz({values:[]}));const[i]=n.value.splice(-1,1),[,a]=/W\/"(.*?)"/gi.exec(i["@odata.etag"]),{pagingCookie:o,totalRecordCount:s,totalRecordCountLimitExceeded:u}=JSON.parse(a.unescapeXML());return wH(e,n,t,r,{pagingCookie:_z(o),totalRecordCount:s||void 0,totalRecordCountLimitExceeded:u||void 0})}(e,t,r)}}(t,i,e):function(e,t,r){return{url:e,headers:{Prefer:'odata.include-annotations="*"'},parser:e=>function(e,t,r={}){if(null==e||eV(e.responseText))return Promise.resolve(jz({values:[]}));const n=JSON.parse(e.responseText);if(!Array.isArray(n.value)||n.value.length<=0)return Promise.resolve(jz({values:[]}));return wH(e,n,t,r,Lz(n))}(e,t,r)}}(a,i,e)}function gH(e){const{fetchXML:t,fetchDOM:r}=e,n=bH(r),i=Array.from(n["@list"])[0];let a=!0;return rZ(i)&&(console.error(zV("Requests/FetchRequest",`Entity '${i}' is not available offline.`)),a=!1),{method:"retrieveMultipleRecords",params:[i,`?fetchXml=${t}`,vH(r,e)],parser:t=>LG(t,{...e,logicalName:i}),valid:a}}function yH(e){const{fetchXML:t}=e,r=['<RetrieveMultiple xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">','<query xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" i:type="a:FetchExpression">',`<a:Query>${t.escapeXML()}</a:Query>`,"</query>","</RetrieveMultiple>"].join(""),n=['<c:OrganizationRequest i:type="a:RetrieveMultipleRequest">',"<a:Parameters>","<a:KeyValuePairOfstringanyType>","<b:key>Query</b:key>",'<b:value i:type="a:FetchExpression">',`<a:Query>${t.escapeXML()}</a:Query>`,"</b:value>","</a:KeyValuePairOfstringanyType>","</a:Parameters>",'<a:RequestId i:nil="true"/>',"<a:RequestName>RetrieveMultiple</a:RequestName>","</c:OrganizationRequest>"].join("");return{body:r,headers:{SoapAction:dV.RetrieveMultiple},parser:t=>cK.retrieveMultipleResponseParser(t,e),organizationRequest:n,valid:!0}}function bH(e){return Array.from(e.querySelectorAll("entity, link-entity")).reduce(((e,t)=>{const r=t.getAttribute("name");rZ(r)&&zV(`[Requests.FetchRequest] Entity with name ${r} is not available offline`,"Please mark required entities to be available offline."),e["@list"].add(r);const n=t.getAttribute("alias");eV(n)||(e[n]=r);const i=function(e,t){if(null==e)return{};const r=Array.from(e.querySelectorAll(':scope > attribute[alias]:not([alias=""])'));if(r.length<=0)return{};return r.reduce(((e,r)=>(e[r.getAttribute("alias")]={attributeName:r.getAttribute("name"),entityName:t},e)),{})}(t,r);return e["@attributes"]={...e["@attributes"],...i},e}),{"@attributes":{},"@list":new Set})}function vH(e,t){if(null!=t.maxPageSize&&t.maxPageSize!==fH)return t.maxPageSize;const r=e.querySelector("fetch").getAttribute("count");return null!=r?parseInt(r,10):fH}async function wH(e,t,r,n,i){const{pagingCookie:a,nextLink:o,count:s,totalRecordCount:u,totalRecordCountLimitExceeded:l}=i;let c=await PG(t.value,t["@odata.context"],{fetchAliasMapping:r});return qz(e,c,n,i),n._pagingCookie=a,n._totalRecordCount=u,c=await async function(e,t){if(!function(e,t){const{maxPageSize:r,pages:n,pageCallback:i,_pageCount:a,_totalRecordCount:o}=t,s=null!=n,u=null!=i&&"function"==typeof i,l=a*r;return(-1===o||null==o?e.length===r:l<o)&&("all"===n||!s&&u||"number"==typeof n&&a<n)}(e,t))return e;t._pageCount=t._pageCount||1,t._pageCount++;const r=await JH.fetch(t.fetchXML,t);return[...e,...GV("data.values",r,[])]}(c,n),jz({values:c,pagingCookie:a,nextLink:o,count:s,totalRecordCount:u,totalRecordCountLimitExceeded:l})}var OH=Object.freeze({__proto__:null,Request:AX,AssignRequest:xZ,AssociateRequest:LZ,CancelSalesOrderRequest:class extends AX{constructor(e){e.id=jX(e.id,qZ),super(e,qX(VZ,UZ),qZ)}},CloseIncidentRequest:class extends AX{constructor(e){e.id=jX(e.id,FZ),super(e,qX(BZ,zZ),FZ)}},CloseQuoteRequest:class extends AX{constructor(e){e.id=jX(e.id,KZ),super(e,qX(WZ,XZ),KZ)}},CreateRequest:hZ,DeleteRequest:GZ,DisassociateRequest:eG,EntityDefinitionsRequest:iG,ExecuteMultipleRequest:mG,ExecuteTransactionRequest:uG,FulfillSalesOrderRequest:class extends AX{constructor(e){e.id=jX(e.id,OG),super(e,qX(SG,CG),OG)}},RelationshipDefinitionsRequest:AG,RetrieveRequest:aZ,RetrieveMultipleRequest:TG,RetrieveTimestampRequest:jG,SetStateRequest:FG,UpdateRequest:PZ,UpsertRequest:CZ,WhoAmIRequest:class extends AX{constructor(e){super(e,qX(WG,XG),"WhoAmIRequest")}},WinQuoteRequest:class extends AX{constructor(e){e.id=jX(e.id,ZG),super(e,qX(GG,HG),ZG)}},CustomActionRequest:YG,ClearLookupRequest:aH,FetchRequest:mH});const SH={data:null,isSuccess:!0,xhr:{}};var CH={Response:SH,FetchResponse:{data:{count:0,nextLink:"",pagingCookie:"",values:[]},isSuccess:!0,xhr:{}},CreateResponse:{data:"",isSuccess:!0,xhr:{}},UpdateResponse:{data:null,isSuccess:!0,xhr:{}},UpsertResponse:SH,DeleteResponse:{data:null,isSuccess:!0,xhr:{}},AssociateResponse:SH,DisassociateResponse:SH,AssignResponse:SH,CancelSalesOrderResponse:SH,CloseIncidentResponse:SH,CloseQuoteResponse:SH,CustomActionResponse:SH,ExecuteMultipleResponse:{data:[],isSuccess:!0,xhr:{}},ExecuteTransactionResponse:{data:[],isSuccess:!0,xhr:{}},FulfillSalesOrderResponse:SH,RetrieveMultipleResponse:{data:{count:0,nextLink:"",pagingCookie:"",values:[]},isSuccess:!0,xhr:{}},RetrieveResponse:SH,SetStateResponse:SH,WhoAmIResponse:SH,WinQuoteResponse:SH,ErrorResponse:{code:"",message:"",isSuccess:!1}};let EH=!1;async function AH(e){EH||(WV("Service.SOAP deprecation","Using the Microsoft Dynamics CRM 2011 endpoint (known as SOAP) is deprecated. Please consider switching to WebAPI instead. See: https://msdn.microsoft.com/en-us/library/dn281891.aspx"),EH=!0);const[t,r]=await Promise.all([e.isValidSoapAPI,e.soapAPIOptions]);if(!t)throw new Error(zV("SOAP/execute(object)",`${e.name} is not a valid WebAPI request.`));return r.url=tX.getSoapUrl(),r.body=r.body.includes("<s:Envelope")?r.body:['<?xml version="1.0"?>','<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">',`<s:Body>${r.body}</s:Body>`,"</s:Envelope>"].join(""),(new Dz).execute(r)}var RH={execute:AH};async function PH(e){const[t,r]=await Promise.all([e.isValidWebAPI,e.webAPIOptions]);if(!t)throw new Error(zV("WebAPI/execute(object)",`${e.name} is not a valid WebAPI request.`));const n=tX.getWebAPIUrl();return r.url.includes(n)||(r.url=`${n}/${r.url}`),(new Dz).execute(r)}var IH={execute:PH};function NH(e,t,r){TH(e,t),t.set(e,r)}function TH(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xH(e,t,r){return function(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}(e,t),function(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}(r,"get"),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,r)}var kH=new WeakMap,MH=new WeakMap,$H=new WeakSet;class DH{constructor(e){var t,r;TH(t=this,r=$H),r.add(t),NH(this,kH,{writable:!0,value:null}),NH(this,MH,{writable:!0,value:xH(DH,DH,jH)[sV.WebAPI]}),vV(this,kH,e),function(e,t,r){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return r}(this,$H,LH).call(this)}execute(){return bV(this,MH).call(this,bV(this,kH))}}function LH(){let e=eV(bV(this,kH).API)?sV.WebAPI:bV(this,kH).API;if(e===sV.WebAPI&&xF.isOffline()&&(e=sV.Offline),!Object.values(sV).includes(e))throw new Error(zV("Router/initialize()",`"${bV(this,kH).API}" is not an available endpoint API to choose from.`));vV(this,MH,xH(DH,DH,jH)[e])}var jH={writable:!0,value:{[sV.Offline]:async function(e){const[t,r]=await Promise.all([e.isValidOfflineAPI,e.offlineAPIOptions]);if(!t)throw new Error(zV("Offline/execute(object)",`${e.name} is not a valid/supported WebAPI offline request.`));try{const e=await vW().WebApi.offline[r.method](...r.params);return $z(null,await r.parser(e))}catch(e){throw console.error("Raw error response:",e),$z(null,e,!1)}},[sV.WebAPI]:PH,[sV.SOAP]:AH}};const _H=/^```JSON\r?\n(.+)\r?\n```$/im,qH=/.*?(Microsoft\.Xrm\.Sdk\..+?),.*?/i,VH=/^(.+?Exception)/i,UH={type:"System.Exception",message:"An undefined error occoured.",code:"0x80040265"};function FH(e,t=UH.code){return eV(e)?t:e}function BH(e){if(eV(e))return UH.type;let[,t]=e.match(qH)||[];return eV(t)?([,t=UH.type]=e.match(VH)||[],t):t}function zH(e){if(Yq(e))return"";const{configuration:t,message:r,type:n,stackTrace:i,innerException:a}=e;let o=`\nException: ${n||""}\nMessage: ${r||""}`;const s=function(e){if(Yq(e))return"";const{typeName:t="UnknownPlugin",messageName:r="UnknownMessage",stage:n=0,depth:i=1,primaryEntityName:a="none",primaryEntityId:o=AV.emptyString}=e;return`Plugin Configuration:\n\tPlugin: ${t}\n\tMessage: ${r}\n\tEntityName: ${a}\n\tEntityId: ${o}\n\tStage: ${n}\n\tDepth: ${i}`}(t);return eV(s)||(o+=`\r\n${s}`),eV(i)||(o+=`\nStack:\n${rV(i)||""}\n`),`${rV(o)}${zH(a)}`}function KH(e){return Jq(e)?"":`${e.message}\r\n${KH(e.innerError)}`}class WH extends Error{constructor(e=null){const{message:t=""}=e||{},r=function(e){return _H.test(e)}(t)?function(e){if(eV(e))return UH;const[,t=""]=e.match(_H)||[];return eV(t)?{...UH,type:"Error",message:e}:JSON.parse(t)}(t):function(e={}){const{message:t=UH.message,code:r,type:n,stack:i=""}=e;return{...UH,message:t,stackTrace:i,code:FH(r),type:BH(n)}}(e);super(r.message||"");try{super.name=r.type,super.stack=zH(r)}catch{console.error(zH(r),this)}this.code=FH(r.code,FH(e.code)),this.innerError=Jq(r.innerException)?null:new WH(r.innerException),this.exception=r}showErrorDialog(){mW.openErrorDialog({errorCode:this.code,message:KH(this),details:this.toString()})}static fromServerError(e,t=!1){const r=new WH(e);return!0===t&&r.showErrorDialog(),r}}const XH={api:sV.WebAPI},ZH=e=>new DH(e).execute().catch((t=>{if(t instanceof Error)throw t;const{displayError:r=!1}=e.requestData;return Promise.reject({...t,data:WH.fromServerError(t.data||{},r)})})),GH=(e,t,r={})=>{const n={...XH,logicalName:e,id:t,...r};return ZH(new GZ(n))},HH=(e,t,r=null,n=null,i={})=>{const a={...XH,customActionName:e,customActionData:t,logicalName:r,id:n,...i};return ZH(new YG(a))};var JH={Enums:gV,assign:(e,t,r,n,i={})=>{const a={...XH,targetLogicalName:e,targetId:t,ownerLogicalName:r,ownerId:n,...i};return ZH(new xZ(a))},associate:(e,t,r,n,i,a={})=>{const o={...XH,logicalNameA:e,idA:t,logicalNameB:r,idB:n,relationName:i,...a};return ZH(new LZ(o))},clearLookup:(e,t,r,n={})=>{const i={...XH,logicalName:e,id:t,lookupLogicalName:r,...n};return ZH(new aH(i))},create:(e,t,r={})=>{const n={...XH,logicalName:e,entity:t,...r};return ZH(new hZ(n))},delete:GH,del:GH,disassociate:(e,t,r,n,i,a={})=>{const o={...XH,logicalNameA:e,idA:t,logicalNameB:r,idB:n,relationName:i,...a};return ZH(new eG(o))},execute:ZH,executeCustomAction:HH,executeWorkflow:(e,t,r={})=>HH("ExecuteWorkflow",t,"workflow",e,r),fetch:(e,t={})=>{const r={...XH,fetchXML:e,...t};return ZH(new mH(r))},retrieve:(e,t,r=[],n={})=>{const i={...XH,logicalName:e,id:t,columns:r,...n};return ZH(new aZ(i))},retrieveMultiple:(e,t,r={})=>{const n={...XH,logicalName:e,params:t,...r};return ZH(new TG(n))},retrieveNextLink:async(e,t={})=>{const{url:r,params:n,...i}=t,a=e.startsWith("offline:"),o=await KX(e),s={...XH,logicalName:o,...a?{[sV.Offline]:{params:[o,e.replaceAll(/^offline:([a-z0-9_]+)/gi,"")]}}:{[sV.WebAPI]:{url:e}},...i};return ZH(new TG(s))},setState:(e,t,r,n,i={})=>{const a={...XH,logicalName:e,id:t,stateCode:r,statusCode:n,...i};return ZH(new FG(a))},update:(e,t,r,n={})=>{const i={...XH,logicalName:e,id:t,entity:r,...n};return ZH(new PZ(i))},upsert:(e,t,r,n={})=>{const i={...XH,logicalName:e,id:t,entity:r,...n};return ZH(new CZ(i))},Requests:OH,Responses:CH,WebAPI:IH,SOAP:RH,ServiceError:WH};function YH(e=[],t=100){const r=[];for(let n=0;n<e.length;n+=t)r[r.length]=e.slice(n,n+t);return r}function QH(){return this.partitions.length<=0}function eJ(){return this.position<=0}function tJ(){return this.position===this.partitions.length-1}const rJ=Symbol("Array");function nJ(e,t,r){if(null==e)return null;switch(typeof r){case"object":{const n=JV.extract(r.source,e,null,{separator:">"});return null!=n&&null!=t&&null!=r.target&&JV.define(r.target,t,n,{separator:">"}),n}case"function":return r(t,e)}return null}function iJ(e={}){const t={};for(const r in e)null!=e[r]&&JV.define(r,t,e[r],{separator:">"});return t}function aJ(...e){if(null==e||0===e.length)throw new Error("keys not set in getDefaultKeyBuilder");const t=[];for(const r of e)switch(typeof r){case"string":t.push({source:r,target:r});break;case"function":t.push(r);break;case"object":for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t.push({source:r[e],target:e})}return e=>{if(null==e)return"";const r={};for(const n of t)nJ(e,r,n);return r}}function oJ(e,t={}){return null==t?e:Object.assign(t,e)}class sJ{constructor(...e){this[rJ]=new Array(...e)}static from(e,t,r){const n=new sJ;return n[rJ]=Array.from(e,t,r),n}static of(...e){const t=new sJ;return t[rJ]=Array.of(...e),t}static isJSONArray(e){return e instanceof sJ}toArray(){return this[rJ]}get(e){return this[rJ][e]}set(e,t){return this[rJ][e]=t,this}toString(){return this[rJ].toString()}toLocaleString(){return this[rJ].toLocaleString()}get length(){return this[rJ].length}set length(e){this[rJ].length=e}concat(...e){let t=this[rJ];for(const r of e)sJ.isJSONArray(r)?t=t.concat(r[rJ]):Array.isArray(r)&&(t=t.concat(r));return sJ.from(t)}copyWithin(e,t,r){return this[rJ].copyWithin(e,t,r),this}every(e,t){return this[rJ].every(e,t)}some(e,t){return this[rJ].some(e,t)}fill(e,t,r){return r=r||this.length,t=t||0,this[rJ].fill(e,t,r),this}filter(e,t){const r=this[rJ].filter(e,t);return sJ.from(r)}find(e,t){return this[rJ].find(e,t)}findIndex(e,t){return this[rJ].findIndex(e,t)}indexOf(e,t){return this[rJ].indexOf(e,t)}lastIndexOf(e,t){return t=t||this.length,this[rJ].lastIndexOf(e,t)}includes(e,t){return this[rJ].includes(e,t)}forEach(e,t){return this[rJ].forEach(e,t),this}join(e){return this[rJ].join(e)}map(e,t){return sJ.from(this[rJ].map(e,t))}pop(){return this[rJ].pop()}shift(){return this[rJ].shift()}unshift(...e){return this[rJ].unshift(...e)}push(...e){return this[rJ].push(...e)}splice(e,t,...r){return this[rJ].splice(e,t,...r),this}slice(e,t){return sJ.from(this[rJ].slice(e,t))}reduce(e,t){return this[rJ].reduce(e,t)}reduceRight(e,t){return this[rJ].reduceRight(e,t)}reverse(){return this[rJ].reverse(),this}sort(e){return this[rJ].sort(e),this}values(){return this[rJ].values()}keys(){return this[rJ].keys()}entries(){return this[rJ].entries()}[Symbol.iterator](){return this[rJ][Symbol.iterator]()}static keyExtractor(e){return e.replace(/\./g,">")}static getDefaultKeyBuilder(...e){if(null==e||0===e.length)throw new Error("key not set in getDefaultKeyBuilder");const t=aJ(...e);return e=>JSON.stringify(t(e))}groupBy(e,t){if(null==e)throw new Error("The keyBuilder was not provided for the groupBy method");const r={},n=[];for(let i=0,a=this[rJ].length;i<a;i++){const a=this[rJ][i],o=e.apply(t||this,[a]);null==r[o]?(r[o]=[a],n.push(r[o])):r[o].push(a)}return n}groupByKey(...e){const t=sJ.getDefaultKeyBuilder(...e);return this.groupBy(t)}distinctBy(e,t){if(null==e)throw new Error("The keyBuilder was not provided for the distinctBy method");const r={},n=[];for(let i=0,a=this[rJ].length;i<a;i++){const a=this[rJ][i],o=e.apply(t||this,[a]);if("string"!=typeof o)throw new Error("the keyBuilder didn't return a string in distinctBy");null==r[o]&&(r[o]=a,n.push(r[o]))}return sJ.from(n)}distinctByKey(...e){const t=sJ.getDefaultKeyBuilder(...e);return this.distinctBy(t)}extractByKey(...e){const t=new sJ;if(0===e.length)return sJ.from(this[rJ],(e=>Object.assign({},e)));const r=aJ(...e);for(let e=0,n=this[rJ].length;e<n;e++)t.push(r(this[rJ][e]));return t}extractValueByKey(e,{ignoreNull:t=!1,prefix:r=null,suffix:n=null}={}){if("string"!=typeof e)return console.log("The key for extractValuesByKey should be a string"),[];const i=[];for(let a=0,o=this[rJ].length;a<o;a++){const o=JV.extract(e,this[rJ][a],null,{separator:">"});!1!==t&&null==o||(r||n?i.push((r||"")+o.toString()+(n||"")):i.push(o))}return i}findFirstByKey(e){if(null==e)return null;const t=sJ.getDefaultKeyBuilder(...Object.keys(e)),r=iJ(e),n=JSON.stringify(r);return this.find((e=>n===t(e)))}findLastByKey(e){if(null==e)return null;const t=sJ.getDefaultKeyBuilder(...Object.keys(e)),r=iJ(e),n=JSON.stringify(r);for(let e=this[rJ].length-1;e>0;e--)if(n===t(this[rJ][e]))return this[rJ][e]}findFirstIndexByKey(e){if(null==e)return null;const t=sJ.getDefaultKeyBuilder(...Object.keys(e)),r=iJ(e),n=JSON.stringify(r);return this.findIndex((e=>n===t(e)))}findLastIndexByKey(e){if(null==e)return null;const t=sJ.getDefaultKeyBuilder(...Object.keys(e)),r=iJ(e),n=JSON.stringify(r);for(let e=this[rJ].length-1;e>=0;e--)if(n===t(this[rJ][e]))return e;return-1}includesByKey(e,t=0){if(null==e)return!1;const r=sJ.getDefaultKeyBuilder(...Object.keys(e)),n=iJ(e),i=JSON.stringify(n);for(let e=t;e<this[rJ].length;e++)if(i===r(this[rJ][e]))return!0;return!1}filterByKey(e){if(null==e)return new sJ;const t=sJ.getDefaultKeyBuilder(...Object.keys(e)),r=iJ(e),n=JSON.stringify(r);return this.filter((e=>n===t(e)))}getMappingFunctionByKey(e,t=!0){return null==e?oJ:(t,r={})=>{const n=oJ(t,r);for(const t of Object.getOwnPropertyNames(e))nJ(n,n,{target:t,source:e[t]});return n}}mapByKey(e){return this.map(this.getMappingFunctionByKey(e,!0))}sortByKey(...e){let t=e;t=1===e.length&&"object"==typeof e[0]&&Object.values(e[0]).every((e=>"boolean"==typeof e))?Object.entries(e[0]).map((([e,t])=>({name:e,asc:t}))):e.map((e=>"string"==typeof e?{name:e,asc:!0}:"object"==typeof e?{name:e.name,asc:null==e.asc||e.asc}:e));const r=this[rJ].map((e=>{const r={keys:{},value:e};for(let n=0,i=t.length;n<i;n++)r.keys[t[n].name]=JV.extract(t[n].name,e,null,{separator:">"});return r}));return this[rJ]=r.sort(((e,r)=>{for(let n=0;n<t.length;n++){const i=t[n].name;if(e.keys[i]!=r.keys[i])return(e.keys[i]>r.keys[i]||null==r.keys[i]?1:-1)*(!0===t[n].asc?1:-1)}return 0})).map((e=>e.value)),this}static getSortDefinition(e,t){return{name:e,asc:null==t||t}}intersectBy(e,t,r,n){if(null==t)throw new Error("The keyBuilder was not provided for the intersectBy method");const i={};let a=t;r&&(a=sJ.getDefaultKeyBuilder(r));const o=[];for(const t of e){const e=a.apply(this,[t]);null==i[e]&&(i[e]=!1)}for(const e of this[rJ]){const r=t.apply(n||this,[e]);!1===i[r]&&(o.push(e),i[r]=!0)}return sJ.from(o)}groupedIntersectBy(e,t,r,n){if(null==t)throw new Error("The keyBuilder was not provided for the groupedIntersectBy method");const i={};let a=t;r&&(a=sJ.getDefaultKeyBuilder(r));const o=this.getMappingFunctionByKey(r,!0),s=[];for(const e of this[rJ]){const r=t.apply(this,[e]);null==i[r]?i[r]={isIntersect:!1,subArray:[e]}:i[r].subArray.push(e)}for(const t of e){const e=a.apply(n||this,[t]);null!=i[e]&&(i[e].isIntersect=!0,i[e].subArray.push(o(t)))}for(const e in i)if(Object.prototype.hasOwnProperty.call(i,e)){const t=i[e];!0===t.isIntersect&&s.push(t.subArray)}return s}intersectByKey(e,...t){let r=null;if(1===t.length&&"object"==typeof t[0]){const n=Object.getOwnPropertyNames(t[0]);return r=sJ.getDefaultKeyBuilder(...n),this.intersectBy(e,r,...t)}return r=sJ.getDefaultKeyBuilder(...t),this.intersectBy(e,r)}groupedIntersectByKey(e,...t){let r=null;if(1===t.length&&"object"==typeof t[0]){const n=Object.getOwnPropertyNames(t[0]);return r=sJ.getDefaultKeyBuilder(...n),this.groupedIntersectBy(e,r,...t)}return r=sJ.getDefaultKeyBuilder(...t),this.groupedIntersectBy(e,r)}exceptBy(e,t,r,n){if(null==t)throw new Error("The keyBuilder was not provided for the exceptBy method");const i={};let a=t;"function"==typeof r?a=r:"object"==typeof r&&null!=r&&(a=sJ.getDefaultKeyBuilder(r));const o=[];for(const t of e){const e=a.apply(this,[t]);null==i[e]&&(i[e]=!0)}for(const e of this[rJ]){!0!==i[t.apply(n||this,[e])]&&o.push(e)}return sJ.from(o)}exceptByKey(e,...t){let r=null;if(1===t.length&&"object"==typeof t[0]){const n=Object.getOwnPropertyNames(t[0]);return r=sJ.getDefaultKeyBuilder(...n),this.exceptBy(e,r,...t)}return r=sJ.getDefaultKeyBuilder(...t),this.exceptBy(e,r)}concatDistinctBy(e,t,r,n){if(null==t)throw new Error("The keyBuilder was not provided for the exceptBy method");const i={};let a=t;r&&(a=sJ.getDefaultKeyBuilder(r));const o=this.getMappingFunctionByKey(r,!0),s=this[rJ].concat([]);for(const e of this[rJ]){const r=t.apply(n||this,[e]);!0!==i[r]&&(i[r]=!0)}for(const t of e){const e=a.apply(this,[t]);null==i[e]&&(i[e]=!0,s.push(o(t,{})))}return sJ.from(s)}concatDistinctByKey(e,...t){let r=null;if(1===t.length&&"object"==typeof t[0]){const n=Object.getOwnPropertyNames(t[0]);return r=sJ.getDefaultKeyBuilder(...n),this.concatDistinctBy(e,r,t[0])}return r=sJ.getDefaultKeyBuilder(...t),this.concatDistinctBy(e,r)}innerJoinBy(e,t,r,n,i){if(null==r)throw new Error("The keyBuilder was not provided for the innerJoinBy method");const a={};let o=r;"function"==typeof n?o=n:"object"==typeof n&&null!=n&&(o=sJ.getDefaultKeyBuilder(n));for(const e of this[rJ]){const t=r.apply(this,[e]);null==a[t]?a[t]=[e]:a[t].push(e)}for(const r of e){const e=o.apply(i||this,[r]);if(null!=a[e])for(const n of a[e])t(n,r)}return this}innerJoinByKey(e,t,...r){let n=null;if(1===r.length&&"object"==typeof r[0]){const i=Object.getOwnPropertyNames(r[0]);return n=sJ.getDefaultKeyBuilder(...i),this.innerJoinBy(e,t,n,r[0])}return n=sJ.getDefaultKeyBuilder(...r),this.innerJoinBy(e,t,n,...r)}}const{del:uJ,get:lJ,head:cJ,options:dJ,patch:fJ,post:pJ,put:mJ}=Dz;var hJ={Enums:oV,del:uJ,get:lJ,head:cJ,options:dJ,patch:fJ,post:pJ,put:mJ};class gJ{constructor(e,t,r){this._action=e,this._requestResponse=t||[],this._isSuccess=null,this._isCancelled=!1,this._sourceObject=r,this._message=null}static fromError(e,t,r){const n=new gJ(e,null,t);return"string"==typeof r?n._message=r:r.data&&r.data.message?n._message=r.data.message:n._message=JSON.stringify(r),n._isSuccess=!1,n}static fromCancelled(e,t){const r=new gJ(e,null,t);return r._message="CANCELLED",r._isSuccess=null,r._isCancelled=!0,r}get isSuccess(){return null!=this._isSuccess?this._isSuccess:!0===Array.isArray(this.requestResponse)&&0===this.requestResponse.length||(Array.isArray(this.requestResponseData)?this._isSuccess=this.requestResponseData.every((e=>Array.isArray(e)?e.every((e=>!0===e.isSuccess)):!0===e.isSuccess)):this._isSuccess=this.requestResponse.isSuccess,this._isSuccess)}get isCancelled(){return this._isCancelled}get sourceObject(){return this._sourceObject}get message(){if(null!=this._message)return this._message;if(!0===this.isSuccess)return null;if(Array.isArray(this.requestResponseData)){const e=this.requestResponseData.reduce(((e,t)=>Array.isArray(t.data)?e.concat(t.data.filter((e=>!1===e.isSuccess&&null!=e.data)).map((e=>e.data.message))):!1===t.isSuccess&&t.data&&null!=t.data.message?(e.push(t.data.message),e):e),[]);this._message=0===e.length?null:e.join("\n")}else null!=this.requestResponseData&&!1===this.requestResponseData.isSuccess&&null!=this.requestResponseData.data&&(this._message=this.requestResponseData.data.message);return this._message}get requestResponse(){return this._requestResponse}get requestResponseData(){return this._requestResponse?this._requestResponse.data:null}get action(){return this._action}}class yJ{constructor(e){this._actionResponses=e||[],this._isSuccess=null,this._message=null,this._isCancelled=!1}get actionResponses(){return this._actionResponses}getActionResponse(e){let t=this._actionResponses[e];return null==t&&(t=gJ.fromError(null,null,`The ActionResponse with index ${e} was not found in the ActionSetResponse`)),t}get message(){return null!==this._message?this._message:this._actionResponses.filter((e=>null!=e.message)).map((e=>e.message)).join("\n")}get isSuccess(){return!1!==this._isSuccess&&this._actionResponses.every((e=>e.isSuccess))}get isCancelled(){return this._isCancelled}static fromError(e){const t=new yJ(null);return"object"==typeof e&&null!=e.data&&null!=e.data.message?t._message=e.data.message:t._message=e,t._isSuccess=!1,t}static fromCancelled(e=[]){const t=e.map((e=>gJ.fromCancelled(e))),r=new yJ(t);return r._message="CANCELLED",r._isCancelled=!0,r._isSuccess=!0,r}}class bJ{constructor(e,t){this._request=e,this._sourceObject=t,this._executionCondition=null,this._onExecuted=null}get request(){return this._request}set request(e){this._request=e}get sourceObject(){return this._sourceObject}set sourceObject(e){this._sourceObject=e}get executionCondition(){return this._executionCondition}set executionCondition(e){this._executionCondition=e}set onExecuted(e){this._onExecuted=e}execute(){return"function"==typeof this._executionCondition&&!1===this._executionCondition()?Promise.resolve(gJ.fromCancelled(this,this.sourceObject)):JH.execute(this._request).then((e=>{const t=new gJ(this,e,this.sourceObject);return"function"==typeof this._onExecuted&&this._onExecuted(t),t}),(e=>{const t=gJ.fromError(this,this.sourceObject,e);return"function"==typeof this._onExecuted&&this._onExecuted(t),t}))}dontExecute(){return Promise.resolve(gJ.fromCancelled(this,this.sourceObject))}}function vJ(e){const t=vW();t&&null!==t.Utility?mW.openAlertDialog({text:e}):console.log(e)}var wJ={execute:function(e){const t=e.execute();return mW.openProgressDialog("orb_/ORBIS/Core/Utils/Dialogs/Progress.html",{width:350,height:200,hasCloseButton:!1},t),t.then((e=>{!1===e.isSuccess&&vJ(e.message)}),(e=>{vJ(e)})),t},ActionSet:class{constructor(e,t){null==e||Array.isArray(e)||(e=[e]),this._actions=e||[],this._parallelCount=t||10,this._executionCondition=null}add(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),this._actions=this._actions.concat(e),this}get parallelCount(){return this._parallelCount}set parallelCount(e=10){this._parallelCount=e}get actions(){return this._actions}get executionCondition(){return this._executionCondition}set executionCondition(e){this._executionCondition=e}execute(){if("function"==typeof this._executionCondition&&!1===this._executionCondition())return Promise.resolve(yJ.fromCancelled(this._actions));const e=new fz(this._parallelCount);return Promise.all(this._actions.map((t=>e.addFunction((t=>null==t?gJ.fromError(null,"error in execute ActionSet, the action was not defined"):!0===e.isCanceled?t.dontExecute():t.execute()),this,t)))).then((e=>new yJ(e)),(e=>yJ.fromError(e)))}dontExecute(){return Promise.resolve(yJ.fromCancelled(this._actions))}parse(e,t,r,n){for(const i of e){const e=i["@request"]?i["@request"]:i;this._actions.push(new bJ(new n({id:r?i[r]:null,logicalName:t,entity:e}),i["@sourceObject"]))}return this}},Action:bJ,ActionSetResponse:yJ,ActionResponse:gJ};const OJ={Single:"single",Multiple:"multiple",Transaction:"transaction"};const SJ=function(e,t,r){Array.isArray(e)||(e=[e]);for(const n of e)JV.define("@meta",n).logicalName=t,n["@meta"].primaryIdAttribute=r},CJ=function(e){return JV.extract("@meta.logicalName",e)},EJ=function(e){return JV.extract("@meta.primaryIdAttribute",e)};function AJ(e){return!0===(e["@meta"]||{}).isDirty}function RJ(e,t){const r=EJ(e);r&&(e[r]=t&&t.toString?t.toString():t)}function PJ(e){const t=EJ(e);return t?e[t]:null}function IJ(e,t=!0){return!(!e["@meta"]||!0!==e["@meta"].isCreate)||!!(!0===t&&e["@meta"]&&!0===e["@meta"].isDirty||!1===t)&&null==PJ(e)}function NJ(e){return!0===(e["@meta"]||{}).isDelete}const TJ=function(e){return Array.isArray(e)||(e=[e]),e.some((e=>!0===AJ(e)))},xJ=function(e){const t=JV.extract("@meta.change",e);return Object.getOwnPropertyNames(t).filter((e=>!0===t[e]))},kJ=function(e){return Array.isArray(e)||(e=[e]),e.some((e=>!0===NJ(e)))},MJ=function(e,t=!0){return Array.isArray(e)||(e=[e]),e.some((e=>!0===IJ(e,t)))};function $J(e,t,r,n,i,a=!0){!0===i&&!0===NJ(t)?e.delete.push(t):!0===r&&IJ(t,a)?e.create.push(t):!0===n&&AJ(t)&&e.update.push(t)}const DJ=function(e,{includeCreate:t=!0,includeUpdate:r=!0,includeDelete:n=!0,isCreateOnlyOnDirty:i=!1}={}){const a={"@isChanges":!0,create:[],update:[],delete:[]};Array.isArray(e)||(e=[e]);for(const o of e)$J(a,o,t,r,n,i);return a};var LJ={Enums:Object.freeze({__proto__:null,ExecutionMode:OJ}),setIsChange:function(e,t,r=!0){if(null!=e){"string"==typeof t&&(t=[t]);for(const n of t)JV.define("@meta.change",e)[n]=r;!0===r&&(e["@meta"].isDirty=!0)}},setIsDelete:function(e){Array.isArray(e)||(e=[e]);for(const t of e)JV.define("@meta",t).isDelete=!0},setIsCreate:function(e,t,r){Array.isArray(e)||(e=[e]);for(const t of e)JV.define("@meta",t).isCreate=!0;null!=t&&null!=r&&SJ(e,t,r)},setLogicalName:SJ,getLogicalName:CJ,getPrimaryIdAttribute:EJ,getIsDirty:function(e,t=!0){return MJ(e)||TJ(e)||kJ(e)},getHasDelete:kJ,getHasCreate:MJ,getHasUpdate:TJ,getCrmId:PJ,setCrmId:RJ,getAttributeIsDirty:function(e,t){return!0===JV.extract("@meta.change",e)[t]},getDirtyAttributeNames:xJ,getDirtyRecords:DJ,getMultiActionSet:function(e,{includeAttributes:t=null,excludeAttributes:r=null,includeCreate:n=!0,includeUpdate:i=!0,includeDelete:a=!0,isCreateOnlyOnDirty:o=!1,executionMode:s=OJ.Single}={}){let u=null;if(u=e["@isChanges"]?e:DJ(e,{includeCreate:n,includeUpdate:i,includeDelete:a,isCreateOnlyOnDirty:o}),null!=u){const e=u.create.map((e=>function(e,t,r){let n={};if(Array.isArray(t))for(const r of t)n[r]=e[r];else n=Object.assign(n,e);const i=CJ(e);if(delete n["@meta"],r)for(const e of r)delete n[e];return Object.isEmpty(n)?null:{request:new hZ({logicalName:i,entity:n}),sourceData:e,id:null}}(e,t,r))).filter((e=>null!=e)).concat(u.update.map((e=>function(e,t,r){let n={};const i=CJ(e),a=PJ(e);if(null==a)return console.error("crmId was not found in getRequestsForUpdate",e),null;if(!0===t)n=Object.assign(n,e);else{const r=xJ(e);for(const t of r)n[t]=e[t];if(Array.isArray(t))for(const r of t)n[r]=e[r]}if(delete n["@meta"],r)for(const e of r)delete n[e];return Object.isEmpty(n)?null:{request:new PZ({id:a,logicalName:i,entity:n}),sourceData:e,id:a}}(e,t,r))).filter((e=>null!=e)),u.delete.map((e=>function(e){const t=PJ(e);return null==t?(console.error("crmId was not found in getRequestsForDelete",e),null):{request:new GZ({id:t,logicalName:CJ(e)}),sourceData:e,id:t}}(e))).filter((e=>null!=e)));if(0===e.length)return null;const n=new wJ.ActionSet;switch(s){case OJ.Single:n.add(e.map((e=>new wJ.Action(e.request,e.sourceData))));break;case OJ.Multiple:{const t=new wJ.Action(new mG({requests:e.map((e=>e.request))}),e.map((e=>e.sourceData)));n.add(t);break}case OJ.Transaction:{const t=new wJ.Action(new mG({requests:[e.map((e=>e.request))]}),e.map((e=>e.sourceData)));n.add(t);break}}return n}return null},cleanUp:function(e,{id:t=null,logicalName:r=null,primaryIdAttribute:n=null}={}){null!=e&&(null!=r&&null!=n&&SJ(e,r,n),e["@meta"]=Object.assign(e["@meta"]||{},{isDelete:!1,change:{},isDirty:!1,isCreate:!1}),null!=t&&RJ(e,t))}};const jJ=AV.newGuidString("N"),_J=["0","3","3,0","3,2"],qJ={0:"#",3:"###,###","3,0":",###","3,2":"##,###"},VJ=["(${0})","-${0}","- ${0}","${0}-","${0} -"],UJ=["([${symbol}]${numberFormat})","-[${symbol}]${numberFormat}","[${symbol}]-${numberFormat}","[${symbol}]${numberFormat}-","(${numberFormat}[${symbol}])","-${numberFormat}[${symbol}]","${numberFormat}-[${symbol}]","${numberFormat}[${symbol}]-","-${numberFormat} [${symbol}]","-[${symbol}] ${numberFormat}","${numberFormat} [${symbol}]-","[${symbol}] ${numberFormat}-","[${symbol}] -${numberFormat}","${numberFormat}- [${symbol}]","([${symbol}] ${numberFormat})","(${numberFormat} [${symbol}])"],FJ=["[${symbol}]${numberFormat}","${numberFormat}[${symbol}]","[${symbol}] ${numberFormat}","${numberFormat} [${symbol}]"],BJ={attributeMetadata:null,decimalPrecision:2,decimalSymbol:",",thousandSeparator:".",currencyDisplayOption:0,currencySymbol:"€",isoCurrencyCode:"EUR",currencyFormatCode:0,negativeCurrencyFormatCode:0,numberGroupFormat:3,negativeFormatCode:1};function zJ(){return!0!==xF.getIsAvailable()?(WV("Converter/checkUserSettings()","Context is not available!","Conversion could be inaccurate."),!1):!0===xF.UserSettings.isLoaded||(WV("Converter/checkUserSettings()","Converter requires UserSettings to be loaded before use.","Conversion could be inaccurate."),!1)}function KJ(e,t,r){return null!=e||(WV("Converter/isAttributeMetadataAvailable(object)",`Metadata for attribute "${r}" on entity "${t}" is not available.`,"Conversion could be inaccurate."),!1)}function WJ(e={}){const t={...BJ,...e},r=_J.includes(t.numberGroupFormat.toString())?t.numberGroupFormat:BJ.numberGroupFormat,n=qJ[r];return t.decimalPrecision>0?`${n}.`.padEnd(t.decimalPrecision+n.length+1,"#"):n}function XJ(e,t,r){if(String.isNullOrWhiteSpace(e)||String.isNullOrWhiteSpace(t))return;const n=ZV("@meta.formattedValues",e,Object.create(null));e["@meta"].formattedValues={...n,[t]:r}}function ZJ(e,t,r={}){if(null==e||String.isNullOrWhiteSpace(t))return"";let n=GV(`@meta.formattedValues.${t}`,e,void 0);if(!Jq(n))return n;const{[t]:i=""}=e;n=i.toString();const a=function(e,t,r={}){const n={logicalName:GV("@meta.logicalName",e,""),...r};return{attributeName:t,attributeMetadata:GK.getAttributeCached(n.logicalName,t)||{},...n}}(e,t,r);return n=function(e,t,r){const{attributeMetadata:n={}}=r,i=n.type||`__NO__METADATA__FOR__${t}__`,a=GV("name",e,"");if(!0===n.isOptionSet)return function(e,t={}){if(!Number.isNumeric(e))return WV(`Converter/formatOptionSet(${e}, object)`,`${e} is not numeric!`),"";const{logicalName:r,attributeName:n,attributeMetadata:i}=t;return KJ(i,r,n)&&i.isOptionSet?i.getOptionText(e):e.toString()}(e,r);if(!0===n.isNumber)return function(e,t={}){if(!Number.isNumeric(e))return WV(`Converter/formatNumber(${e}, object)`,`${e} is not numeric!`),"";const r=!0===zJ()?{decimalSymbol:xF.UserSettings.decimalSymbol,thousandSeparator:xF.UserSettings.numberSeparator,numberGroupFormat:xF.UserSettings.numberGroupFormat,negativeFormatCode:xF.UserSettings.negativeFormatCode}:{},{logicalName:n,attributeName:i,attributeMetadata:a}=t;let o={},s=!1;KJ(a,n,i)&&(s=a.type===IV.Integer||a.type===IV.BigInt||a.type===IV.Int32,o={decimalPrecision:a.precision});const u={DEFAULT_OPTIONS:BJ,...r,...o,...t};return lU.registerDelimiters(jJ,u.decimalSymbol,u.thousandSeparator),u.decimalPrecision=!1===s?u.decimalPrecision:0,new lU(e,jJ).format(QV(VJ[u.negativeFormatCode],WJ(u)))}(e,r);if(i===IV.DateTime)return function(e,t={}){if(!VF.isValidDate(e))return WV(`Converter/formatDateTime(${e}, object)`,`${e} is not a valid DateTime object!`),"";const{logicalName:r,attributeName:n,attributeMetadata:i}=t,a=!!KJ(i,r,n)&&(i.behavior===xV.DateOnly||i.format===TV.DateOnly);let o=a?"M/d/yyyy":"M/d/yyyy M.d.yyyy";return zJ()&&(o=a?xF.UserSettings.dateFormattedString:`${xF.UserSettings.dateFormattedString} ${xF.UserSettings.timeFormatString}`),VF.format(e,{isSourceUTC:!1,targetFormat:o,targetDateZone:mU.UserTime})}(e,r);if(i===IV.Money)return function(e,t={}){if(!Number.isNumeric(e))return WV(`Converter/formatCurrency(${e}, object)`,`${e} is not numeric!`),"";const r=!0===zJ()?{currencyDisplayOption:xF.OrganizationSettings.currencyDisplayOption,currencySymbol:xF.UserSettings.currencySymbol,isoCurrencyCode:xF.UserSettings.isoCurrencyCode,currencyFormatCode:xF.UserSettings.currencyFormatCode,negativeCurrencyFormatCode:xF.UserSettings.negativeCurrencyFormatCode,thousandSeparator:xF.UserSettings.numberSeparator,decimalSymbol:xF.UserSettings.decimalSymbol,decimalPrecision:xF.OrganizationSettings.baseCurrencyPrecision}:{},{logicalName:n,attributeName:i,attributeMetadata:a}=t,o=KJ(a,n,i)?{decimalPrecision:a.precision}:{},s={...BJ,...r,...o,...t};lU.registerDelimiters(jJ,s.decimalSymbol,s.thousandSeparator);const u=0===s.currencyDisplayOption,l=new lU(e,jJ),c=l.value()<0?UJ[s.negativeCurrencyFormatCode]:FJ[s.currencyFormatCode];return l.format(QV(c,{symbol:u?s.currencySymbol:s.isoCurrencyCode,numberFormat:WJ(s)}))}(e,r);if(!String.isNullOrWhiteSpace(a))return a;return WV(`Converter/formatValue(${e}, ${t}, object)`,`No formatter found for attribute type "${i}" of "${t}".`),e}(i,t,a),String.isNullOrWhiteSpace(n)||XJ(e,t,n),n}async function GJ(e,t,r={}){return null==r.attributeMetadata&&(r.attributeMetadata=await GK.getAttribute(GV("@meta.logicalName",e,""),t)),ZJ(e,t,r)}function HJ(e,t,r,{useDirtyChecker:n=!0}={}){e&&t&&r&&(e[t]=r,XJ(e,t,null),n&&LJ.setIsChange(e,[t]))}var JJ={format:function(e,t,r,n={}){return ZJ({"@meta":{logicalName:t},[r]:e},r,n)},formatAsync:function(e,t,r,n={}){return GJ({"@meta":{logicalName:t},[r]:e},r,n)},getFormattedValue:ZJ,getFormattedValueAsync:GJ,setValue:HJ,setValues:function(e,t,{useDirtyChecker:r=!0}={}){if(!e||!t)return;const n=[];Object.entries(t).forEach((([t,r])=>{HJ(e,t,r,{useDirtyChecker:!1}),n.push(t)})),r&&LJ.setIsChange(e,n)}};const YJ={script:"script",json:"json",xml:"xml",css:"css",txt:"txt"},QJ={js:"script",xml:"xml",json:"json",css:"css",txt:"txt"},eY={script:{header:{"Content-Type":lV.JavaScript},parser(e){try{const t=document.createElement("script");return t.type=lV.JavaScript,t.charset="UTF-8",t.text=e.responseText,document.getElementsByTagName("head")[0].appendChild(t),Promise.resolve()}catch(e){return Promise.reject(e)}},errorParser:e=>Promise.reject(e)},json:{header:{"Content-Type":lV.JSON},parser(e){try{return Promise.resolve(JSON.parse(e.responseText))}catch(e){return Promise.reject(e.message)}},errorParser:e=>Promise.reject(e)},css:{header:{"Content-Type":lV.CSS},parser(e){try{const t=document.createElement("style");return t.textContent=e.responseText,document.getElementsByTagName("head")[0].appendChild(t),Promise.resolve()}catch(e){return Promise.reject(e.message)}},errorParser:e=>Promise.reject(e)},xml:{header:{"Content-Type":lV.XML},parser:e=>Object.isNullOrUndefined(e.responseXML)?Promise.reject(new Error(e.responseText)):Promise.resolve(e.responseXML),errorParser:e=>Promise.reject(e)},txt:{header:{"Content-Type":lV.TXT},parser:e=>Promise.resolve(e.responseText),errorParser:e=>Promise.reject(e)}},tY={},rY=(e,t,r,n=!1)=>{if("string"==typeof t&&(t=[t]),Object.isNullOrUndefined(YJ[e]))return Promise.reject(new Error(`Cannot find default options for type ${e} in Url.loadResourceByType(...)`));const i=t.map((t=>{const i=tX.getWebResourceUrl(t),a=!Object.isNullOrUndefined(tY[i])&&!0!==n?tY[i]:Dz.get(i,Object.assign({},eY[e],r));return tY[i]=a,tY[i].then((e=>Promise.resolve(JV.extract("data",e,e))))}));return 1===i.length?i[0]:Promise.all(i)},nY=(...e)=>JH.executeCustomAction("PublishXml",{ParameterXml:["<importexportxml>","<webresources>",e.map((e=>`<webresource>${e}</webresource>`)).join(""),"</webresources>","</importexportxml>"].join("")});var iY={Enums:Object.freeze({__proto__:null,WebResourceTypes:{HTML:1,CSS:2,JScript:3,XML:4,PNG:5,JPG:6,GIF:7,XAP:8,XSL:9,ICO:10,SVG:11,RESX:12}}),loadScript:(e,t,r=!1)=>rY(YJ.script,e,t,r),loadJSON:(e,t,r=!1)=>rY(YJ.json,e,t,r),loadCSS:(e,t,r=!1)=>rY(YJ.css,e,t,r),loadXML:(e,t,r=!1)=>rY(YJ.xml,e,t,r),loadPlain:(e,t,r=!1)=>rY(YJ.txt,e,t,r),load:(e,t,r=!1)=>{"string"==typeof e&&(e=[e]);const n=e.map((e=>{let n=Object.keys(QJ).find((t=>e.toLowerCase().endsWith(`.${t}`)));return Object.isNullOrUndefined(n)&&(WV("Resource.load",`No supported file extension found for resource with name ${e}. Falling back to type text/plain.`),n=QJ.txt),rY(QJ[n],e,t,r)}));return 1===n.length?n[0]:Promise.all(n)},write:(e=null,t=null,r,n={})=>{const{displayName:i=null,webresourceId:a=null,languageCode:o=null,solutionUniqueName:s=null,doPublish:u=!0}=n;return(null!==a||String.isNullOrEmpty(e)?Promise.resolve(a):JH.retrieveMultiple("webresource",`$select=webresourceid&$filter=name eq '${encodeURIComponent(e)}'`).then((e=>{const t=JV.extract("data.values",e);return t&&t.length>0?t[0].webresourceid:null}))).then((n=>{if(null==t||isNaN(t))throw new Error("resource.write: specify a valid webresourceType");return String.isNullOrEmpty(n)?JH.create("webresource",{displayname:i,name:e,webresourcetype:t,content:window.btoa(r),languagecode:o}).then((t=>{const r=t.data;return null!==s?JH.executeCustomAction("AddSolutionComponent",{ComponentId:r,ComponentType:61,SolutionUniqueName:s,AddRequiredComponents:!1,IncludedComponentSettingsValues:null}).catch((e=>console.error(`Error in AddSolutionComponent ${e}`))).then((()=>r)).catch((t=>(console.error(`Error in AddSolutionComponent for webresource ${e} to solution ${s}. Error: ${t}`),r))):r})):JH.update("webresource",n,{content:window.btoa(r)}).then((()=>n))})).then((t=>!0===u?nY(t).then((()=>t)).catch((r=>(console.error(`Error in publish webresource ${e} with id ${t}. Error: ${r}`),t))):t)).catch((e=>console.error(e)))},publish:nY};let aY=null;function oY(){return iY.loadJSON("orb_/ORBIS/Core/Utils/LCID.json").then((e=>(aY=e,aY)))}function sY(e,t=xF.Xrm.getUserLcid()){return String.isNullOrWhiteSpace(e)?Promise.reject(new Error('Argument "property" must be set in LCID.getProperty()')):Object.isNullOrUndefined(aY)?oY().then((r=>r[t][e])):Promise.resolve(aY[t][e])}function uY(e,t=xF.Xrm.getUserLcid()){if(String.isNullOrWhiteSpace(e))throw new Error('Argument "property" must be set in LCID.getProperty()');return Object.isNullOrUndefined(aY)?null:aY[t][e]}function lY(e){return sY("Culture",e)}function cY(e){return uY("Culture",e)}var dY={load:oY,getCulture:lY,getCultureCached:cY,getLanguage:function(e){return sY("Language",e)},getLanguageCached:function(e){return uY("Language",e)},getLocation:function(e){return sY("Location",e)},getLocationCached:function(e){return uY("Location",e)},getIsoLanguageCode:function(e){return lY(e).then((e=>String.isNullOrEmpty(e)?null:e.split("-").shift()))},getIsoLanguageCodeCached:function(e){const t=cY(e);return String.isNullOrEmpty(t)?null:t.split("-").shift()},getIsoRegionCode:function(e){return lY(e).then((e=>String.isNullOrEmpty(e)?null:e.split("-").pop()))},getIsoRegionCodeCached:function(e){const t=cY(e);return String.isNullOrEmpty(t)?null:t.split("-").pop()}};function fY(e){return new lU(e).value()}function pY(e,t){const r=fY(e),n=fY(t);return r<n?-1:r>n?1:0}var mY={compare:pY,equal:function(e,t){return 0===pY(e,t)},format:function(e,t){return new lU(e).format(t)},parse:fY,registerDelimiters:function(e,t,r,n=!1){lU.registerDelimiters(e,t,r,n)},selectDelimiters:function(e){lU.selectDelimiters(e)}};let hY=Object.create(null);function gY(e){return hY={...hY,...e},Promise.resolve(e)}var yY={load:function(e,t){const r=t||xF.Xrm.getUserLcid();"string"==typeof e&&(e=[e]);const n=e.map((e=>{if(String.isNullOrWhiteSpace(e))return Promise.reject(new Error('Parameter "file" is mandatory. No translations loaded. @ORBIS.Core.Utils.Translator.load()'));const t=/\.[0-9]{1,4}\.json$/,n=t.test(e)?e:`${e}.${r}.json`;return iY.loadJSON(n).catch((()=>n.endsWith(".1033.json")>0?(console.error(`Missing translation file ${n}. Please check if file is available.`),{}):(WV("Translator",`Missing translation file ${n}. Trying fallback to 1033 (en-us).`),iY.loadJSON(n.replace(t,".1033.json"))))).catch((()=>(XV("Translator",`Missing translation files ${n} and ${n.replace(t,".1033.json")}. Please check if files are available.`),{}))).then((e=>gY(e)))}));return 1===n.length?n[0]:Promise.all(n)},addJSON:gY,translate:function(e,t=null,...r){const n=hY[e]||function(e,t){if("function"==typeof e)return e(t);return WV("Translator",`Missing translation for: ${t}`),e}(t,e)||e;return eU(n,...r)}};const bY={not:e=>()=>Promise.resolve(e()).then((e=>!e)),all:(...e)=>()=>Promise.all(e.map((e=>e()))).then((e=>e.every((e=>e)))),some:(...e)=>()=>Promise.all(e.map((e=>e()))).then((e=>e.some((e=>e))))};const vY=function({metadataEntities:e=[],webResources:t=[],translations:r=[],loadUserSettings:n=!1}={}){"string"==typeof e&&(e=[e]),"string"==typeof t&&(t=[t]),t=t||[];const i=[(e=e||[]).length>0?GK.getEntities(...e):Promise.resolve(),t.length>0?iY.load(t):Promise.resolve(),r.length>0?yY.load(r):Promise.resolve()];!0===n&&i.push(xF.UserSettings.load());const a=Promise.all(i);return a.catch(console.error),a};var wY={define:function(e,t={},{namespaceParent:r=window,metadataEntities:n=[],webResources:i=[],translations:a=[],loadUserSettings:o=!1,xrmPage:s=null,initFunction:u="init"}={}){null!=s&&yW(s);const l=JV.define(e,r,t,{applyFunction:!0});return vY({metadataEntities:n,webResources:i,translations:a,loadUserSettings:o,initFunction:u}).catch((e=>console.error(`Error in Module.define: ${e.message}`))).then((e=>{l&&("string"==typeof u&&null!=l[u]?l[u](e):"function"==typeof u&&u(e))})),l},create:function(e,t,{namespaceParent:r=window,metadataEntities:n=[],translations:i=[],loadUserSettings:a=!1,xrmPage:o=null}={}){null!=o&&yW(o);const s=JV.define(e,r,t,{applyFunction:!0});return vY({metadataEntities:n,translations:i,loadUserSettings:a}).catch((e=>console.error(`Error in Module.create: ${e.message}`))).then((()=>s))},loadDependencies:vY};var OY={Context:xF,Metadata:GK,Service:JH,Utils:{debounce:function(e,t=100){let r=null;return(...n)=>{r&&clearTimeout(r),r=setTimeout((()=>{e(...n),r=null}),t)}},throttle:function(e,t=100){let r=0;return(...n)=>{const i=Date.now();if(!(i-r<t))return r=i,e(...n)}},memoize:dU,ArrayPartition:class{constructor(e=[],t=100){BV(this,"partitions",[]),BV(this,"position",-1),this.partitions=YH(e,t)}get next(){return!QH.call(this)&&!tJ.call(this)&&(this.position+=1,this.partitions[this.position])}get previous(){return!QH.call(this)&&!eJ.call(this)&&(this.position-=1,this.partitions[this.position])}static get(e=[],t=100){return YH(e,t)}},Converter:JJ,DateHelper:VF,Dialogs:mW,DirtyChecker:LJ,GUID:AV,HttpRequest:hJ,JSONArray:sJ,LCID:dY,MultiAction:wJ,NumberHelper:mY,PromisePool:fz,Resource:iY,Template:tU,Translator:yY,Url:tX,Storage:jU,Composition:bY},Module:wY,v:"9.2.30",b:"20220817"};const SY=Object.create(null),CY=Object.create(null),EY=Object.create(null),AY=Object.create(null),RY=new Map;function PY(e,t,r=!1){if("object"==typeof e)return e;if(void 0!==SY[e])return SY[e];const n=bW();if(!n)return null;const i=n.getAttribute(e);return null==i&&!0!==r&&WV(`Cache/getAttribute(${e}, message)`,`The attribute could not be found for ${e} in ${t}.`),SY[e]=i,i}var IY={getAttribute:PY,getAttributeByControl:function(e){if(null==e)return null;let t=null;return RY.has(e)?t=RY.get(e):null!=e.getAttribute?(t=e.getAttribute(),RY.set(e,t)):(t=null,RY.set(e,null)),t},getControl:function(e,t){if("object"==typeof e)return e;if(void 0!==CY[e])return CY[e];const r=bW();if(!r)return null;let n=null;const i=PY(e,void 0,!0);return null!=i?(n=i.controls.get(e),n||(n=i.controls.get(0)),n&&RY.set(n,i)):(n=r.getControl(e),RY.set(n,null)),null==n&&WV(`Cache/getControl(${e}, message)`,`The control could not be found for ${e} in ${t}.`),CY[e]=n,n},getSection:function(e,t){if("object"==typeof e)return e;if(void 0!==EY[e])return EY[e];const r=bW();if(null==r)return null;r.ui.tabs.forEach((e=>{AY[e.getName()]=e,e.sections.forEach((e=>{EY[e.getName()]=e}))}));let n=EY[e];return void 0===n&&(EY[e]=null,n=null),null==n&&WV(`Cache/getSection(${e})`,`The section with the name ${e} could not be found on form for ${t}.`),n},getTab:function(e,t){if("object"==typeof e)return e;if(void 0!==AY[e])return AY[e];const r=bW();if(null==r)return null;r.ui.tabs.forEach((e=>{AY[e.getName()]=e,e.sections.forEach((e=>{EY[e.getName()]=e}))}));let n=AY[e];return void 0===n&&(AY[e]=null,n=null),null==n&&WV(`Cache/getTab(${e})`,`The tab with the name ${e} could not be found on form for ${t}.`),n}};function NY(e,t,r,n){const i=IY.getControl(e);null==i||null==i[t]?CW(`Control ${e} was not found or the method ${t} is missing`,n):i[t](r)}function TY(e,t,r,n,i,a,o){if(null!=e)if("string"==typeof e)xY(e,t,r,n,i,a,o);else if(Array.isArray(e))e.forEach((e=>xY(e,t,r,n,i,a,o)));else if("object"==typeof e)for(const s in e){if(!Object.prototype.hasOwnProperty.call(e,s))continue;const u=e[s];xY(s,t,"boolean"==typeof u?u:r,n,i,a,o)}}function xY(e,t,r,n,i,a,o){const s=t(e);null!=s?n(s,r,i,a):o.push(e)}function kY(e,t,r,n){GV("sections",e,[]).forEach((e=>{MY(e,t,r,n)}))}function MY(e,t,r,n){GV("controls",e,[]).forEach((e=>{$Y(e,t,r,n)}))}function $Y(e,t,r,n){if(null==e||null==e.setDisabled)return;const i=e=>{e&&e.setDisabled&&e.setDisabled(!t),n[e.getName()]=e};if(r){const t=IY.getAttributeByControl(e);t?t.controls.forEach(i):i(e)}else i(e)}function DY(e,t,r,n){if(null==e||null==e.setVisible)return;const i=e=>{e&&e.setVisible&&e.setVisible(t),n[e.getName()]=e};if(r){const t=IY.getAttributeByControl(e);t?t.controls.forEach(i):i(e)}else i(e)}function LY(e){return IY.getControl(e,"ORBIS.Xrm.Control.get")}var jY={addNotification:function(e,t,r={}){const{alert:n=!1,actions:i=[],uniqueId:a=AV.newGuidString("N"),notificationLevel:o=TW.Recommendation}=r,s=LY(e);return null==s?(CW(`Cannot add notification for control with name ${e}`,n),null):"function"!=typeof s.addNotification?(WV(`Control/setNotification(${s.getName()}, message)`,`setNotification is not supported for this type of control. [${s.getControlType()}]`),null):(s.setNotification({messages:Array.isArray(t)?t:[t],notificationLevel:o,uniqueId:a,actions:i}),a)},addOnKeyPress:function(e,t,r={}){const{alert:n=!0}=r;NY(e,"addOnKeyPress",t,n)},addOnPostSearch:function(e,t,r={}){const{alert:n=!0}=r;NY(e,"addOnPostSearch",t,n)},addOnPreSearch:function(e,t,r={}){const{alert:n=!0}=r;NY(e,"addPreSearch",t,n)},addOnTabStateChange:function(e,t,r={}){const n=IY.getTab(e,"ORBIS.Xrm.Control.addTabStateChange");if(null==n)return;const{alert:i=!0}=r;n.addTabStateChange?n.addTabStateChange(t):"function"==typeof n.add_tabStateChange?n.add_tabStateChange(t):CW(`addTabStateChange is not supported for tab ${e}`,i)},clearNotification:function(e,t,r={}){const{alert:n=!1}=r,i=LY(e);null!=i?"function"==typeof i.clearNotification?i.clearNotification(t):WV(`Control/clearNotification(${i.getName()}, message)`,`clearNotification is not supported for this type of control. [${i.getControlType()}]`):CW(`Cannot clear notifications for ${e}.`,n)},enable:function(e={}){const{tabs:t=null,sections:r=null,controls:n=null,bound:i=!0,alert:a=!0,value:o=!0}=e;if(null==bW())return null;const s=[],u={};return TY(t,IY.getTab,o,kY,i,u,s),TY(r,IY.getSection,o,MY,i,u,s),TY(n,IY.getControl,o,$Y,i,u,s),s.length>0&&CW(`The following control(s) couldn't be found for the enable function: ${s.join(", ")}`,a),{controls:u}},get:LY,getControlType:function(e,t={}){const{alert:r=!1}=t,n=LY(e);return null==n?(CW(`Cannot get control type for ${name}.`,r),null):n.getControlType()},getSection:function(e){return IY.getSection(e,"ORBIS.Xrm.Control.getSection")},getTab:function(e){return IY.getTab(e,"ORBIS.Xrm.Control.getTab")},getTabDisplayState:function(e){if(null==e)throw new Error("The tab or tab name was not specified in ORBIS.Xrm.getTabDisplayState");const t="string"==typeof e?IY.getTab(e,"ORBIS.Xrm.Control.setTabDisplayState"):e;return null!=t&&null!=t.getDisplayState?t.getDisplayState():null},removeOnKeyPress:function(e,t,r={}){const{alert:n=!0}=r;NY(e,"addOnKeyPress",t,n)},removeOnPreSearch:function(e,t,r={}){const{alert:n=!0}=r;NY(e,"removePreSearch",t,n)},removeOnTabStateChange:function(e,t,r={}){const n=IY.getTab(e,"ORBIS.Xrm.Control.removeOnTabStateChange");if(null==n)return;const{alert:i=!0}=r;n.removeTabStateChange?n.removeTabStateChange(t):CW(`removeTabStateChange is not supported for tab ${e}`,i)},setFocus:function(e={}){const{control:t=null,tab:r=null}=e,n=t?IY.getControl(t):IY.getTab(r);n&&n.setFocus&&n.setFocus()},setSrc:function(e,t="about:blank",r={}){const n=IY.getControl(e);if(null==n||null==n.setSrc)return;const{passParams:i=!0,params:a}=r;let o=a??{};if(i){const e=bW(),t=e.data.entity.getId(),r=e.data.entity.getEntityName(),{organizationSettings:n,userSettings:i}=xF.Xrm;o={...a,id:t,typename:r,orglcid:n?.organizationId,orgname:n?.uniqueName,type:GK.getObjectTypeCodeCached(r),userlcid:i?.userId}}n.setSrc(tX.getWebResourceUrl(t,o))},setTabDisplayState:function(e,t){if(null==e)throw new Error("The tab or tab name was not specified in ORBIS.Xrm.Control.setTabDisplayState");const r="string"==typeof e?IY.getTab(e,"ORBIS.Xrm.Control.setTabDisplayState"):e;null!=r&&null!=r.setDisplayState&&r.setDisplayState(null!=t?t:IW.Expanded)},show:function(e={}){const{tabs:t=null,sections:r=null,controls:n=null,bound:i=!0,alert:a=!0,value:o=!0}=e;if(null==bW())return null;const s=[],u={},l={};return TY(t,IY.getTab,o,DY,i,u,s),TY(r,IY.getSection,o,DY,i,{},s),TY(n,IY.getControl,o,DY,i,l,s),s.length>0&&CW(`The following controls couldn't be found for the show function: ${s.join(", ")}`,a),{tabs:u,sections:u,controls:l}},expandTab:function(e,t=!0){const r="string"==typeof e?IY.getTab(e):e;null!=r&&null!=r.setDisplayState&&r.setDisplayState(!0===t?IW.Expanded:IW.Collapsed)}};function _Y(e,t={}){const{alert:r=!1,additionalMessage:n=null}=t,i=IY.getAttribute(e,n);return null==i&&!0===r&&function(e,t="",r){const n=!0!==window.ORBIS.XRM_HIDE_ALERTS&&r;CW(`Could not get attribute with name '${e}'. Source: ${t}. No further action needed.`,n)}(e,n,r),i}function qY(e,t=null,r={}){const{alert:n=!0,additionalMessage:i="getValue"}=r,a=_Y(e,{alert:n,additionalMessage:i});if(null==a||null==a.getValue)return t;const o=a.getValue();return null!=o?o:t}var VY={get:_Y,exists:function(e){return null!=_Y(e,{additionalMessage:"exists"})},addOnChange:function(e,t,r={}){const{alert:n=!1,additionalMessage:i="addOnChange"}=r,a=_Y(e,{alert:n,additionalMessage:i});return null!=a&&a.addOnChange(t),a},fireOnChange:function(e,t={}){const{alert:r=!1,additionalMessage:n="fireOnChange"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null!=i&&i.fireOnChange(),i},getType:function(e,t={}){const{alert:r=!1,additionalMessage:n="getType"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null==i?null:i.getAttributeType()},getFormat:function(e,t={}){const{alert:r=!1,additionalMessage:n="getFormat"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null==i?null:i.getFormat()},getIsDirty:function(e,t={}){const{alert:r=!1,additionalMessage:n="getIsDirty"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null!=i&&i.getIsDirty()},getRequiredLevel:function(e,t={}){const{alert:r=!0,additionalMessage:n="getRequiredLevel"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null==i||null==i.getRequiredLevel?null:i.getRequiredLevel()},getSubmitMode:function(e,t={}){const{alert:r=!0,additionalMessage:n="getSubmitMode"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null==i||null==i.getRequiredLevel?null:i.getSubmitMode()},getValue:function(e,t={}){return qY(e,null,{...t,additionalMessage:"getValue"})},getValueOrDefault:qY,isValid:function(e,t={}){const{alert:r=!0,additionalMessage:n="isValid"}=t,i=_Y(e,{alert:r,additionalMessage:n});return null!=i&&null!=i.isValid&&i.isValid()},removeOnChange:function(e,t,r={}){const{alert:n=!1,additionalMessage:i="removeOnChange"}=r,a=_Y(e,{alert:n,additionalMessage:i});return null!=a&&a.removeOnChange(t),a},setRequiredLevel:function(e,t=AW.None,r={}){const{alert:n=!0,additionalMessage:i="setRequiredLevel"}=r,a=_Y(e,{alert:n,additionalMessage:i});return a&&a.setRequiredLevel&&a.setRequiredLevel(t),a},setSubmitMode:function(e,t=RW.Dirty,r={}){const{alert:n=!0,additionalMessage:i="setSubmitMode"}=r,a=_Y(e,{alert:n,additionalMessage:i});return a&&a.setRequiredLevel&&a.setSubmitMode(t),a},setValue:function(e,t,r={}){const{alert:n=!0,fireOnChange:i=!1,submitMode:a=RW.Dirty,additionalMessage:o="setValue"}=r,s=_Y(e,{alert:n,additionalMessage:o});if(null==s||null==s.setValue)return null;let u=t;return s.getAttributeType&&s.getAttributeType()===PW.Lookup&&(u=function(e){if(null==e)return null;return function(e){return Array.isArray(e)?e:[e]}(e).map((e=>(null==e||(e.id&&(e.id=new AV(e.id).toString("B").toUpperCase()),null==e.entityType&&null!=e.logicalName&&(e.entityType=e.logicalName)),e)))}(t)),s.setValue(u),null!=a&&s.setSubmitMode(a),!0===i&&s.fireOnChange(),u},setIsValid:function(e,t,r,n={}){const{alert:i=!0,additionalMessage:a="setIsValid"}=n,o=_Y(e,{alert:i,additionalMessage:a});return o&&o.setIsValid&&o.setIsValid(t,r),o}};const UY={};function FY(e,t){return`${e}_${t}`}function BY(e,t=!1){const{childAttribute:r,childName:n,parentAttribute:i,allChildOptionsSorted:a,options:o}=e,s=r?.getValue()??null,u=s?.toString()??null,l=i?.getValue()??null,c=null==l?a:o[l],d=c?.some((e=>(e?.value?.toString()??null)===u))??!0;if(r.controls.forEach((e=>{e.clearOptions(),c.forEach((t=>{e.addOption(t)}))})),d)r.setValue(s);else if(null!=s)if(t){e.previousSubmitMode=r.getSubmitMode(),r.setSubmitMode(RW.Never),WV("DependentOptionSet",`${n} is missing option ${s}. The option was removed from customizing.`);const{onRemovedOption:t}=e;"function"==typeof t&&t(n,s)}else r.setValue(null),r.fireOnChange()}function zY(e){return(t,r)=>{const{[e]:n}=UY;null!=n&&BY(n,r)}}function KY(e={},t){const{parent:r,child:n,sortByLabel:i,...a}=e,o=IY.getAttribute(r),s=IY.getAttribute(n);if(null==o||null==s)return;const u=Array.from(s.getOptions()),l=function(e,t=!1){if(!0===t)return sJ.from(e).sortByKey("text").toArray();return e}(u,i),c=FY(r,n),d={parentName:r,parentAttribute:o,childName:n,childAttribute:s,options:ZY(a,l),allChildOptions:XY(u),allChildOptionsSorted:l,onChangeHandler:zY(c),onRemovedOption:t,previousSubmitMode:null,onChildAttributeChanged:WY(c)};UY[c]=d,o.addOnChange(d.onChangeHandler),s.addOnChange(d.onChildAttributeChanged),d.onChangeHandler(void 0,!0)}function WY(e){return t=>{const{previousSubmitMode:r,onChildAttributeChanged:n}=UY[e],i=null==r,a=t?.getEventSource(),o=(a?.getSubmitMode()??RW.Always)!==RW.Never;i||o||a.setSubmitMode(r),a.removeOnChange(n)}}function XY(e){return e.reduce(((e,t)=>(-1!==t.value&&(e[t.value]=t),e)),{})}function ZY(e,t){return Object.entries(e).reduce(((e,[r,n])=>null==n?e:tV(n)&&"all"===n.toLowerCase()?{...e,[r]:t}:{...e,[r]:t.filter((e=>n.includes(e?.value)))}),{})}function GY(e){console.error("[ORBIS.Core] Error in DependentOptionSet. The configuration could not be loaded",e)}var HY={apply:function(e,t){let r=null;return r="string"==typeof e?iY.loadJSON(e):Promise.resolve(e),r.then((e=>KY(e,t))).catch(GY)},clear:function(e,t){if(null==e||null==t)return;const r=FY(e,t),{[r]:n}=UY;if(null==n)return;BY(n);const{parentAttribute:i,childAttribute:a,onChangeHandler:o,onChildAttributeChanged:s}=n;i&&(VY.removeOnChange(i,o),VY.removeOnChange(a,s)),delete UY[r]}};const JY=new Set,YY=new Set;function QY(){!1===new AV(eQ()).isEmpty&&function(){for(const e of YY)YY.delete(e),e(),JY.add(e)}()}function eQ(){const e=JV.extract("data.entity",bW());return e&&e.getId?e.getId():null}function tQ(e,{applyOnCreate:t=!0,applyOnUpdate:r=!0}={}){const n=eQ();!1===new AV(n).isEmpty?!0!==r||JY.has(e)||(e(),JY.add(e)):!0===t&&(JY.has(e)||(e(),JY.add(e)))}function rQ(){const e=bW();return Jq(e)||Jq(e.ui)||Jq(e.ui.getFormType)?NW.Undefined:e.ui.getFormType()}var nQ=Object.freeze({__proto__:null,init:QY,getId:eQ,addOnLoadOnce:tQ,isCreateMode:function(){return rQ()===NW.Create},isUpdateMode:function(){return rQ()===NW.Update},addOnSaveAsync:WW,removeOnSaveAsync:XW,save:zW,saveAndClose:KW,Manager:class{constructor(e={}){BV(this,"groups",null),BV(this,"defaultGroup",{condition:()=>{},fieldLevelCondition:()=>{},enableCondition:()=>{},showCondition:()=>{},notificationCondition:()=>{},formNotificationCondition:()=>{},triggers:[]}),this.groups=this.patchGroups(e)}patchGroups(e){return Object.keys(e).map((t=>[t,{...this.defaultGroup,...e[t]}])).reduce(((e,t)=>(e[t[0]]=t[1],e)),{})}applyShowCondition(e,t,r){jY.show({controls:e.controls,sections:e.sections,tabs:e.tabs,value:t,alert:e.alert}),e.navigationItems&&e.navigationItems.forEach((e=>{const r=bW().ui.navigation.items.get(e);r?r.setVisible(t):WV("FormManager",`Failed to find navigation item '${e}'`)})),!t&&e.controls&&e.showSettings?.clearOnHide&&!r&&e.controls.forEach((e=>{const t=jY.get(e),r=t.getAttribute&&t.getAttribute();r&&(r.setValue(null),r.fireOnChange())})),e.showSettings?.requiredWhenShown&&e.controls&&e.controls.forEach((e=>VY.setRequiredLevel(e,t?"required":"none")))}applyEnableCondition(e,t){jY.enable({controls:e.controls,tabs:e.tabs,value:t})}applyFieldLevelCondition(e,t){(e.requirementSettings?.requiredFields??e.controls??[]).forEach((e=>{ORBIS.Xrm.Attribute.setRequiredLevel(e,t)}))}applyNotificationCondition(e,t){if(!e.notificationSettings)return void XV("applyNotificationCondition","NotificationSettings for notification condition are missing, aborting");const r=yY.translate(e.notificationSettings.notificationId,e.notificationSettings.defaultMessage);e.controls&&e.controls.forEach((n=>{const i=jY.get(n);i&&(t?i.setNotification(r,e.notificationSettings.notificationId):i.clearNotification(e.notificationSettings.notificationId))}))}applyFormNotificationCondition(e,t){if(e.formNotificationSettings)if(t){const t=yY.translate(e.formNotificationSettings.notificationId,e.formNotificationSettings.defaultMessage);bW().ui.setFormNotification(t,e.formNotificationSettings.level,e.formNotificationSettings.notificationId)}else bW().ui.clearFormNotification(e.formNotificationSettings.notificationId);else XV("FormManager.applyFormNotificationCondition","FormNotificationSettings for form notification condition are missing, aborting")}async applyCondition(e,t){const[r,n,i,a,o,s]=await Promise.all([e.condition(),e.fieldLevelCondition(),e.showCondition(),e.enableCondition(),e.notificationCondition(),e.formNotificationCondition()]),u=!!r;return(e.showSettings||void 0!==i)&&this.applyShowCondition(e,void 0!==i?i:u,t),(e.isEnableCondition||void 0!==a)&&this.applyEnableCondition(e,void 0!==a?a:u,t),(e.requirementSettings||n)&&this.applyFieldLevelCondition(e,void 0!==n?n:u?"required":"none",t),(e.notificationSettings||o)&&this.applyNotificationCondition(e,void 0!==o?o:u,t),(e.formNotificationSettings||s)&&this.applyFormNotificationCondition(e,void 0!==s?s:u,t),!e.callBack||t&&!e.callBackSettings?.runOnInitialize||e.callBack({groupResult:u,fieldLevelResult:n,showResult:i,enableResult:a,notificationResult:o,formNotificationResult:s,isInitialize:t}),{conditionResult:r,fieldLevelResult:n,showResult:i,enableResult:a,notificationResult:o,formNotificationResult:s}}async applyAndLog(e,t,r,n){KV("FormManager.applyAndLog",`Group [${e}] triggered by '${r}'`);const{conditionResult:i,fieldLevelResult:a,showResult:o,enableResult:s,notificationResult:u,formNotificationResult:l}=await this.applyCondition(t,n);KV("FormManager.applyAndLog",`Group [${e}] Stats - Result: ${i}, Field level result: ${a}, Show Result: ${o}, Enable Result: ${s}, Notification Result: ${u}, Form Notification Result: ${l}`)}applyGroup(e,t){const r=e||Object.keys(this.groups);return Promise.all(r.map((e=>{const r=this.groups[e];if(r.groupDisabled)return KV("FormManager.applyGroup",`Group [${e}] will be disabled`),null;if(t){r.triggerOnProcessStageChange&&bW().data.process.addOnStageChange((()=>this.applyAndLog(e,r,"Process Stage Change")));for(const t of r.triggers)VY.addOnChange(t,(()=>this.applyAndLog(e,r,t)))}return this.applyAndLog(e,r,"Initialize",t)})))}initialize(e){return e?.groupOverrides&&(this.groups=Object.assign(this.groups,this.patchGroups(e.groupOverrides))),this.applyGroup(null,!0)}}});var iQ={Control:jY,Attribute:VY,DependentOptionSet:HY,Enums:{...xW,NotificationLevel:TW},Frames:{addOnLoadOnce:tQ,addOnSaveAsync:WW,getId:eQ,init:QY,removeOnSaveAsync:XW,save:zW,saveAndClose:KW,getParentXrm:wW,getParentXrmWindow:OW},Form:nQ,getXrm:vW,getXrmPage:bW,setXrmPage:yW,getParentXrm:wW,getParentXrmWindow:OW};const aQ=window;ZV("ORBIS",aQ,{WEB_API_VERSION:void 0,XRM_HIDE_ALERTS:!1}),ZV("ORBIS.Core",aQ,OY),ZV("ORBIS.Xrm",aQ,iQ),ZV("ORBIS.Namespace",aQ,JV)}();
// sourceMappingURL=https://tfs.orbis.de/dev/ORBIS.Core/archive/9.2.30/Core.js.map
